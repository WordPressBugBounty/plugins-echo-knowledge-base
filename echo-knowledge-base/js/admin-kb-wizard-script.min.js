jQuery(document).ready((function(e){let t=e("#epkb-config-wizard-content, .epkb-config-wizard-content");let i=true;if(t.length<=0){return}function a(t,i){i.find(".epkb-wizard-status-bar .epkb-wsb-step").removeClass("epkb-wsb-step--completed");i.find(".epkb-wizard-status-bar .epkb-wsb-step").each((function(){id=e(this).attr("id");let i=id[id.length-1];if(i<t){e(this).addClass("epkb-wsb-step--completed")}}))}function n(e){e.find(".epkb-wizard-button-container").removeClass("epkb-wizard-button-container--final-step");e.find(".epkb-wizard-button-container").removeClass("epkb-wizard-button-container--first-step");let t=e.find(".epkb-wsb-step--active").attr("id");let i=Number(t[t.length-1]);let a=e.find(".epkb-wizard-status-bar li.epkb-wsb-step").length;if(e.find(".epkb-wizard-ordering-ordering-preview").length){}if(i===1){e.find(".epkb-wizard-button-container").addClass("epkb-wizard-button-container--first-step")}if(i===a){e.find(".epkb-wizard-button-container").addClass("epkb-wizard-button-container--final-step")}}function r(t){let i=e(".epkb-wsb-step--active").attr("id");let a=Number(i[i.length-1]);t.find(".epkb-wizard-header__desc__step").removeClass("epkb-wizard-desc-active");t.find("#epkb-wizard-desc-step-"+a).addClass("epkb-wizard-desc-active")}function o(){e("html, body").animate({scrollTop:0},0)}t.find("#epkb-wizard-button-next").on("click",(function(t){t.preventDefault();let i=e(this).closest("#epkb-config-wizard-content, .epkb-config-wizard-content");i.find(".epkb-ordering-wizard-button-apply").show();let d=Number(i.find("#epkb-wizard-button-next").val());let s=Number(i.find("#epkb-wizard-button-prev").val());i.find(".epkb-wsb-step").removeClass("epkb-wsb-step--active");i.find("#epkb-wsb-step-"+d).addClass("epkb-wsb-step--active");i.find(".epkb-wc-step-panel").removeClass("epkb-wc-step-panel--active");i.find("#epkb-wsb-step-"+d+"-panel").addClass("epkb-wc-step-panel--active");i.find("#epkb-wizard-button-prev").val(s+1);i.find("#epkb-wizard-button-next").val(d+1);a(d,i);n(i);r(i);o()}));t.find("#epkb-wizard-button-prev").on("click",(function(t){t.preventDefault();let i=e(this).closest("#epkb-config-wizard-content, .epkb-config-wizard-content");i.find(".epkb-ordering-wizard-button-apply").hide();let d=Number(i.find("#epkb-wizard-button-next").val());let s=Number(i.find("#epkb-wizard-button-prev").val());i.find(".epkb-wsb-step").removeClass("epkb-wsb-step--active");i.find("#epkb-wsb-step-"+s).addClass("epkb-wsb-step--active");i.find(".epkb-wc-step-panel").removeClass("epkb-wc-step-panel--active");i.find("#epkb-wsb-step-"+s+"-panel").addClass("epkb-wc-step-panel--active");i.find("#epkb-wizard-button-prev").val(s-1);i.find("#epkb-wizard-button-next").val(d-1);a(s,i);n(i);r(i);o()}));t.find(".epkb-wt-tab").on("click",(function(t){let a=e(this);let n=a.attr("id");let r=e("#"+n+"-panel");e(".epkb-wt-tab").removeClass("epkb-wt--active");a.addClass("epkb-wt--active");e(".epkb-wt-panel").removeClass(" epkb-wt-panel--active").css({opacity:"0"});r.addClass("epkb-wt-panel--active");r.animate({opacity:"1"},200);let o=JSON.parse(r.find(".theme-values").val());if(o){e("#epkb-public-styles-inline-css").html(`\n\t\t\t\t#epkb-content-container .epkb-nav-tabs .active:after {\n\t\t\t\t\tborder-top-color: ${o.tab_nav_active_background_color}!important\n\t\t\t\t}\n\t\t\t\t#epkb-content-container .epkb-nav-tabs .active {\n\t\t\t\t\tbackground-color: ${o.tab_nav_active_background_color}!important\n\t\t\t\t}\n\t\t\t\t#epkb-content-container .epkb-nav-tabs .active .epkb-category-level-1,\n\t\t\t\t#epkb-content-container .epkb-nav-tabs .active p {\n\t\t\t\t\tcolor: ${o.tab_nav_active_font_color}!important\n\t\t\t\t}\n\t\t\t\t#epkb-content-container .epkb-nav-tabs .active:before {\n\t\t\t\t\tborder-top-color: ${o.tab_nav_border_color}!important\n\t\t\t\t}\t\t\n\t\t\t`);original_styles=e("#epkb-public-styles-inline-css").html()}i=true}));function d(e,t,i){g();return'<div class="eckb-bottom-notice-message">'+'<div class="contents">'+'<span class="'+i+'">'+(e?"<h4>"+e+"</h4>":"")+(t?t:"")+"</span>"+"</div>"+"</div>"}function s(){let t=e(this).closest("#epkb-config-wizard-content, .epkb-config-wizard-content");let i=t.find(".epkb-wizard-slug input");if(i.length==0){return true}let a=i.val();let n=true;if(a.startsWith("http")){n=false}if(a.startsWith("www")){n=false}if(a.endsWith(".")){n=false}if(a.endsWith(".com")){n=false}if(a.endsWith(".org")){n=false}if(n){t.find("#epkb-wizard-slug-error").hide();t.find("#epkb-wizard-button-next").prop("disabled",false);i.removeClass("epkb-wizard-input-error")}else{t.find("#epkb-wizard-slug-error").show();t.find("#epkb-wizard-button-next").prop("disabled","disabled");i.addClass("epkb-wizard-input-error")}}e(".epkb-wizard-slug input").on("change keyup paste",s);e(".epkb-wizard-slug input").trigger("change");e("#eckb-wizard-ordering__page #epkb-wizard-button-next").on("click",(function(){p(false)}));function p(t=true){let i=e("#eckb-wizard-ordering__page");let a={categories_display_sequence:i.find("input[name=categories_display_sequence]:checked").val(),articles_display_sequence:i.find("input[name=articles_display_sequence]:checked").val(),show_articles_before_categories:i.find("input[name=show_articles_before_categories]:checked").val(),sidebar_show_articles_before_categories:i.find("input[name=show_articles_before_categories]:checked").val()};let n={action:"epkb_wizard_update_order_view",_wpnonce_epkb_ajax_action:i.find("#_wpnonce_epkb_ajax_action").val(),sequence_settings:a,epkb_kb_id:i.find("#epkb_wizard_kb_id").val()};b(i,n,(function(e){if(typeof e.html!=="undefined"){let t="";if(e.message.length){t+='<h1 class="eckb-wisard-ordering-title">'+e.message+"</h1>"}t+=e.html;i.find(".epkb-wizard-ordering-ordering-preview").html(t);c(a.articles_display_sequence=="user-sequenced",a.categories_display_sequence=="user-sequenced")}}),false,"",t)}function c(t,i){if(!t&&!i){return false}if(i){e(".epkb-wizard-ordering-ordering-preview .epkb-top-categories-list").sortable({axis:"x",forceHelperSize:true,forcePlaceholderSize:true,opacity:.8,placeholder:"epkb-sortable-placeholder"});e(".epkb-wizard-ordering-ordering-preview .eckb-categories-list, .epkb-wizard-ordering-ordering-preview .elay-sidebar__cat-container").sortable({axis:"x,y",forceHelperSize:true,forcePlaceholderSize:true,opacity:.8,placeholder:"epkb-sortable-placeholder"});e(".epkb-wizard-ordering-ordering-preview .eckb-sub-category-ordering").sortable({axis:"x,y",forceHelperSize:true,forcePlaceholderSize:true,opacity:.8,placeholder:"epkb-sortable-placeholder"});e(".epkb-wizard-ordering-ordering-preview .eckb-sub-sub-category-ordering").sortable({axis:"x,y",forceHelperSize:true,forcePlaceholderSize:true,opacity:.8,placeholder:"epkb-sortable-placeholder"})}if(t){e(".epkb-wizard-ordering-ordering-preview .epkb-articles").sortable({axis:"y",forceHelperSize:true,forcePlaceholderSize:true,opacity:.8,placeholder:"epkb-sortable-placeholder"})}e(".epkb-wizard-ordering-ordering-preview").find("a").css("cursor","move","important");e(".epkb-wizard-ordering-ordering-preview .epkb-category-level-2-3").on("click",(function(){e(this).parent().children("ul").toggleClass("active")}))}let l=e(".eckb-wizard-global-page");if(l.length){l.find("#epkb-wsb-step-1-panel .eckb-wizard-option-heading").trigger("click");e(".notice-epkb_changed_slug").remove();if(e(".notice-epkb-no-main-pages").length){e(".notice-epkb-no-main-pages").appendTo(e("#epkb-wsb-step-1-panel"));e(".notice-epkb-no-main-pages").find(".epkb-notice-dismiss").remove()}}if(l.find(".eckb_slug").length){let t=false;let i=l.find("#kb_articles_common_path").val();l.find(".eckb_slug").each((function(){if(e(this).data("path")==i){e(this).prop("checked","checked");t=true}}));if(!t){l.find(".eckb_slug").eq(0).prop("checked","checked");e("#kb_articles_common_path").val(l.find(".eckb_slug").eq(0).data("path"))}l.find(".eckb_slug").on("change",(function(){e("#kb_articles_common_path").val(e(this).data("path"));l.data("kb-main-page-id",e(this).data("kb-main-page-id"))}))}e(document.body).on("click","#categories_in_url_enabled__toggle input",(function(){if(e(this).is(":checked")){l.find("#categories_in_url_enabled").val("on");l.find(".epkb-wso-with-category__category").removeClass("epkb-wso-with-category__category--off")}else{l.find("#categories_in_url_enabled").val("off");l.find(".epkb-wso-with-category__category").addClass("epkb-wso-with-category__category--off")}}));function b(t,i,a,n,r,o=false){let s;let p;a=typeof a==="undefined"?"epkb_callback_noop":a;e.ajax({type:"POST",dataType:"json",data:i,url:ajaxurl,beforeSend:function(e){if(!o){f("show",r)}}}).done((function(e){p=e?e:"";if(p.error||typeof p.message==="undefined"){s=p.message?p.message:d("",epkb_vars.reload_try_again,"error")}})).fail((function(e,t,i){s=i?" ["+i+"]":epkb_vars.unknown_error;s=d(epkb_vars.error_occurred+". "+epkb_vars.msg_try_again,s,"error")})).always((function(){if(!o){f("remove","")}if(s){t.find(".eckb-bottom-notice-message").replaceWith(s);e("html, body").animate({scrollTop:0},"slow")}else{if(!o){if(!p.error&&typeof p.message!=="undefined"&&p.message){t.find(".eckb-bottom-notice-message").replaceWith(d("",p.message,"success"))}}if(typeof a==="function"){p=typeof p==="undefined"?"":p;a(p)}else{if(n){location.reload()}}}}))}function f(t,i){if(t==="show"){let t='<div class="epkb-admin-dialog-box-loading">'+'<div class="epkb-admin-dbl__header">'+'<div class="epkb-admin-dbl-icon epkbfa epkbfa-hourglass-half"></div>'+(i?'<div class="epkb-admin-text">'+i+"</div>":"")+"</div>"+"</div>"+'<div class="epkb-admin-dialog-box-overlay"></div>';e("body").append(t)}else if(t==="remove"){e(".epkb-admin-dialog-box-loading").remove();e(".epkb-admin-dialog-box-overlay").remove()}}e(".eprf-leave-feedback-form").on("submit",false);function k(){var t=e("body").find(".eckb-bottom-notice-message");if(t.length){t.addClass("fadeOutDown").html("")}}function g(){var t;if(e(".eckb-bottom-notice-message").length>0){clearTimeout(t);t=setTimeout((function(){k()}),1e4)}}function u(){let t="";let i=e("#use_top_sequence").val()==="yes";if(!i||typeof e(".epkb-wizard-ordering-ordering-preview .epkb-top-categories-list")==="undefined"){return t}e(".epkb-wizard-ordering-ordering-preview .epkb-top-categories-list").children().each((function(i,a){let n=e(this).find("[data-kb-category-id]").data("kb-category-id");if(n){t+="xx"+n}}));return t}function w(){let t="";if(e(".epkb-wizard-ordering-ordering-preview").find("#epkb-content-container").length){e(".epkb-wizard-ordering-ordering-preview").append('<div class="epkb-virtual-articles" style="display:none!important;">'+e(".epkb-wizard-ordering-ordering-preview").find("#epkb-content-container").html()+"</div>");e(".epkb-virtual-articles").find("ul.epkb-articles").each((function(){if(e(this).next().length&&e(this).next().prop("tagName")=="UL"){let t=e(this).parent();e(this).appendTo(t)}}))}if(e(".epkb-wizard-ordering-ordering-preview #el"+"ay-sidebar-layout-page-container").find(".el"+"ay-sidebar").length){e(".epkb-wizard-ordering-ordering-preview #el"+"ay-sidebar-layout-page-container").append('<div class="epkb-virtual-articles" style="display:none!important;">'+e(".epkb-wizard-ordering-ordering-preview #el"+"ay-sidebar-layout-page-container").find(".el"+"ay-sidebar").html()+"</div>");e(".epkb-wizard-ordering-ordering-preview .epkb-virtual-articles").find("ul.el"+"ay-articles").each((function(){if(e(this).next().length&&e(this).next().prop("tagName")=="UL"){let t=e(this).parent();e(this).appendTo(t)}}))}if(e(".epkb-wizard-ordering-ordering-preview #el"+"ay-grid-layout-page-container").length){e(".epkb-wizard-ordering-ordering-preview").find("[data-kb-type]").each((function(i,a){let n=e(this).data("kb-top-category-id")?e(this).data("kb-top-category-id"):"";if(n){t+="xx"+n+"x"+"category"}if(typeof e(this).attr("data-kb-type")!=="undefined"&&e(this).attr("data-kb-type")=="top-category-no-articles"){return true}let r=typeof e(this).data("kb-category-id")==="undefined"?e(this).data("kb-article-id"):e(this).data("kb-category-id");if(typeof r!=="undefined"){t+="xx"+r+"x"+e(this).attr("data-kb-type")}}));return t}if(e(".epkb-wizard-ordering-ordering-preview #elay-sidebar-container-v2").length){e(".epkb-wizard-ordering-ordering-preview #elay-sidebar-container-v2").append('<div class="epkb-virtual-articles" style="display:none!important;">'+e(".epkb-wizard-ordering-ordering-preview #elay-sidebar-container-v2").html()+"</div>");e(".epkb-wizard-ordering-ordering-preview .epkb-virtual-articles").find("ul.el"+"ay-articles").each((function(){if(e(this).next().length&&e(this).next().prop("tagName")=="UL"){let t=e(this).parent();e(this).appendTo(t)}}))}e(".epkb-wizard-ordering-ordering-preview").find(".epkb-virtual-articles [data-kb-type]").each((function(i,a){let n=e(this).data("kb-top-category-id")?e(this).data("kb-top-category-id"):"";if(n){t+="xx"+n+"x"+"category"}if(typeof e(this).attr("data-kb-type")!=="undefined"&&e(this).attr("data-kb-type")=="top-category-no-articles"){return true}let r=typeof e(this).data("kb-category-id")==="undefined"?e(this).data("kb-article-id"):e(this).data("kb-category-id");if(typeof r!=="undefined"){t+="xx"+r+"x"+e(this).attr("data-kb-type")}}));e(".epkb-wizard-ordering-ordering-preview .epkb-virtual-articles").remove();return t}e(".epkb-wizard-button-apply").on("click",(function(t){let i=e(this).closest(".epkb-admin__section-wrap");let a=e(this).data("wizard-type");let n={};let r=[];let o={wizard_type:a,action:"epkb_apply_wizard_changes",_wpnonce_epkb_ajax_action:i.find("#_wpnonce_epkb_ajax_action").val(),epkb_wizard_kb_id:i.find("#epkb_wizard_kb_id").val(),kb_main_page_id:i.find(".epkb-config-wizard-content").data("kb-main-page-id")};if(a=="ordering"){i.find(".epkb-radio-buttons-container input[type=radio]:checked").each((function(){n[e(this).attr("name")]=e(this).val()}));if(typeof n.show_articles_before_categories==="undefined"){n.show_articles_before_categories=i.find("#original_show_articles_before_categories").val()}n.sidebar_show_articles_before_categories=n.show_articles_before_categories;if(e(".epkb-wizard-ordering-ordering-preview").find("*").length==0&&(n.articles_display_sequence=="user-sequenced"||n.categories_display_sequence=="user-sequenced")){e("#epkb-wizard-button-next").trigger("click");return false}o.epkb_new_sequence=w();o.top_cat_sequence=u()}else if(a=="global"){i.find(".eckb-wizard-single-text input, input[name=kb_articles_common_path], input[name=categories_in_url_enabled]").each((function(){if(n[e(this).attr("name")]!=="undefined"){n[e(this).attr("name")]=e(this).val()}}));i.find(".eckb-wizard-single-radio input[type=radio]:checked, .radio-buttons-vertical  input[type=radio]:checked, .radio-buttons-horizontal input[type=radio]:checked").each((function(){if(n[e(this).attr("name")]!=="undefined"){n[e(this).attr("name")]=e(this).val()}}));i.find(".eckb-wizard-single-checkbox input").each((function(){if(n[e(this).attr("name")]!=="undefined"){if(e(this).prop("checked")){n[e(this).attr("name")]="on"}else{n[e(this).attr("name")]="off"}}}))}o.kb_config=n;b(i,o,(function(e){if(a=="ordering"){if(!e.error&&typeof e.message!=="undefined"){}}else if(a=="global"){if(!e.error&&typeof e.message!=="undefined"){i.find("#epkb-wsb-step-2-panel").removeClass("epkb-wc-step-panel--active");i.find("#epkb-wsb-step-3-panel").addClass("epkb-wc-step-panel--active").show();location.reload()}}}),false,epkb_vars.save_config)}));setTimeout((function(){e(".epkb-admin-dialog-box-loading").remove();e(".epkb-admin-dialog-box-overlay").remove()}),500)}));