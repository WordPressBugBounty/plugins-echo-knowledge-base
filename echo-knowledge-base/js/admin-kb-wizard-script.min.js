jQuery(document).ready((function(e){let t=e("#epkb-config-wizard-content, .epkb-config-wizard-content"),i=!0;if(t.length<=0)return;function a(t,i){i.find(".epkb-wizard-status-bar .epkb-wsb-step").removeClass("epkb-wsb-step--completed"),i.find(".epkb-wizard-status-bar .epkb-wsb-step").each((function(){id=e(this).attr("id"),id[id.length-1]<t&&e(this).addClass("epkb-wsb-step--completed")}))}function r(e){e.find(".epkb-wizard-button-container").removeClass("epkb-wizard-button-container--final-step"),e.find(".epkb-wizard-button-container").removeClass("epkb-wizard-button-container--first-step");let t=e.find(".epkb-wsb-step--active").attr("id"),i=Number(t[t.length-1]),a=e.find(".epkb-wizard-status-bar li.epkb-wsb-step").length;e.find(".epkb-wizard-ordering-ordering-preview").length,1===i&&e.find(".epkb-wizard-button-container").addClass("epkb-wizard-button-container--first-step"),i===a&&e.find(".epkb-wizard-button-container").addClass("epkb-wizard-button-container--final-step")}function n(t){let i=e(".epkb-wsb-step--active").attr("id"),a=Number(i[i.length-1]);t.find(".epkb-wizard-header__desc__step").removeClass("epkb-wizard-desc-active"),t.find("#epkb-wizard-desc-step-"+a).addClass("epkb-wizard-desc-active")}function o(){e("html, body").animate({scrollTop:0},0)}function d(t,i,a){var r;return e(".eckb-bottom-notice-message").length>0&&(clearTimeout(r),r=setTimeout((function(){var t;(t=e("body").find(".eckb-bottom-notice-message")).length&&t.addClass("fadeOutDown").html("")}),1e4)),'<div class="eckb-bottom-notice-message"><div class="contents"><span class="'+a+'">'+(t?"<h4>"+t+"</h4>":"")+(i||"")+"</span></div></div>"}t.find("#epkb-wizard-button-next").on("click",(function(t){t.preventDefault();let i=e(this).closest("#epkb-config-wizard-content, .epkb-config-wizard-content"),d=Number(i.find("#epkb-wizard-button-next").val()),s=Number(i.find("#epkb-wizard-button-prev").val());i.find(".epkb-wsb-step").removeClass("epkb-wsb-step--active"),i.find("#epkb-wsb-step-"+d).addClass("epkb-wsb-step--active"),i.find(".epkb-wc-step-panel").removeClass("epkb-wc-step-panel--active"),i.find("#epkb-wsb-step-"+d+"-panel").addClass("epkb-wc-step-panel--active"),i.find("#epkb-wizard-button-prev").val(s+1),i.find("#epkb-wizard-button-next").val(d+1),a(d,i),r(i),n(i),o()})),t.find("#epkb-wizard-button-prev").on("click",(function(t){t.preventDefault();let i=e(this).closest("#epkb-config-wizard-content, .epkb-config-wizard-content"),d=Number(i.find("#epkb-wizard-button-next").val()),s=Number(i.find("#epkb-wizard-button-prev").val());i.find(".epkb-wsb-step").removeClass("epkb-wsb-step--active"),i.find("#epkb-wsb-step-"+s).addClass("epkb-wsb-step--active"),i.find(".epkb-wc-step-panel").removeClass("epkb-wc-step-panel--active"),i.find("#epkb-wsb-step-"+s+"-panel").addClass("epkb-wc-step-panel--active"),i.find("#epkb-wizard-button-prev").val(s-1),i.find("#epkb-wizard-button-next").val(d-1),a(s,i),r(i),n(i),o()})),t.find(".epkb-wt-tab").on("click",(function(t){let a=e(this),r=a.attr("id"),n=e("#"+r+"-panel");e(".epkb-wt-tab").removeClass("epkb-wt--active"),a.addClass("epkb-wt--active"),e(".epkb-wt-panel").removeClass(" epkb-wt-panel--active").css({opacity:"0"}),n.addClass("epkb-wt-panel--active"),n.animate({opacity:"1"},200);let o=JSON.parse(n.find(".theme-values").val());o&&(e("#epkb-public-styles-inline-css").html(`\n\t\t\t\t#epkb-content-container .epkb-nav-tabs .active:after {\n\t\t\t\t\tborder-top-color: ${o.tab_nav_active_background_color}!important\n\t\t\t\t}\n\t\t\t\t#epkb-content-container .epkb-nav-tabs .active {\n\t\t\t\t\tbackground-color: ${o.tab_nav_active_background_color}!important\n\t\t\t\t}\n\t\t\t\t#epkb-content-container .epkb-nav-tabs .active .epkb-category-level-1,\n\t\t\t\t#epkb-content-container .epkb-nav-tabs .active p {\n\t\t\t\t\tcolor: ${o.tab_nav_active_font_color}!important\n\t\t\t\t}\n\t\t\t\t#epkb-content-container .epkb-nav-tabs .active:before {\n\t\t\t\t\tborder-top-color: ${o.tab_nav_border_color}!important\n\t\t\t\t}\t\t\n\t\t\t`),original_styles=e("#epkb-public-styles-inline-css").html()),i=!0})),e(".epkb-wizard-slug input").on("change keyup paste",(function(){let t=e(this).closest("#epkb-config-wizard-content, .epkb-config-wizard-content"),i=t.find(".epkb-wizard-slug input");if(0==i.length)return!0;let a=i.val(),r=!0;a.startsWith("http")&&(r=!1),a.startsWith("www")&&(r=!1),a.endsWith(".")&&(r=!1),a.endsWith(".com")&&(r=!1),a.endsWith(".org")&&(r=!1),r?(t.find("#epkb-wizard-slug-error").hide(),t.find("#epkb-wizard-button-next").prop("disabled",!1),i.removeClass("epkb-wizard-input-error")):(t.find("#epkb-wizard-slug-error").show(),t.find("#epkb-wizard-button-next").prop("disabled","disabled"),i.addClass("epkb-wizard-input-error"))})),e(".epkb-wizard-slug input").trigger("change");let s=e(".epkb-wizard-ordering-ordering-preview");function p(t=!0){let i=e("#eckb-wizard-ordering__page"),a={categories_display_sequence:i.find("input[name=categories_display_sequence]:checked").val(),articles_display_sequence:i.find("input[name=articles_display_sequence]:checked").val(),show_articles_before_categories:i.find("input[name=show_articles_before_categories]:checked").val(),sidebar_show_articles_before_categories:i.find("input[name=show_articles_before_categories]:checked").val()},r={action:"epkb_wizard_update_order_view",_wpnonce_epkb_ajax_action:i.find("#_wpnonce_epkb_ajax_action").val(),sequence_settings:a,epkb_kb_id:i.find("#epkb_wizard_kb_id").val()};l(i,r,(function(t){if(void 0!==t.html){let r="";t.message.length&&(r+='<h1 class="eckb-wisard-ordering-title">'+t.message+"</h1>"),r+=t.html,i.find(".epkb-wizard-ordering-ordering-preview").html(r),function(t,i){if(!t&&!i)return!1;i&&(e(".epkb-wizard-ordering-ordering-preview .epkb-top-categories-list").sortable({axis:"x",forceHelperSize:!0,forcePlaceholderSize:!0,opacity:.8,placeholder:"epkb-sortable-placeholder"}),e(".epkb-wizard-ordering-ordering-preview .eckb-categories-list, .epkb-wizard-ordering-ordering-preview .elay-sidebar__cat-container").sortable({axis:"x,y",forceHelperSize:!0,forcePlaceholderSize:!0,opacity:.8,placeholder:"epkb-sortable-placeholder"}),e(".epkb-wizard-ordering-ordering-preview .eckb-sub-category-ordering").sortable({axis:"x,y",forceHelperSize:!0,forcePlaceholderSize:!0,opacity:.8,placeholder:"epkb-sortable-placeholder"}),e(".epkb-wizard-ordering-ordering-preview .eckb-sub-sub-category-ordering").sortable({axis:"x,y",forceHelperSize:!0,forcePlaceholderSize:!0,opacity:.8,placeholder:"epkb-sortable-placeholder"}));t&&e(".epkb-wizard-ordering-ordering-preview .epkb-articles").sortable({axis:"y",forceHelperSize:!0,forcePlaceholderSize:!0,opacity:.8,placeholder:"epkb-sortable-placeholder"});e(".epkb-wizard-ordering-ordering-preview").find("a").css("cursor","move","important"),e(".epkb-wizard-ordering-ordering-preview .epkb-category-level-2-3").on("click",(function(){e(this).parent().children("ul").toggleClass("active")}))}("user-sequenced"==a.articles_display_sequence,"user-sequenced"==a.categories_display_sequence)}}),!1,"",t)}s.length&&e("#eckb-wizard-ordering__page").on("change","input",p),e(".epkb-admin__secondary-panel__order-articles").on("click",(function(){s.hasClass("epkb-wizard-ordering-ordering-preview--init")||(s.addClass("epkb-wizard-ordering-ordering-preview--init"),p())})),e("#eckb-wizard-ordering__page #epkb-wizard-button-next").on("click",(function(){p(!1)}));let c=e(".eckb-wizard-global-page");if(c.length&&(c.find("#epkb-wsb-step-1-panel .eckb-wizard-option-heading").trigger("click"),e(".notice-epkb_changed_slug").remove(),e(".notice-epkb-no-main-pages").length&&(e(".notice-epkb-no-main-pages").appendTo(e("#epkb-wsb-step-1-panel")),e(".notice-epkb-no-main-pages").find(".epkb-notice-dismiss").remove())),c.find(".eckb_slug").length){let t=!1,i=c.find("#kb_articles_common_path").val();c.find(".eckb_slug").each((function(){e(this).data("path")==i&&(e(this).prop("checked","checked"),t=!0)})),t||(c.find(".eckb_slug").eq(0).prop("checked","checked"),e("#kb_articles_common_path").val(c.find(".eckb_slug").eq(0).data("path"))),c.find(".eckb_slug").on("change",(function(){e("#kb_articles_common_path").val(e(this).data("path")),c.data("kb-main-page-id",e(this).data("kb-main-page-id"))}))}function l(t,i,a,r,n,o=!1){let s,p;a=void 0===a?"epkb_callback_noop":a,e.ajax({type:"POST",dataType:"json",data:i,url:ajaxurl,beforeSend:function(e){o||b("show",n)}}).done((function(e){p=e||"",(p.error||void 0===p.message)&&(s=p.message?p.message:d("",epkb_vars.reload_try_again,"error"))})).fail((function(e,t,i){s=i?" ["+i+"]":epkb_vars.unknown_error,s=d(epkb_vars.error_occurred+". "+epkb_vars.msg_try_again,s,"error")})).always((function(){o||b("remove",""),s?(t.find(".eckb-bottom-notice-message").replaceWith(s),e("html, body").animate({scrollTop:0},"slow")):(o||!p.error&&void 0!==p.message&&p.message&&t.find(".eckb-bottom-notice-message").replaceWith(d("",p.message,"success")),"function"==typeof a?(p=void 0===p?"":p,a(p)):r&&location.reload())}))}function b(t,i){if("show"===t){let t='<div class="epkb-admin-dialog-box-loading"><div class="epkb-admin-dbl__header"><div class="epkb-admin-dbl-icon epkbfa epkbfa-hourglass-half"></div>'+(i?'<div class="epkb-admin-text">'+i+"</div>":"")+'</div></div><div class="epkb-admin-dialog-box-overlay"></div>';e("body").append(t)}else"remove"===t&&(e(".epkb-admin-dialog-box-loading").remove(),e(".epkb-admin-dialog-box-overlay").remove())}e(document.body).on("click","#categories_in_url_enabled__toggle input",(function(){e(this).is(":checked")?(c.find("#categories_in_url_enabled").val("on"),c.find(".epkb-wso-with-category__category").removeClass("epkb-wso-with-category__category--off")):(c.find("#categories_in_url_enabled").val("off"),c.find(".epkb-wso-with-category__category").addClass("epkb-wso-with-category__category--off"))})),e(".eprf-leave-feedback-form").on("submit",!1),e(".epkb-wizard-button-apply").on("click",(function(t){let i=e(this).closest(".epkb-admin__section-wrap"),a=e(this).data("wizard-type"),r={},n={wizard_type:a,action:"epkb_apply_wizard_changes",_wpnonce_epkb_ajax_action:i.find("#_wpnonce_epkb_ajax_action").val(),epkb_wizard_kb_id:i.find("#epkb_wizard_kb_id").val(),kb_main_page_id:i.find(".epkb-config-wizard-content").data("kb-main-page-id")};if("ordering"==a){if(i.find(".epkb-radio-buttons-container input[type=radio]:checked").each((function(){r[e(this).attr("name")]=e(this).val()})),void 0===r.show_articles_before_categories&&(r.show_articles_before_categories=i.find("#original_show_articles_before_categories").val()),r.sidebar_show_articles_before_categories=r.show_articles_before_categories,0==e(".epkb-wizard-ordering-ordering-preview").find("*").length&&("user-sequenced"==r.articles_display_sequence||"user-sequenced"==r.categories_display_sequence))return e("#epkb-wizard-button-next").trigger("click"),!1;n.epkb_new_sequence=function(){let t="";return e(".epkb-wizard-ordering-ordering-preview").find("#epkb-content-container").length&&(e(".epkb-wizard-ordering-ordering-preview").append('<div class="epkb-virtual-articles" style="display:none!important;">'+e(".epkb-wizard-ordering-ordering-preview").find("#epkb-content-container").html()+"</div>"),e(".epkb-virtual-articles").find("ul.epkb-articles").each((function(){if(e(this).next().length&&"UL"==e(this).next().prop("tagName")){let t=e(this).parent();e(this).appendTo(t)}}))),e(".epkb-wizard-ordering-ordering-preview #elay-sidebar-layout-page-container").find(".elay-sidebar").length&&(e(".epkb-wizard-ordering-ordering-preview #elay-sidebar-layout-page-container").append('<div class="epkb-virtual-articles" style="display:none!important;">'+e(".epkb-wizard-ordering-ordering-preview #elay-sidebar-layout-page-container").find(".elay-sidebar").html()+"</div>"),e(".epkb-wizard-ordering-ordering-preview .epkb-virtual-articles").find("ul.elay-articles").each((function(){if(e(this).next().length&&"UL"==e(this).next().prop("tagName")){let t=e(this).parent();e(this).appendTo(t)}}))),e(".epkb-wizard-ordering-ordering-preview #elay-grid-layout-page-container").length?(e(".epkb-wizard-ordering-ordering-preview").find("[data-kb-type]").each((function(i,a){let r=e(this).data("kb-top-category-id")?e(this).data("kb-top-category-id"):"";if(r&&(t+="xx"+r+"xcategory"),void 0!==e(this).attr("data-kb-type")&&"top-category-no-articles"==e(this).attr("data-kb-type"))return!0;let n=void 0===e(this).data("kb-category-id")?e(this).data("kb-article-id"):e(this).data("kb-category-id");void 0!==n&&(t+="xx"+n+"x"+e(this).attr("data-kb-type"))})),t):(e(".epkb-wizard-ordering-ordering-preview #elay-sidebar-container-v2").length&&(e(".epkb-wizard-ordering-ordering-preview #elay-sidebar-container-v2").append('<div class="epkb-virtual-articles" style="display:none!important;">'+e(".epkb-wizard-ordering-ordering-preview #elay-sidebar-container-v2").html()+"</div>"),e(".epkb-wizard-ordering-ordering-preview .epkb-virtual-articles").find("ul.elay-articles").each((function(){if(e(this).next().length&&"UL"==e(this).next().prop("tagName")){let t=e(this).parent();e(this).appendTo(t)}}))),e(".epkb-wizard-ordering-ordering-preview").find(".epkb-virtual-articles [data-kb-type]").each((function(i,a){let r=e(this).data("kb-top-category-id")?e(this).data("kb-top-category-id"):"";if(r&&(t+="xx"+r+"xcategory"),void 0!==e(this).attr("data-kb-type")&&"top-category-no-articles"==e(this).attr("data-kb-type"))return!0;let n=void 0===e(this).data("kb-category-id")?e(this).data("kb-article-id"):e(this).data("kb-category-id");void 0!==n&&(t+="xx"+n+"x"+e(this).attr("data-kb-type"))})),e(".epkb-wizard-ordering-ordering-preview .epkb-virtual-articles").remove(),t)}(),n.top_cat_sequence=function(){let t="";return"yes"===e("#use_top_sequence").val()&&void 0!==e(".epkb-wizard-ordering-ordering-preview .epkb-top-categories-list")?(e(".epkb-wizard-ordering-ordering-preview .epkb-top-categories-list").children().each((function(i,a){let r=e(this).find("[data-kb-category-id]").data("kb-category-id");r&&(t+="xx"+r)})),t):t}()}else"global"==a&&(i.find(".eckb-wizard-single-text input, input[name=kb_articles_common_path], input[name=categories_in_url_enabled]").each((function(){"undefined"!==r[e(this).attr("name")]&&(r[e(this).attr("name")]=e(this).val())})),i.find(".eckb-wizard-single-radio input[type=radio]:checked, .radio-buttons-vertical  input[type=radio]:checked, .radio-buttons-horizontal input[type=radio]:checked").each((function(){"undefined"!==r[e(this).attr("name")]&&(r[e(this).attr("name")]=e(this).val())})),i.find(".eckb-wizard-single-checkbox input").each((function(){"undefined"!==r[e(this).attr("name")]&&(e(this).prop("checked")?r[e(this).attr("name")]="on":r[e(this).attr("name")]="off")})));n.kb_config=r,l(i,n,(function(e){"ordering"==a?!e.error&&e.message:"global"==a&&(e.error||void 0===e.message||(i.find("#epkb-wsb-step-2-panel").removeClass("epkb-wc-step-panel--active"),i.find("#epkb-wsb-step-3-panel").addClass("epkb-wc-step-panel--active").show(),location.reload()))}),!1,epkb_vars.save_config)})),setTimeout((function(){e(".epkb-admin-dialog-box-loading").remove(),e(".epkb-admin-dialog-box-overlay").remove()}),500)}));