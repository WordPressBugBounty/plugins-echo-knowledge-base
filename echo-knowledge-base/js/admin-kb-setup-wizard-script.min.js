jQuery(document).ready((function(e){let t=e("#epkb-config-wizard-content");if(t.length<=0)return;let a=e(".epkb-admin__error-form__container");function i(a){!function(e){t.find(".epkb-setup-wizard-step-tab").removeClass("epkb-setup-wizard-step-tab--active epkb-setup-wizard-step-tab--completed");let a=t.find(".epkb-setup-wizard-step-tab--"+e);a.addClass("epkb-setup-wizard-step-tab--active"),a.prevAll(".epkb-setup-wizard-step-tab").addClass("epkb-setup-wizard-step-tab--completed")}(a),e(".epkb-wc-step-header").removeClass("epkb-wc-step-header--active");const i=e(".epkb-wc-step-header--"+a);i.addClass("epkb-wc-step-header--active"),function(t){e(".epkb-wc-step-panel").removeClass("epkb-wc-step-panel--active"),e(".eckb-wizard-step-"+t).addClass("epkb-wc-step-panel--active"),e(".epkb-wc-step-panel-button").removeClass("epkb-wc-step-panel-button--active");let a=e(".epkb-wizard-content .epkb-wc-step-panel").length;1===t&&e(".epkb-wsb-step-1-panel-button").addClass("epkb-wc-step-panel-button--active");if(1!==t&&t<a){let a=e(".epkb-wsb-step-2-panel-button");a.addClass("epkb-wc-step-panel-button--active"),a.find(".epkb-setup-wizard-button-prev").val(t-1),a.find(".epkb-setup-wizard-button-next").val(t+1)}t===a&&e(".epkb-wsb-step-3-panel-button").addClass("epkb-wc-step-panel-button--active")}(a);const s=e(".epkb-config-setup-wizard-modular .epkb-setup-wizard-theme-content-show-option");if(s.length>0&&i.hasClass("epkb-wc-step-header--design")){let t=e('.epkb-config-setup-wizard-modular input[name="epkb-layout"]:checked').val();void 0===t&&(t="");const a=e(".epkb-config-setup-wizard-modular .epkb-wizard-content .eckb-wizard-step-design");s.show(),e(".epkb-config-setup-wizard-modular input[name=epkb-setup-wizard-theme-content-show-option__toggle]").prop("checked")?a.addClass("epkb-wc-step-panel--active"):a.removeClass("epkb-wc-step-panel--active")}e("html, body").animate({scrollTop:0},0)}function s(){const t=e(".epkb-setup-wizard-sidebar input[name=article_navigation]:checked").val(),a=e(".epkb-setup-wizard-sidebar input[name=article_location]:checked").val();let i=7;"categories_articles"===t?i="left"===a?1:2:"top_categories"===t?i="left"===a?3:4:"current_category_articles"===t&&(i="left"===a?5:6),e(".epkb-setup-wizard-sidebar .epkb-setup-wizard__featured-img-container").removeClass("epkb-setup-wizard__featured-img-container--active"),e(`.epkb-setup-wizard-sidebar .epkb-setup-wizard__featured-img-container[data-value=${i}]`).addClass("epkb-setup-wizard__featured-img-container--active")}function o(a){let i=t.find(".epkb-setup-wizard-option__navigation-selector"),s=i.data("hide-none-on-layout"),o=i.data("current-value");void 0!==s&&a===s?(i.find('[name="article_navigation"][value="none"]').parent(".epkb-input-container").hide(),"none"===o?e(i.find('[name="article_navigation"]')[0]).prop("checked",!0).trigger("change"):i.find('[name="article_navigation"][value="'+o+'"]').prop("checked",!0).trigger("change")):(i.find('[name="article_navigation"][value="none"]').parent(".epkb-input-container").show().trigger("change"),i.find('[name="article_navigation"][value="'+o+'"]').prop("checked",!0).trigger("change"))}function p(t,a){if("show"===t){let t='<div class="epkb-admin-dialog-box-loading"><div class="epkb-admin-dbl__header"><div class="epkb-admin-dbl-icon epkbfa epkbfa-hourglass-half"></div>'+(a?'<div class="epkb-admin-text">'+a+"</div>":"")+'</div></div><div class="epkb-admin-dialog-box-overlay"></div>';e("body").append(t)}else"remove"===t&&(e(".epkb-admin-dialog-box-loading").remove(),e(".epkb-admin-dialog-box-overlay").remove())}t.find(".epkb-setup-wizard-button-apply").on("click",(function(i){let s=[],o={action:"epkb_apply_setup_wizard_changes",_wpnonce_epkb_ajax_action:e("#_wpnonce_epkb_ajax_action").val(),epkb_wizard_kb_id:e("#epkb_wizard_kb_id").val(),sidebar_selection:"0"},n=e('input[name="epkb-layout"]:checked').val();void 0===n&&(n=""),e(".epkb-menu-checkbox input[type=checkbox]:checked").length&&e(".epkb-menu-checkbox input[type=checkbox]:checked").each((function(){s.push(e(this).prop("name").split("epkb_menu_")[1])})),e(".epkb-setup-wizard-sidebar input[type=radio]:checked").length&&(o.sidebar_selection=e(".epkb-setup-wizard-sidebar .epkb-setup-wizard__featured-img-container--active").data("value"));let d=e("input[name=categories_articles_sidebar_location]:checked").val();void 0===d&&(d="");let r=e(".epkb-setup-wizard-step-container--modules .epkb-setup-wizard-module-row .epkb-setup-wizard-module-row-toggle"),c=void 0===r[0]?"":e(r[0]).find("input:checked").val(),l=void 0===r[1]?"":e(r[1]).find("input:checked").val(),u=void 0===r[2]?"":e(r[2]).find("input:checked").val(),b=void 0===r[3]?"":e(r[3]).find("input:checked").val(),k=void 0===r[4]?"":e(r[4]).find("input:checked").val(),m=e(".epkb-setup-wizard-step-container--presets .epkb-setup-wizard-module-settings-row--active input:checked").val();if(void 0===m&&(m=""),m.length&&!t.hasClass("epkb-config-setup-wizard-modular--first-setup")){let t=e('[name="epkb-setup-wizard-theme-content-show-option__toggle"]'),a=t.closest(".epkb-setup-wizard-theme-content-show-option").data("current-layout");t.prop("checked")||a!==n||(m="current")}o.layout_name=n,o.kb_name=e(".epkb-wizard-name input").val(),o.kb_slug=e(".epkb-wizard-slug input").val(),o.menu_ids=s,o.categories_articles_sidebar_location=d,o.row_1_module=c,o.row_2_module=l,o.row_3_module=u,o.row_4_module=b,o.row_5_module=k,o.categories_articles_preset_name=m,o.kb_main_page_type=e('[name="epkb-main-page-type"]').length?e('[name="epkb-main-page-type"]:checked').val():"",function(i){let s,o,n=t.hasClass("epkb-config-setup-wizard-modular--first-setup")&&1===parseInt(e("#epkb_wizard_kb_id").val())?epkb_vars.creating_demo_data:epkb_vars.saving_changes;e.ajax({type:"POST",dataType:"json",data:i,url:ajaxurl,beforeSend:function(e){p("show",n)}}).done((function(t){if(o=t||"",p("remove",""),o.error||void 0===o.message)return s=o.message?o.message:(i="",n=epkb_vars.reload_try_again,'<div class="eckb-bottom-notice-message"><div class="contents"><span class="'+"error"+'">'+(i?"<h4>"+i+"</h4>":"")+(n||"")+"</span></div></div>"),e(a).find(".epkb-admin__error-form__title").text(epkb_vars.setup_wizard_error_title),e(a).find(".epkb-admin__error-form__desc").text(epkb_vars.setup_wizard_error_desc),e(a).find("#epkb-admin__error-form__message").val("Setup Wizard: "+e(s).text().trim()),void e(a).css("display","block","important");var i,n;o.redirect_to_url&&o.redirect_to_url.length>0&&(e("#epkb-wizard-success-message").addClass("epkb-dialog-box-form--active"),e("#epkb-wizard-success-message .epkb-accept-button").on("click",(function(){window.location=o.redirect_to_url})))})).fail((function(){p("remove","");let t=window.location.href.replace("&page=epkb-kb-configuration&setup-wizard-on","&page=epkb-kb-need-help&epkb_after_kb_setup");e("#epkb-wizard-success-message").addClass("epkb-dialog-box-form--active"),e("#epkb-wizard-success-message .epkb-accept-button").on("click",(function(){window.location=t}))}))}(o)})),t.find(".epkb-setup-wizard-button-next, .epkb-setup-wizard-button-prev").on("click",(function(t){t.preventDefault(),i(Number(e(this).val()))})),e(document).on("click",".epkb-setup-wizard-step-tab",(function(){i(Number(e(this).data("step")))})),e(document).on("change",".epkb-config-setup-wizard-modular input[name=epkb-setup-wizard-theme-content-show-option__toggle]",(function(){const t=e(".epkb-config-setup-wizard-modular .epkb-wizard-content .eckb-wizard-step-design");e(this).prop("checked")?t.addClass("epkb-wc-step-panel--active"):t.removeClass("epkb-wc-step-panel--active")})),e(document).on("change",".epkb-setup-wizard-sidebar input[name=article_navigation]",s),e(document).on("change",".epkb-setup-wizard-sidebar input[name=article_location]",s),e(".epkb-setup-wizard-step__item-description__option__label").on("click",(function(){e(this).closest(".epkb-wc-step-panel").find(".epkb-setup-option-container").removeClass("epkb-setup-option-container--active"),e(this).closest(".epkb-setup-wizard-step__item-content").find(".epkb-setup-option-container").addClass("epkb-setup-option-container--active")})),e(".epkb-setup-wizard-features-choice__option__label").on("click",(function(){e(this).closest(".epkb-wc-step-panel").find(".epkb-setup-wizard-features-choice").removeClass("epkb-setup-wizard-features-choice--active"),e(this).closest(".epkb-setup-wizard-features-choice").addClass("epkb-setup-wizard-features-choice--active")})),e(".eckb-wizard-step-layout .epkb-setup-option__featured-img, .epkb-setup-wizard-features-choice img").on("click",(function(){let t=`\n\t\t\t<div class="epkb-config-wizard-image-popup-overlay">\n\t\t\t\t<div class="epkb-config-wizard-image-popup-container">\n\t\t\t\t\t<img src="${e(this).attr("src")}" alt="">\n\t\t\t\t\t<span class="epkb-config-wizard-image-close-popup">&times;</span>\n\t\t\t\t</div>\n\t\t\t</div>`;e("body").append(t),e(".epkb-config-wizard-image-popup-container").click((function(){e(this).toggleClass("epkb-zoomed")})),e(".epkb-config-wizard-image-close-popup").click((function(){e(".epkb-config-wizard-image-popup-overlay").remove(),i()}));const a=t=>{$target=e(t.target),!$target.closest(".epkb-config-wizard-image-popup-container").length&&e(".epkb-config-wizard-image-popup-container").is(":visible")&&(e(".epkb-config-wizard-image-popup-overlay").remove(),i())},i=()=>{document.removeEventListener("click",a)};setTimeout((function(){document.addEventListener("click",a)}),10)})),e('.epkb-wizard-slug input[type="text"]').on("input",(function(){e("#epkb-wizard-slug-target").text(e(this).val())})),function(){let t=e(".epkb-setup-wizard-module-row--resource-link--disabled");if(t.length){e(".epkb-setup-wizard-hidden-rows-title").addClass("epkb-setup-wizard-hidden-rows-title--active"),t.closest(".epkb-setup-wizard-module-rows-list").append(t)}}(),e(document).on("change",".epkb-setup-wizard-module-row-toggle input",(function(){let a=e(this).val(),i=e(this).closest(".epkb-setup-wizard-module-row"),s=i.data("row-module"),o=t.find(".epkb-setup-wizard-step-container--presets"),p=t.find(".epkb-setup-wizard-step-container--layout"),n=e(this).closest(".epkb-setup-wizard-module-rows-list");if("none"===a)i.removeClass("epkb-setup-wizard-module-row--active"),n.append(i),i.removeClass("epkb-setup-wizard-module-row--activated"),i.addClass("epkb-setup-wizard-module-row--inactivated"),setTimeout((()=>{i.removeClass("epkb-setup-wizard-module-row--inactivated")}),3e4);else{i.addClass("epkb-setup-wizard-module-row--active");let e=n.find('.epkb-setup-wizard-module-row--active:not([data-row-module="'+s+'"])').last();e.length?i.insertAfter(e):n.prepend(i),i.removeClass("epkb-setup-wizard-module-row--inactivated"),i.addClass("epkb-setup-wizard-module-row--activated"),setTimeout((()=>{i.removeClass("epkb-setup-wizard-module-row--activated")}),3e4)}e(".epkb-setup-wizard-step-container--modules .epkb-setup-wizard-module-row").length-e(".epkb-setup-wizard-step-container--modules .epkb-setup-wizard-module-row--active").length?e(".epkb-setup-wizard-hidden-rows-title").addClass("epkb-setup-wizard-hidden-rows-title--active"):e(".epkb-setup-wizard-hidden-rows-title").removeClass("epkb-setup-wizard-hidden-rows-title--active"),"categories_articles"===s&&("none"===a?(p.addClass("epkb-setup-wizard-step-container--hide"),o.addClass("epkb-setup-wizard-step-container--hide"),t.find(".epkb-setup-wizard-no-categories-articles-message").addClass("epkb-setup-wizard-no-categories-articles-message--active")):(p.removeClass("epkb-setup-wizard-step-container--hide"),o.removeClass("epkb-setup-wizard-step-container--hide"),t.find(".epkb-setup-wizard-no-categories-articles-message").removeClass("epkb-setup-wizard-no-categories-articles-message--active")))})),e(document).on("click",".epkb-setup-wizard-module-row-sequence",(function(){let t=e(this).closest(".epkb-setup-wizard-module-row");if(t.hasClass("epkb-setup-wizard-module-row--active"))if(t.addClass("epkb-setup-wizard-module-row--selected"),setTimeout((()=>{t.removeClass("epkb-setup-wizard-module-row--selected")}),3e4),e(this).hasClass("epkb-setup-wizard-module-row-sequence--up")){let e=t.prev();e.length&&t.slideUp(500,(function(){t.insertBefore(e),t.slideDown(500)}))}else{let e=t.next();e.length&&e.hasClass("epkb-setup-wizard-module-row--active")&&t.slideUp(500,(function(){t.insertAfter(e),t.slideDown(500)}))}})),e(document).on("change",".epkb-setup-wizard-module-sidebar-selector input",(function(){let t=e(this).closest(".epkb-setup-wizard-step-container--modules");t.find(".epkb-setup-wizard-module-sidebar").removeClass("epkb-setup-wizard-module-sidebar--active"),t.find(".epkb-setup-wizard-module--categories_articles").removeClass("epkb-setup-wizard-module-sidebar--active"),"left"===e(this).val()&&(t.find(".epkb-setup-wizard-module-sidebar--left").addClass("epkb-setup-wizard-module-sidebar--active"),t.find(".epkb-setup-wizard-module--categories_articles").addClass("epkb-setup-wizard-module-sidebar--active")),"right"===e(this).val()&&(t.find(".epkb-setup-wizard-module-sidebar--right").addClass("epkb-setup-wizard-module-sidebar--active"),t.find(".epkb-setup-wizard-module--categories_articles").addClass("epkb-setup-wizard-module-sidebar--active"))})),e(document).on("change",'.epkb-setup-wizard-step-container--layout input[name="epkb-layout"]',(function(){let a=e(this).val(),i=t.find(".epkb-setup-wizard-step-container--modules");i.find(".epkb-setup-wizard-module--categories_articles").find(".epkb-setup-wizard-module-layout").removeClass("epkb-setup-wizard-module-layout--active"),i.find(".epkb-setup-wizard-module--categories_articles").find(".epkb-setup-wizard-module-layout--"+a).addClass("epkb-setup-wizard-module-layout--active");let s=t.find(".epkb-setup-wizard-step-container--presets");s.find(".epkb-setup-wizard-module-layout").removeClass("epkb-setup-wizard-module-layout--active"),s.find(".epkb-setup-wizard-module-settings-row").removeClass("epkb-setup-wizard-module-settings-row--active"),s.find(".epkb-setup-wizard-module-layout--"+a).addClass("epkb-setup-wizard-module-layout--active"),s.find(".epkb-setup-wizard-module-settings-row--"+a).addClass("epkb-setup-wizard-module-settings-row--active"),o(a)})),o(t.find('.epkb-setup-wizard-step-container--layout input[name="epkb-layout"]:checked').val()),e(document).on("change",".epkb-setup-wizard-module-preset-selector input",(function(){let a=e(this).val(),i=t.find(".epkb-setup-wizard-step-container--presets").find(".epkb-setup-wizard-module-layout--active");i.find(".epkb-setup-wizard-module-preset").removeClass("epkb-setup-wizard-module-preset--active"),i.find(".epkb-setup-wizard-module-preset--"+a).addClass("epkb-setup-wizard-module-preset--active")})),function(){let a;t.on("click",".epkb__option-tooltip__button",(function(){const t=e(this).parent().find(".epkb__option-tooltip__contents");let i="block"==t.css("display");t.fadeOut(),i||(clearTimeout(a),t.fadeIn())})),t.on("mouseenter",".epkb__option-tooltip__button, .epkb__option-tooltip__contents",(function(){const t=e(this).parent().find(".epkb__option-tooltip__contents");clearTimeout(a),t.fadeIn()})),t.on("mouseleave",".epkb__option-tooltip__button, .epkb__option-tooltip__contents",(function(){const t=e(this).parent().find(".epkb__option-tooltip__contents");a=setTimeout((function(){t.fadeOut()}),1e3)})),t.find("#epkb-wsb-step-2-panel .epkb-setup-wizard-module-row .epkb-setup-wizard-module-row-toggle .epkb-radio-buttons-container .epkb-input-container").each((function(t,a){"none"===e(a).find("input.epkb-input").val()?e(a).find("label.epkb-label").attr("data-tooltip","Hide Row"):e(a).find("label.epkb-label").attr("data-tooltip","Show Row")})),t.find("#epkb-wsb-step-2-panel .epkb-setup-wizard-module-row .epkb-setup-wizard-module-row-right-settings .epkb-setup-wizard-module-row--resource-links-activate").on("click",(function(t){e("#epkb-dialog-pro-feature-ad-resource-links").addClass("epkb-dialog-pro-feature-ad--active")})),t.find("#epkb-wsb-step-3-panel .epkb-setup-wizard-step__item .epkb-setup-wizard-step__item-description .epkb-setup-wizard-step__item-description__button-pro").on("click",(function(t){const a=e(this).data("target");e("#"+a).addClass("epkb-dialog-pro-feature-ad--active")})),t.find(".epkb-dialog-pro-feature-ad .epkb-dbf__close").on("click",(function(){e(this).closest(".epkb-dialog-pro-feature-ad").removeClass("epkb-dialog-pro-feature-ad--active")})),e(document).on("click",(function(t){let a=e(t.target);a.closest(".epkb-setup-wizard-module-row--resource-links-activate").length||a.closest(".epkb-dialog-pro-feature-ad").length||a.closest(".epkb-setup-wizard-step__item-description__button-pro").length||e(".epkb-dialog-pro-feature-ad").removeClass("epkb-dialog-pro-feature-ad--active")})),t.find(".eckb-wizard-step-2 .epkb-setup-option__featured-img-container").on("click",(function(a){var i;a.preventDefault(),a.stopPropagation(),t.find(".image_zoom").remove();var s=e(this).find("img");i=s.length>1?e(s[0]).is(":visible")?e(s[0]).attr("src"):e(s[1]).is(":visible")?e(s[1]).attr("src"):e(s[2]).attr("src"):e(this).find("img").attr("src"),e(this).after('<div id="epkb_image_zoom" class="epkb-setup-wizard-image_zoom"><div class="epkb-setup-wizard-image_zoom__content"><img src="'+i+'" class="epkb-setup-wizard-image_zoom__image"><span class="epkb-setup-wizard-image_zoom__close epkbfa epkbfa-close"></span></div></div>');let o=e(document).scrollTop();e("html, body").css({overflow:"hidden"}),e("html, body").on("click",(function(){e("#epkb_image_zoom").remove(),e(this).css({overflow:"initial"}).off("click").animate({scrollTop:o},0)}))}))}(),e(document).on("click",".epkb-close-notice",(function(){e(this).parent().addClass("fadeOutDown")})),e(a).on("click",".epkb-close-notice, .epkb-admin__error-form__btn-cancel",(function(){window.location=epkb_vars.need_help_url})),e(a).find("#epkb-admin__error-form").on("submit",(function(t){t.preventDefault();let i=e(this);e.ajax({type:"POST",dataType:"json",url:ajaxurl,data:i.serialize(),beforeSend:function(t){i.find(".epkb-admin__error-form__btn-wrap, input, label, textarea").slideUp("fast"),e(a).find(".epkb-admin__error-form__response").addClass("epkb-admin__error-form__response--active"),e(a).find(".epkb-admin__error-form__response").html(epkb_vars.sending_error_report)}}).done((function(t){void 0!==t.success&&0==t.success||void 0!==t.success&&1==t.success?e(a).find(".epkb-admin__error-form__response").html(t.data):e(a).find(".epkb-admin__error-form__response").html(epkb_vars.send_report_error)})).fail((function(t,i,s){e(a).find(".epkb-admin__error-form__response").html(epkb_vars.send_report_error)})).always((function(){e(a).find("input, textarea").prop("disabled",!1),setTimeout((function(){window.location=epkb_vars.need_help_url}),1e3)}))})),e(document).on("click",".epkb-notice-dismiss",(function(t){t.preventDefault(),e("#"+e(this).data("notice-id")).slideUp();var a={action:"epkb_dismiss_ongoing_notice",epkb_dismiss_id:e(this).data("notice-id")};e.ajax({type:"POST",dataType:"json",url:ajaxurl,data:a})}))}));