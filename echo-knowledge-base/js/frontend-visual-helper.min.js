"use strict";jQuery(document).ready(function(e){function i(){const i=e("body").width();let t="",a=0,n=0;for(const i of o)if(e(i.checkSelector).length){t=i.prefix,a=Math.round(e(i.containerSelector).width()),n=Math.round(e(i.searchSelector).width());break}t&&(n&&e(`.js-epkb-${t}-search-width`).text(`${n}px`),a&&e(`.js-epkb-${t}-width-container`).text(`${a}px`),i&&e(`.js-epkb-${t}-width`).text(`${i}px`))}function t(e,i,t){if("show"===e){let e='<div class="epkb-admin-dialog-box-loading"><div class="epkb-admin-dbl__header"><div class="epkb-admin-dbl-icon epkbfa epkbfa-hourglass-half"></div>'+(i?'<div class="epkb-admin-text">'+i+"</div>":"")+'</div></div><div class="epkb-admin-dialog-box-overlay"></div>';t.append(e)}else"remove"===e&&(t.find(".epkb-admin-dialog-box-loading").remove(),t.find(".epkb-admin-dialog-box-overlay").remove())}localStorage.getItem("epkb_template_changed")&&(setTimeout(function(){e(".js-epkb-accordion-toggle#epkb-vshelp-switch-template").trigger("click")},100),localStorage.removeItem("epkb_template_changed")),e(".js-epkb-accordion-toggle").on("click",function(i){i.preventDefault(),e(".epkb-vshelp-accordion-body").not(e(this).parents(".epkb-vshelp-accordion-wrapper").find(".epkb-vshelp-accordion-body")).slideUp(),e(this).parents(".epkb-vshelp-accordion-wrapper").find(".epkb-vshelp-accordion-body").slideToggle()}),e(".js-epkb-side-menu-toggle").on("click",function(i){let t=e(this).find('input[type="checkbox"]'),o=e(".epkb-vshelp-side-menu-wrapper"),a=e(".epkb-vshelp-info-icon"),n=e(".epkb-vshelp-info-modal"),c=e(".epkb-vshelp-hide-switcher");t.prop("checked")?(o.slideDown(),a.show(),c.addClass("epkb-vshelp-hide-switcher--hidden")):(o.slideUp(),a.hide(),n.hide(),c.removeClass("epkb-vshelp-hide-switcher--hidden"))}),e(".epkb-vshelp-hide-switcher").on("click",function(){e(this).parents(".epkb-vshelp-toggle-wrapper").hide();let i={action:"epkb_visual_helper_update_switch_settings",kb_id:e(this).data("kbid")};e.ajax({type:"POST",dataType:"json",data:i,url:epkb_vars.ajaxurl}).success(function(e){})}),e(".epkb-settings-control-circle-radio input").on("change",function(){let i={action:"epkb_visual_helper_switch_template",kb_id:e(this).data("kbid"),current_template:e(this).val(),prop_name:e(this).attr("name")};e.ajax({type:"POST",dataType:"json",data:i,url:epkb_vars.ajaxurl,beforeSend:function(i){e(".eckb-kb-no-content").length||e("#epkb-modular-main-page-container").append('<div class="eckb-kb-no-content"></div>'),t("show","",e("#epkb-modular-main-page-container .eckb-kb-no-content"))}}).success(function(i){i.success?(localStorage.setItem("epkb_template_changed",!0),window.location.reload(!0)):t("remove","",e("#epkb-modular-main-page-container .eckb-kb-no-content"))})});const o=[{checkSelector:"#epkb-modular-main-page-container",prefix:"mp",containerSelector:"#epkb-ml__module-categories-articles",searchSelector:"#epkb-ml__row-1"},{checkSelector:"#eckb-article-page-container-v2",prefix:"ap",containerSelector:"#eckb-article-body",searchSelector:"#eckb-article-header"},{checkSelector:"#eckb-archive-body",prefix:"cp",containerSelector:"#eckb-archive-body",searchSelector:"#eckb-archive-header"}];i(),e(window).on("resize",function(){i()}),e(".epkb-vshelp-info-modal").each(function(i,t){let o=e(t),a=o.data("selectors").split(","),n=0;for(let i of a){let t=e(i).eq(0);if(t.length){let e=o.data("section-id");t.addClass("epkb-vshelp--has-info-icon"),t.append('<span class="ep_font_icon_info epkb-vshelp-info-icon epkb-vshelp-info-icon--'+e+"-"+n+'" id="epkb-vshelp-info-icon epkb-vshelp-info-icon--'+e+"-"+n+'" data-section-id="'+e+'"></span>'),n++}}}),e(document).on("click",".epkb-vshelp-info-icon",function(i){i.stopPropagation(),i.preventDefault(),e(".epkb-vshelp-background").remove();let t=e(this).data("section-id"),o=e(this).offset(),a=o.top,n=o.left,c=e('.epkb-vshelp-info-modal[data-section-id="'+t+'"]'),l="epkb-vshelp-info-modal--triangle-right";if(c.length)if(e(this).hasClass("epkb-vshelp-info-modal--active"))e(this).removeClass("epkb-vshelp-info-modal--active"),c.hide();else{e("#epkb-modular-main-page-container, #eckb-article-page-container-v2, #eckb-archive-page-container").append('<div class="epkb-vshelp-background"></div>');let i="";switch(a>c.find(".epkb-vshelp-info-modal__title").outerHeight()+35&&(a=a-c.find(".epkb-vshelp-info-modal__title").outerHeight()/2-e(this).outerHeight()),i=n>c.outerWidth()+35?"rightSpace":e(window).outerWidth()-n>c.outerWidth()+35?"leftSpace":"center"){case"rightSpace":n=n-c.outerWidth()-35;break;case"leftSpace":n=n+e(this).outerHeight()+35,l="epkb-vshelp-info-modal--triangle-left";break;case"center":n=e(window).outerWidth()/2-c.outerWidth()/2,a=a+e(this).outerHeight()+70,l=""}c.css({top:a+"px",left:n+"px"}),e(".epkb-vshelp-info-icon").removeClass("epkb-vshelp-info-modal--active"),e(".epkb-vshelp-info-modal").hide().removeClass("epkb-vshelp-info-modal--triangle-right epkb-vshelp-info-modal--triangle-left"),e(this).addClass("epkb-vshelp-info-modal--active"),c.addClass(l).show()}}),e(document).on("click",function(i){e(i.target).closest(".epkb-vshelp-info-icon, .epkb-vshelp-info-modal").length||(e(".epkb-vshelp-info-icon").removeClass("epkb-vshelp-info-modal--active"),e(".epkb-vshelp-info-modal").hide(),e(".epkb-vshelp-background").remove())})});