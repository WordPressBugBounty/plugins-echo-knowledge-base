!function(){"use strict";const{useState:e,useEffect:a,createElement:i}=wp.element,{__:t}=wp.i18n,{showError:s,showSuccess:c,makeApiRequest:n}=window.EPKB_AI_Util_React||{},l=({settings:e,sections:a,onChange:s,onSave:c,isSaving:n})=>i("div",{className:"epkb-ai-settings-container"},Object.entries(a).map((([a,t])=>i("div",{key:a,className:`epkb-ai-settings-section epkb-ai-settings-section--${a}`},i("div",{className:"epkb-ai-settings-section-header"},t.icon&&i("i",{className:t.icon}),i("div",{className:"epkb-ai-header-text"},i("h3",null,t.title),t.description&&i("p",{className:"epkb-ai-section-description"},t.description))),i("div",{className:"epkb-ai-settings-section-content"},Object.entries(t.fields).map((([t,c])=>((a,t,c)=>{const n=e.hasOwnProperty(a)?e[a]:t.value||"",l=`epkb-ai-${c}-${a}`;if(!(a=>!a.dependency||e[a.dependency.field]===a.dependency.value)(t))return null;switch(t.type){case"toggle":return i("div",{className:"epkb-ai-field epkb-ai-field-toggle",key:a},i("label",{className:"epkb-ai-toggle-label",htmlFor:l},i("input",{id:l,type:"checkbox",checked:"on"===n,onChange:e=>s(a,e.target.checked?"on":"off")}),i("span",{className:"epkb-ai-toggle-text"},t.label)),t.description&&i("p",{className:"epkb-ai-field-description"},t.description));case"password":return i("div",{className:"epkb-ai-field epkb-ai-field-password",key:a},i("label",{className:"epkb-ai-field-label",htmlFor:l},t.label),i("input",{id:l,type:"password",className:"epkb-ai-input",value:n||"",placeholder:t.placeholder||"",onChange:e=>s(a,e.target.value),required:t.required}),t.description&&i("p",{className:"epkb-ai-field-description"},t.description));case"text":return i("div",{className:"epkb-ai-field epkb-ai-field-text",key:a},i("label",{className:"epkb-ai-field-label",htmlFor:l},t.label),i("input",{id:l,type:"text",className:"epkb-ai-input",value:n||"",placeholder:t.placeholder||"",onChange:e=>s(a,e.target.value),required:t.required}),t.description&&i("p",{className:"epkb-ai-field-description"},t.description));case"select":return i("div",{className:"epkb-ai-field epkb-ai-field-select",key:a},i("label",{className:"epkb-ai-field-label",htmlFor:l},t.label),i("select",{id:l,className:"epkb-ai-select",value:n,onChange:e=>s(a,e.target.value)},Object.entries(t.options||{}).map((([e,a])=>i("option",{key:e,value:e},a)))),t.description&&i("p",{className:"epkb-ai-field-description"},t.description));case"number":return i("div",{className:"epkb-ai-field epkb-ai-field-number",key:a},i("label",{className:"epkb-ai-field-label",htmlFor:l},t.label),i("div",{className:"epkb-ai-input-group"},i("input",{id:l,type:"number",className:"epkb-ai-input",value:n||"",min:t.min,max:t.max,step:t.step||1,onChange:e=>s(a,parseInt(e.target.value)||0)}),t.suffix&&i("span",{className:"epkb-ai-input-suffix"},t.suffix)),t.description&&i("p",{className:"epkb-ai-field-description"},t.description));case"textarea":return i("div",{className:"epkb-ai-field epkb-ai-field-textarea",key:a},i("label",{className:"epkb-ai-field-label",htmlFor:l},t.label),i("textarea",{id:l,className:"epkb-ai-textarea",value:n||"",rows:t.rows||3,placeholder:t.placeholder||"",onChange:e=>s(a,e.target.value)}),t.description&&i("p",{className:"epkb-ai-field-description"},t.description));case"checkboxes":const e="object"==typeof n?n:{};return i("div",{className:"epkb-ai-field epkb-ai-field-checkboxes",key:a},i("label",{className:"epkb-ai-field-label"},t.label),i("div",{className:"epkb-ai-checkboxes-group"},Object.entries(t.options||{}).map((([t,c])=>i("label",{key:t,className:"epkb-ai-checkbox-label"},i("input",{type:"checkbox",checked:"on"===e[t],onChange:i=>{const c={...e};c[t]=i.target.checked?"on":"off",s(a,c)}}),i("span",{className:"epkb-ai-checkbox-text"},c))))),t.description&&i("p",{className:"epkb-ai-field-description"},t.description));case"checkbox":return"ai_disclaimer_accepted"===a&&t.description?i("div",{className:"epkb-ai-field epkb-ai-field-disclaimer",key:a,ref:e=>{if(e&&!e._initialized){e._initialized=!0;const i=e=>{"checkbox"===e.target.type&&"ai_disclaimer_accepted"===e.target.name&&s(a,e.target.checked?"on":"off")};e._changeHandler&&e.removeEventListener("change",e._changeHandler),e.addEventListener("change",i),e._changeHandler=i,setTimeout((()=>{const i=e.querySelector('input[name="ai_disclaimer_accepted"]');i&&(i.checked="on"===n,(i.checked&&"on"!==n||!i.checked&&"on"===n)&&s(a,i.checked?"on":"off"))}),0)}}},i("div",{className:"epkb-ai-field-html-content",dangerouslySetInnerHTML:{__html:t.description}})):i("div",{className:"epkb-ai-field epkb-ai-field-checkbox",key:a},i("label",{className:"epkb-ai-checkbox-label",htmlFor:l},i("input",{id:l,type:"checkbox",checked:"on"===n,onChange:e=>s(a,e.target.checked?"on":"off")}),i("span",{className:"epkb-ai-checkbox-text"},t.label)),t.description&&i("p",{className:"epkb-ai-field-description"},t.description));default:return null}})(t,c,a))))))),i("div",{className:"epkb-ai-settings-footer"},i("button",{className:"epkb-ai-button epkb-ai-button-primary",onClick:c,disabled:n},t(n?"Saving...":"Save Settings","echo-knowledge-base"))));window.EPKB_AI_GeneralSettings=window.EPKB_AI_GeneralSettings||{},window.EPKB_AI_GeneralSettings.AIAdminGeneralSettings=({settings:o,tabData:d,isLoading:p,onDataChange:r,onTabSwitch:b})=>{const[k,m]=e(!1),[g,f]=e({});a((()=>{if(d&&d.ai_config){const e={...d.ai_config,ai_disclaimer_accepted:d.ai_config.ai_disclaimer_accepted||"off",ai_beta_code:d.ai_config.ai_beta_code||""};f(e)}}),[d]);return i("div",{className:"epkb-ai-general-settings-container"},i("div",{className:"epkb-ai-general-settings-content"},i(l,{settings:g,sections:d?.settings_sections||{},onChange:(e,a)=>{f((i=>({...i,[e]:a})))},onSave:async()=>{m(!0);try{if((await n("ai/settings",{method:"POST",data:{settings:g}})).success){c(t("Settings saved successfully","echo-knowledge-base")),r({ai_config:g});const e=g.ai_key&&g.ai_key.length>0,a="on"===g.ai_disclaimer_accepted,i=g.ai_beta_code||"",s=["EPKB-BETA-2024-AI-CHAT"].includes(i.trim());a&&!("on"===o?.ai_config?.ai_disclaimer_accepted)?setTimeout((()=>{const a=e&&s?"training-data":"general-settings",i=new URL(window.location.href);i.searchParams.set("active_tab",a),window.location.href=i.toString()}),1e3):e&&a&&s&&b&&setTimeout((()=>{b("training-data")}),1e3)}}catch(e){s(e.message||t("Failed to save settings","echo-knowledge-base"))}finally{m(!1)}},isSaving:k})))}}();