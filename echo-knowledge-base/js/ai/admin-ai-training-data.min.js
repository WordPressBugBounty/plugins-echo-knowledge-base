(function(){"use strict";const{useState:e,useEffect:t,useCallback:o,createElement:n,Fragment:a,createContext:s,useContext:i,useMemo:l,useRef:c}=wp.element;const{__:r,sprintf:d}=wp.i18n;const{showError:p,showSuccess:g,makeApiRequest:b,showConfirmDialog:u,showLoadingDialog:f,clearAllEPKBSessionStorage:m,TutorialButton:h,SetupStepsGuide:k}=window.EPKB_AI_Util_React||{};const{logError:y}=window.EPKBChatUtils||{};const{SyncControls:w,SyncProgressBar:_}=window.EPKB_AI_Sync?{SyncControls:window.EPKB_AI_SyncControls,SyncProgressBar:window.EPKB_AI_SyncProgressBar}:{};const x=s();window.EPKB_AI_TrainingDataCacheContext=x;const v=({children:o})=>{const a=()=>{try{const e=sessionStorage.getItem("epkb_ai_training_data_cache");return e?JSON.parse(e):{}}catch(e){return{}}};const[s,i]=e(a);t((()=>{m();i({})}),[]);t((()=>{const e=()=>{if(document.visibilityState==="visible"){m();i({})}};document.addEventListener("visibilitychange",e);return()=>{document.removeEventListener("visibilitychange",e)}}),[]);t((()=>{const e=()=>{m()};window.addEventListener("beforeunload",e);return()=>{window.removeEventListener("beforeunload",e)}}),[]);t((()=>{try{sessionStorage.setItem("epkb_ai_training_data_cache",JSON.stringify(s))}catch(e){if(e.name==="QuotaExceededError"){i({});try{sessionStorage.removeItem("epkb_ai_training_data_cache")}catch(e){}}else{}}}),[s]);const c=l((()=>({get:e=>s[e],set:(e,t)=>{i((o=>({...o,[e]:{...t,timestamp:Date.now()}})))},remove:e=>{i((t=>{const o={...t};delete o[e];return o}))},clear:()=>{i({});m()},clearCollection:e=>{i((t=>{const o={...t};Object.keys(o).forEach((t=>{if(t.startsWith(`collection_${e}_`)){delete o[t]}}));return o}))},clearNonExistentCollections:e=>{i((t=>{const o={...t};Object.keys(o).forEach((t=>{const n=t.match(/^collection_(\d+)_/);if(n){const a=parseInt(n[1]);if(!e.includes(a)){delete o[t]}}}));return o}))}})),[s]);return n(x.Provider,{value:c},o)};const N=()=>{const e=i(x);if(!e){throw new Error("useTrainingDataCache must be used within TrainingDataCacheProvider")}return e};const C=window.EPKB_AI_DataSourceTable||(()=>n("div",null,"DataSourceTable component not loaded"));const A=({isOpen:o,onClose:s,onSave:i,noteData:l=null,collectionId:c,onDelete:d=null})=>{const[p,g]=e("");const[b,u]=e("");const[f,m]=e(false);const[h,k]=e(false);const[w,_]=e(false);t((()=>{if(!o||!l)return;g(l.title||"");if(l.training_id&&!l.content){k(true);u("");const{makeApiRequest:e,showError:t}=window.EPKB_AI_Util_React||{};if(e){e(`training-data/${l.training_id}/content`,{method:"GET"}).then((e=>{if(e&&e.data){u(e.data.processed_content||e.data.doc_content||"")}})).catch((e=>{y("AI Training Data","Failed to fetch note content",{message:e.message||"Unknown error",code:e.code,status:e.status,noteId:l?.id});if(t){t(r("Failed to load note content","echo-knowledge-base"))}})).finally((()=>{k(false)}))}else{y("AI Training Data","makeApiRequest not available",{context:"Note content loading"});k(false)}}else{u(l.content||"")}}),[o,l]);if(!o)return null;const x=async()=>{const{showError:e}=window.EPKB_AI_Util_React||{};if(!p.trim()||!b.trim()){if(e){e(r("Please enter both title and content for the note","echo-knowledge-base"))}return}m(true);try{await i({title:p,content:b,id:l?.id,training_id:l?.training_id});g("");u("");s()}catch(e){y("AI Training Data","Error saving note",{message:e.message||"Unknown error",code:e.code,status:e.status,noteId:l?.id})}finally{m(false)}};const v=async()=>{const{showConfirmDialog:e,makeApiRequest:t,showSuccess:o,showError:n}=window.EPKB_AI_Util_React||{};if(!e||!t){y("AI Training Data","Required utilities not available",{context:"Note deletion",missing:{confirmDialog:!e,apiRequest:!t}});if(n){n(r("Unable to delete note. Please refresh the page and try again.","echo-knowledge-base"))}return}const a=await e({title:r("Delete Note","echo-knowledge-base"),message:r("Are you sure you want to delete this note? This action cannot be undone.","echo-knowledge-base"),confirmText:r("Delete","echo-knowledge-base"),cancelText:r("Cancel","echo-knowledge-base"),confirmButtonClass:"epkb-ai-button-danger"});if(!a)return;_(true);try{const e=await t(`training-notes/${l.id}`,{method:"DELETE"});if(e&&e.success){if(o){o(r("Note deleted successfully","echo-knowledge-base"))}g("");u("");s();if(d){d(l.id)}}}catch(e){y("AI Training Data","Error deleting note",{message:e.message||"Unknown error",code:e.code,status:e.status,noteId:item?.id});if(!e._errorDisplayed&&n){n(e.message||r("Failed to delete note","echo-knowledge-base"))}}finally{_(false)}};const N=c?`admin.php?page=aipro-all-notes&collection_id=${c}`:"admin.php?page=aipro-all-notes";return n("div",{className:"epkb-ai-dialog-overlay",onClick:s},n("div",{className:"epkb-ai-dialog epkb-ai-notes-dialog",onClick:e=>e.stopPropagation()},n("div",{className:"epkb-ai-dialog-header"},n("div",{className:"epkb-ai-dialog-header-left"},n("h3",null,l?r("Edit Note","echo-knowledge-base"):r("Add Note","echo-knowledge-base")),n("a",{href:N,className:"epkb-ai-all-notes-btn",target:"_blank",rel:"noopener",title:r("View and manage all notes (opens in new tab)","echo-knowledge-base")},n("span",{className:"epkbfa epkbfa-sticky-note"}),r("All Notes","echo-knowledge-base"))),n("button",{className:"epkb-ai-dialog-close",onClick:s},n("span",{className:"epkbfa epkbfa-times"}))),n("div",{className:"epkb-ai-dialog-body"},h?n("div",{style:{padding:"40px",textAlign:"center"}},n("div",{className:"epkb-ai-loading-spinner"}),n("p",{style:{marginTop:"20px",color:"#666"}},r("Loading note content...","echo-knowledge-base"))):n(a,null,n("div",{className:"epkb-ai-form-group"},n("label",null,r("Note Title","echo-knowledge-base")),n("input",{type:"text",className:"epkb-ai-form-control",value:p,onChange:e=>g(e.target.value),placeholder:r("Enter note title...","echo-knowledge-base"),disabled:h})),n("div",{className:"epkb-ai-form-group"},n("label",null,r("Note Content","echo-knowledge-base")),n("textarea",{className:"epkb-ai-form-control",rows:10,value:b,onChange:e=>u(e.target.value),placeholder:r("Enter note content...","echo-knowledge-base"),disabled:h})))),n("div",{className:"epkb-ai-dialog-footer",style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},n("div",null,l?.id&&n("button",{className:"epkb-ai-button epkb-ai-button-danger",onClick:v,disabled:w||h||f,style:{backgroundColor:"#d63638",borderColor:"#d63638",color:"#fff"}},w?r("Deleting...","echo-knowledge-base"):r("Delete Note","echo-knowledge-base"))),n("div",{style:{display:"flex",gap:"10px"}},n("button",{className:"epkb-ai-button epkb-ai-button-secondary",onClick:s,disabled:h||w},r("Cancel","echo-knowledge-base")),n("button",{className:"epkb-ai-button epkb-ai-button-primary",onClick:x,disabled:f||h||w},f?r("Saving...","echo-knowledge-base"):r("Save Note","echo-knowledge-base"))))))};const S=({isOpen:o,onClose:s,onSave:i,collectionId:l})=>{const[d,p]=e("");const[g,b]=e("");const[u,f]=e(false);const[m,h]=e(false);const[k,w]=e({current:0,total:0});const[_,x]=e("");const[v,N]=e(false);const[C,A]=e("");const S=c(null);t((()=>{if(!o){p("");b("");x("");h(false);w({current:0,total:0});N(false);A("");if(S.current){S.current.value=""}}}),[o]);if(!o)return null;const D=async e=>{if(!e)return;A("");if(!window.AIPRO_extractPdfText){const e=r("PDF extraction is not available. Please ensure AI Features Pro is active.","echo-knowledge-base");A(e);return}h(true);x(e.name);try{const t=await window.AIPRO_extractPdfText(e,((e,t)=>{w({current:e,total:t})}));if(!t.text||!t.text.trim()){const e=r("No text could be extracted from this PDF. The file may be scanned images or have no selectable text.","echo-knowledge-base");A(e);x("");return}p(t.title);b(t.text)}catch(t){y("AI Training Data","PDF extraction failed",{message:t.message||"Unknown error",fileName:e.name});let o=r("Failed to extract text from PDF","echo-knowledge-base");if(t.message){o+=": "+t.message}A(o);x("")}finally{h(false)}};const I=e=>{const t=e.target.files[0];if(t&&t.type.includes("pdf")){D(t)}};const T=e=>{e.preventDefault();e.stopPropagation();if(!m)N(true)};const P=e=>{e.preventDefault();e.stopPropagation();N(false)};const E=e=>{e.preventDefault();e.stopPropagation();N(false);if(m)return;const t=e.dataTransfer.files[0];if(t&&t.type.includes("pdf")){D(t)}else{const e=t?t.type||r("unknown type","echo-knowledge-base"):r("no file","echo-knowledge-base");A(r("Invalid file type","echo-knowledge-base")+": "+e+". "+r("Please drop a valid PDF file.","echo-knowledge-base"))}};const $=async()=>{A("");if(!d.trim()){A(r("Please enter a title for the note.","echo-knowledge-base"));return}if(!g.trim()){A(r("No content to save. Please select a PDF file that contains extractable text.","echo-knowledge-base"));return}f(true);try{await i({title:d.trim(),content:g,note_type:"pdf",original_file_name:_,conversion_time:Math.floor(Date.now()/1e3)});s()}catch(e){y("AI Training Data","Error saving PDF note",{message:e.message||"Unknown error",fileName:_});let t=r("Failed to save note","echo-knowledge-base");if(e.message){t+=": "+e.message}A(t)}finally{f(false)}};return n("div",{className:"epkb-ai-dialog-overlay",onClick:s},n("div",{className:"epkb-ai-dialog epkb-ai-pdf-dialog",onClick:e=>e.stopPropagation(),style:{maxWidth:"700px"}},n("div",{className:"epkb-ai-dialog-header"},n("h3",null,r("Upload PDF","echo-knowledge-base")),n("button",{className:"epkb-ai-dialog-close",onClick:s},n("span",{className:"epkbfa epkbfa-times"}))),n("div",{className:"epkb-ai-dialog-body"},C&&n("div",{className:"epkb-ai-pdf-error",style:{backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"6px",padding:"12px 16px",marginBottom:"16px",display:"flex",alignItems:"flex-start",gap:"10px"}},n("span",{className:"epkbfa epkbfa-exclamation-circle",style:{color:"#dc2626",fontSize:"16px",marginTop:"2px",flexShrink:0}}),n("div",{style:{flex:1}},n("span",{style:{color:"#991b1b",fontSize:"14px"}},C)),n("button",{onClick:()=>A(""),style:{background:"none",border:"none",color:"#991b1b",cursor:"pointer",padding:"0",fontSize:"16px",lineHeight:"1"},title:r("Dismiss","echo-knowledge-base")},n("span",{className:"epkbfa epkbfa-times"}))),!g&&n("div",{className:"epkb-ai-pdf-upload-section",style:{textAlign:"center",padding:"30px",border:v?"2px dashed #2271b1":"2px dashed #ddd",borderRadius:"8px",backgroundColor:v?"#f0f7fc":"#fafafa",transition:"all 0.2s ease"},onDragOver:T,onDragLeave:P,onDrop:E},n("input",{ref:S,type:"file",accept:".pdf",onChange:I,style:{display:"none"},disabled:m}),m?n(a,null,n("div",{className:"epkb-ai-loading-spinner"}),n("p",{style:{marginTop:"15px",color:"#666"}},k.total>0?`${r("Extracting page","echo-knowledge-base")} ${k.current} ${r("of","echo-knowledge-base")} ${k.total}...`:r("Loading PDF...","echo-knowledge-base"))):n(a,null,n("span",{className:"epkbfa epkbfa-file-pdf-o",style:{fontSize:"48px",color:v?"#2271b1":"#e74c3c",marginBottom:"15px",display:"block"}}),n("p",{style:{marginBottom:"15px",color:"#666"}},v?r("Drop PDF file here","echo-knowledge-base"):r("Drag and drop a PDF file here, or click the button below","echo-knowledge-base")),n("button",{className:"epkb-ai-button epkb-ai-button-primary",onClick:()=>S.current&&S.current.click(),style:{padding:"10px 25px"}},n("span",{className:"epkbfa epkbfa-upload",style:{marginRight:"8px"}}),r("Select PDF","echo-knowledge-base")))),g&&n(a,null,n("div",{className:"epkb-ai-form-group"},n("label",null,r("Title","echo-knowledge-base")),n("input",{type:"text",className:"epkb-ai-form-control",value:d,onChange:e=>{p(e.target.value);if(C)A("")},placeholder:r("Enter title...","echo-knowledge-base")})),n("div",{className:"epkb-ai-form-group"},n("label",null,r("Extracted Content","echo-knowledge-base"),n("span",{style:{color:"#666",fontWeight:"normal",marginLeft:"10px"}},`(${g.length.toLocaleString()} ${r("characters","echo-knowledge-base")})`)),n("textarea",{className:"epkb-ai-form-control",rows:12,value:g,onChange:e=>b(e.target.value),placeholder:r("Extracted text will appear here...","echo-knowledge-base")})),n("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginTop:"10px"}},n("span",{className:"epkbfa epkbfa-file-pdf-o",style:{color:"#e74c3c"}}),n("span",{style:{color:"#666",fontSize:"13px"}},_),n("button",{className:"epkb-ai-button epkb-ai-button-secondary",onClick:()=>{b("");p("");x("");A("");if(S.current){S.current.value=""}},style:{padding:"4px 10px",fontSize:"12px",marginLeft:"auto"}},r("Choose Different File","echo-knowledge-base"))))),n("div",{className:"epkb-ai-dialog-footer",style:{display:"flex",justifyContent:"flex-end",gap:"10px"}},n("button",{className:"epkb-ai-button epkb-ai-button-secondary",onClick:s,disabled:m},r("Cancel","echo-knowledge-base")),g&&n("button",{className:"epkb-ai-button epkb-ai-button-primary",onClick:$,disabled:u||!d.trim()||!g.trim()},u?r("Saving...","echo-knowledge-base"):r("Save as Note","echo-knowledge-base")))))};const D=({collectionId:o,collection:s,config:i,onSyncStart:l=null,onActionChange:c=null,hasApiKey:f=true,isDeletingDialogOpen:m=false,selectedRecordsCount:h=0,selectedIds:k=[],selectedItemsInfo:_={},trainingData:x=[],bulkDeleteHandler:v=null,onDeleteCollection:N=null,collectionName:C="",onSelectAll:A=null,isAllSelected:S=false,onTableRefresh:D=null,isFiltered:I=false,isSelectAllActive:T=false,totalItems:P=0,statusCounts:E={},isAIProEnabled:$=false,isNotesDialogOpen:B=false,editingNote:L=null,onNoteAdd:F=null,onPdfUpload:R=null,onNoteDialogClose:z=null,handleSaveNote:U=null,isSyncing:O=false,activeStatusTab:j="all",controlledActiveAction:K=undefined,onActiveActionChange:q=null})=>{const[W,M]=e((()=>O?"sync":null));const H=K!==undefined?K:W;const G=q||M;const[J,V]=e([]);const[Q,X]=e(false);const[Y,Z]=e(C);const[ee,te]=e(C);const[oe,ne]=e(false);const[ae,se]=e(null);const[ie,le]=e(false);const ce=async()=>{if(ie||ae)return;le(true);try{const e=await b(`training-collections/${o}/post-stats`,{method:"GET"});if(e.success&&e.post_types_status){se(e.post_types_status)}}catch(e){y("AI Training Data","Failed to load post stats",{message:e.message||"Unknown error",collectionId:o});se({})}finally{le(false)}};t((()=>{if(H==="add"&&!ae&&!ie){const e=s&&s.config&&s.config.ai_training_data_store_post_types_options;if(e==="load_on_demand"){ce()}}}),[H,s,ae,ie]);t((()=>{Z(C);te(C)}),[C,o]);const re=()=>{if(T){if(j!=="all"){return E[j]||0}return P}if(j!=="all"){return Object.keys(_).filter((e=>_[e]&&_[e].status===j)).length}return k.length};t((()=>{if(c){c(H)}}),[H,c]);t((()=>{if(O&&H!=="sync"){G("sync")}}),[O]);const[de,pe]=e(false);const ge=async()=>{if(!Y.trim()){p(r("Collection name cannot be empty","echo-knowledge-base"));return}ne(true);try{const e=await b(`training-collections/${o}`,{method:"PUT",data:{name:Y}});if(e.success){g(r("Collection name updated successfully","echo-knowledge-base"));setTimeout((()=>{const e=new URL(window.location.href);e.searchParams.set("active_sub_tab",`collection-${o}`);window.location.href=e.toString()}),1e3)}}catch(e){if(e.message!=="API key required"&&!e._errorDisplayed){p(e.message||r("Failed to update collection name","echo-knowledge-base"))}}finally{ne(false)}};const be=async()=>{const e=await u({title:r("Delete Collection","echo-knowledge-base"),message:`${r("Are you sure you want to delete this collection?","echo-knowledge-base")}\n\n${r("Type the collection name to confirm:","echo-knowledge-base")} "${C}"`,confirmText:r("Delete","echo-knowledge-base"),cancelText:r("Cancel","echo-knowledge-base"),confirmButtonClass:"epkb-ai-button-danger",requireInput:true,inputPlaceholder:r("Enter collection name","echo-knowledge-base"),inputMatch:C});if(!e){return}pe(true);try{const e=await b(`training-collections/${o}`,{method:"DELETE"});if(e.success){g(r("Collection deleted successfully","echo-knowledge-base"));if(N){N(o)}}}catch(e){y("AI Training Data","Delete collection error",{message:e.message||"Unknown error",code:e.code,status:e.status,collectionId:item?.id,collectionName:item?.name});if(e.message!=="API key required"&&!e._errorDisplayed){p(e.message||r("Failed to delete collection","echo-knowledge-base"))}}finally{}};const ue=async()=>{if(J.length===0){p(r("Please select at least one data type","echo-knowledge-base"));return}X(true);try{const e=await b(`training-collections/${o}/add-data`,{method:"POST",data:{data_types:J}});if(e.success){const t=e.message||r("Data added successfully","echo-knowledge-base");const o=t+" "+r("to","echo-knowledge-base")+' "'+C+'"';g(o);V([]);se(null);if(D){D()}ce()}}catch(e){if(e.message!=="API key required"&&!e._errorDisplayed){p(e.message||r("Failed to add data","echo-knowledge-base"))}}finally{X(false)}};if(!H){return n("div",{className:"epkb-ai-data-source-settings"},n("h3",{className:"epkb-ai-data-source-heading"},r("Choose an Action","echo-knowledge-base")),n("div",{className:"epkb-ai-action-buttons"},n("button",{className:`epkb-ai-button epkb-ai-button-secondary epkb-ai-action-choose-data ${O?"disabled":""}`,onClick:()=>!O&&G("add"),disabled:O,title:O?r("Cannot change actions while sync is in progress","echo-knowledge-base"):""},n("span",null,"1. "+r("Choose Training Data","echo-knowledge-base")),n("span",{className:"epkbfa epkbfa-caret-right"})),n("button",{className:"epkb-ai-button epkb-ai-button-secondary epkb-ai-action-sync-data",onClick:()=>G("sync")},n("span",null,"2. "+r("Send Data to AI","echo-knowledge-base")),n("span",{className:"epkbfa epkbfa-caret-right"})),n("button",{className:`epkb-ai-button epkb-ai-button-secondary ${O?"disabled":""}`,onClick:()=>!O&&G("remove"),disabled:O,title:O?r("Cannot change actions while sync is in progress","echo-knowledge-base"):""},n("span",null,r("Other Actions","echo-knowledge-base")),n("span",{className:"epkbfa epkbfa-caret-right"}))),n("div",{className:"epkb-ai-action-info notice notice-info"},n("h4",null,r("How to get started","echo-knowledge-base")),n("div",{style:{marginTop:"15px",marginBottom:"15px"}},n("p",{style:{marginBottom:"10px"}},"1. ",n("strong",null,r("Choose Training Data","echo-knowledge-base"))," — ",r("Pick the content types to include.","echo-knowledge-base")),n("p",{style:{marginBottom:"10px"}},"2. ",n("strong",null,r("Send Data to AI","echo-knowledge-base"))," — ",r("Select items in the table, then sync them.","echo-knowledge-base")),n("p",{style:{marginBottom:"10px"}},"3. ",n("strong",null,r("Other Actions","echo-knowledge-base"))," — ",r("Rename the collection or delete items.","echo-knowledge-base"))),n("p",null,r("Tip: Start with a small set to test the flow.","echo-knowledge-base"))))}const fe=()=>{switch(H){case"add":return r("Add Training Data","echo-knowledge-base");case"sync":return r("Send Data to AI","echo-knowledge-base");case"remove":return r("Other Actions","echo-knowledge-base");default:return""}};return n("div",{className:"epkb-ai-data-source-settings"},n("button",{className:`epkb-ai-back-button ${O?"disabled":""}`,onClick:()=>{if(!O){G(null)}},disabled:O,title:O?r("Cannot navigate while sync is in progress","echo-knowledge-base"):""},n("span",{className:"epkbfa epkbfa-chevron-left"}),r("Back","echo-knowledge-base")),n("h3",{style:{marginBottom:"20px",fontSize:"24px",fontWeight:"600",borderBottom:"2px solid #d0d0d0",paddingBottom:"10px"}},fe()),H==="add"&&n("div",{className:"epkb-ai-action-content"},n("div",{className:"epkb-ai-collection-indicator",style:{backgroundColor:"#e7f5ff",border:"1px solid #1e88e5",borderRadius:"4px",padding:"12px 15px",marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"}},n("span",{className:"epkbfa epkbfa-info-circle",style:{color:"#1e88e5"}}),n("span",{style:{color:"#333",fontWeight:"500"}},r("Adding data to:","echo-knowledge-base")+" "),n("strong",{style:{color:"#1e88e5"}},C)),n("p",{style:{color:"#666",marginBottom:"15px"}},r("Choose which content types you want to include in your AI training data.","echo-knowledge-base")),(()=>{const e=s&&s.config&&s.config.ai_training_data_store_post_types_options;const t=ae?ae:s&&s.config&&s.config.ai_training_data_store_post_types_options&&s.config.ai_training_data_store_post_types_options!=="load_on_demand"?s.config.ai_training_data_store_post_types_options:i&&i.available_post_types||{};const o=t["aipro_ai_note"];if(!o)return null;const a=typeof o==="object"&&o!==null;const l=a?o.label:o;const c=a?o:{available:true,new_items:1};const d=i.is_ai_features_pro_enabled;const p=!d||a&&c.requires_ai_pro;const g=()=>{const e=document.createElement("div");e.style.cssText="position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;z-index:9999999;";const t=document.createElement("div");t.style.cssText="background:white;border-radius:8px;padding:24px;max-width:450px;width:90%;box-shadow:0 4px 20px rgba(0,0,0,0.15);";t.innerHTML=`\n\t\t\t\t\t\t\t<h3 style="margin:0 0 16px 0;font-size:18px;font-weight:600;">${r("Additional Notes","echo-knowledge-base")}</h3>\n\t\t\t\t\t\t\t<p style="margin:0 0 20px 0;color:#555;line-height:1.6;">${r("Add additional support and miscellaneous information not found in articles, posts, and pages that AI should also know about.","echo-knowledge-base")}</p>\n\t\t\t\t\t\t\t<p style="margin:0 0 20px 0;color:#555;line-height:1.6;">${r("Examples: business hours, contact information, company policies, product details, or any other information you want the AI to reference.","echo-knowledge-base")}</p>\n\t\t\t\t\t\t\t<div style="display:flex;justify-content:flex-end;">\n\t\t\t\t\t\t\t\t<button class="epkb-ai-button epkb-ai-button-primary" style="padding:8px 20px;">${r("Got it","echo-knowledge-base")}</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t`;e.appendChild(t);document.body.appendChild(e);const o=()=>document.body.removeChild(e);t.querySelector("button").addEventListener("click",o);e.addEventListener("click",(t=>{if(t.target===e)o()}))};return n("div",{key:"aipro_ai_note_top",style:{marginBottom:"20px",padding:"15px",backgroundColor:"#f8f9fa",borderRadius:"6px",border:"1px solid #e0e0e0"}},n("div",{style:{display:"flex",alignItems:"center",marginBottom:"8px",opacity:p?"0.6":"1"}},n("span",{className:"epkbfa epkbfa-file-text-o",style:{marginRight:"10px",color:"#666",fontSize:"16px",width:"16px",textAlign:"center"}}),n("span",{style:{fontWeight:"600",fontSize:"15px"}},l),n("span",{className:"epkbfa epkbfa-question-circle",onClick:g,style:{marginLeft:"8px",color:"#0073aa",cursor:"pointer",fontSize:"16px"}}),d&&c.already_added>0&&n("span",{style:{marginLeft:"10px",fontSize:"0.9em",color:"#666"}},`(${c.already_added} ${r("added","echo-knowledge-base")})`)),p?n("div",{style:{color:"#1e88e5",fontSize:"0.9em",marginTop:"5px"}},r("Requires AI Advanced Features plugin.","echo-knowledge-base")," ",n("a",{href:"https://www.echoknowledgebase.com/wordpress-plugin/ai-features/",target:"_blank",rel:"noopener noreferrer",style:{color:"#1e88e5",textDecoration:"underline"}},r("Learn More","echo-knowledge-base"))):n("div",{style:{marginTop:"8px",display:"flex",gap:"10px",flexWrap:"wrap"}},n("button",{className:"epkb-ai-button epkb-ai-button-primary",onClick:F,style:{padding:"8px 16px",fontSize:"13px",backgroundColor:"#00a32a",borderColor:"#00a32a",color:"#fff"}},n("span",{className:"epkbfa epkbfa-plus",style:{marginRight:"5px"}}),r("Add Note","echo-knowledge-base")),n("button",{className:"epkb-ai-button epkb-ai-button-secondary",onClick:R,style:{padding:"8px 16px",fontSize:"13px"}},n("span",{className:"epkbfa epkbfa-file-pdf-o",style:{marginRight:"5px"}}),r("Upload PDF","echo-knowledge-base"))))})(),i.is_access_manager_active&&n("div",{className:"epkb-ai-access-manager-warning",style:{backgroundColor:"#fee",border:"1px solid #dc3545",borderRadius:"4px",padding:"15px",marginBottom:"20px",color:"#721c24"}},n("strong",{style:{display:"block",marginBottom:"5px"}},r("Access Manager Notice","echo-knowledge-base")),n("span",null,r("Currently only publicly accessible articles can be uploaded to AI. Articles with access restrictions will not be included in the training data.","echo-knowledge-base"))),(()=>{const e=s&&s.config&&s.config.ai_training_data_store_post_types_options;if(e==="load_on_demand"&&!ae){if(ie){return n("div",{style:{padding:"20px",textAlign:"center"}},n("div",{className:"epkb-ai-loading-spinner"}),n("p",{style:{marginTop:"10px",color:"#666"}},r("Loading content types...","echo-knowledge-base")))}return n("div",{style:{padding:"20px",textAlign:"center"}},n("p",{style:{color:"#666"}},r("Loading content types...","echo-knowledge-base")))}const t=ae?ae:s&&s.config&&s.config.ai_training_data_store_post_types_options&&s.config.ai_training_data_store_post_types_options!=="load_on_demand"?s.config.ai_training_data_store_post_types_options:i&&i.available_post_types||{};const o=Object.entries(t);return n("div",{className:"epkb-ai-checkbox-list"},o.length>0?o.map((([e,t])=>{if(e==="aipro_ai_note")return null;const o=typeof t==="object"&&t!==null;const a=o?t.label:t;const s=o?t:{available:true,new_items:1};const i=o&&s.requires_ai_pro;const l=i||!s.available||s.new_items!=="500+"&&s.new_items===0;const c=e==="aipro_ai_note";if(c){const t=()=>{const e=document.createElement("div");e.style.cssText="position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;z-index:9999999;";const t=document.createElement("div");t.style.cssText="background:white;border-radius:8px;padding:24px;max-width:450px;width:90%;box-shadow:0 4px 20px rgba(0,0,0,0.15);";t.innerHTML=`\n\t\t\t\t\t\t\t\t\t\t<h3 style="margin:0 0 16px 0;font-size:18px;font-weight:600;">${r("Additional Notes","echo-knowledge-base")}</h3>\n\t\t\t\t\t\t\t\t\t\t<p style="margin:0 0 20px 0;color:#555;line-height:1.6;">${r("Add additional support and miscellaneous information not found in articles, posts, and pages that AI should also know about.","echo-knowledge-base")}</p>\n\t\t\t\t\t\t\t\t\t\t<p style="margin:0 0 20px 0;color:#555;line-height:1.6;">${r("Examples: business hours, contact information, company policies, product details, or any other information you want the AI to reference.","echo-knowledge-base")}</p>\n\t\t\t\t\t\t\t\t\t\t<div style="display:flex;justify-content:flex-end;">\n\t\t\t\t\t\t\t\t\t\t\t<button class="epkb-ai-button epkb-ai-button-primary" style="padding:8px 20px;">${r("Got it","echo-knowledge-base")}</button>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t`;e.appendChild(t);document.body.appendChild(e);const o=()=>document.body.removeChild(e);t.querySelector("button").addEventListener("click",o);e.addEventListener("click",(t=>{if(t.target===e)o()}))};return n("div",{key:e,style:{marginBottom:"15px"}},n("div",{style:{display:"flex",alignItems:"center",marginBottom:"5px",opacity:i?"0.6":"1"}},n("span",{className:"epkbfa epkbfa-file-text-o",style:{marginRight:"10px",color:"#666",fontSize:"14px",width:"13px",textAlign:"center"}}),n("span",{style:{fontWeight:"500"}},a),n("span",{className:"epkbfa epkbfa-question-circle",onClick:t,style:{marginLeft:"8px",color:"#0073aa",cursor:"pointer",fontSize:"16px"}}),$&&s.already_added>0&&n("span",{style:{marginLeft:"10px",fontSize:"0.9em",color:"#666"}},`(${s.already_added} ${r("added","echo-knowledge-base")})`)),i?n("div",{style:{marginLeft:"23px",color:"#1e88e5",fontSize:"0.9em",marginTop:"5px"}},r("Requires AI Advanced Features plugin.","echo-knowledge-base")," ",n("a",{href:"https://www.echoknowledgebase.com/wordpress-plugin/ai-features/",target:"_blank",rel:"noopener noreferrer",style:{color:"#1e88e5",textDecoration:"underline"}},r("Learn More","echo-knowledge-base"))):n("div",{style:{marginTop:"8px",marginLeft:"23px",display:"flex",gap:"10px",flexWrap:"wrap"}},n("button",{className:"epkb-ai-button epkb-ai-button-secondary",onClick:F,style:{padding:"6px 12px",fontSize:"13px"}},n("span",{className:"epkbfa epkbfa-plus",style:{marginRight:"5px"}}),r("Add Note","echo-knowledge-base")),n("button",{className:"epkb-ai-button epkb-ai-button-secondary",onClick:R,style:{padding:"6px 12px",fontSize:"13px"}},n("span",{className:"epkbfa epkbfa-file-pdf-o",style:{marginRight:"5px"}}),r("Upload PDF","echo-knowledge-base"))))}return n("div",{key:e,style:{marginBottom:"15px"}},n("label",{style:{display:"flex",alignItems:"center",marginBottom:"5px",cursor:l?"not-allowed":"pointer",opacity:l?"0.6":"1"}},n("input",{type:"checkbox",checked:J.includes(e),disabled:l,onChange:t=>{if(!l){if(t.target.checked){V([...J,e])}else{V(J.filter((t=>t!==e)))}}},style:{marginRight:"10px"}}),n("span",{style:{fontWeight:"500"}},a),o&&!i&&n("span",{style:{marginLeft:"10px",fontSize:"0.9em",color:"#666"}},(()=>{const e=[];if(s.new_items==="500+"||s.new_items>0){const t=s.new_items==="500+"?"500+":s.new_items;e.push(`${t} ${r("available","echo-knowledge-base")}`)}if(s.already_added>0){e.push(`${s.already_added} ${r("added","echo-knowledge-base")}`)}const t=(s.linked_articles||0)+(s.password_protected||0)+(s.excluded||0);if(t>0&&s.available){e.push(`${t} ${r("excluded","echo-knowledge-base")}`)}return e.length>0?`(${e.join(", ")})`:""})())),i&&n("div",{style:{marginLeft:"25px",color:"#1e88e5",fontSize:"0.9em",marginTop:"5px"}},r("Requires AI Advanced Features plugin.","echo-knowledge-base")," ",n("a",{href:"https://www.echoknowledgebase.com/wordpress-plugin/ai-features/",target:"_blank",rel:"noopener noreferrer",style:{color:"#1e88e5",textDecoration:"underline"}},r("Learn More","echo-knowledge-base"))),l&&!i&&n("div",{style:{marginLeft:"25px",color:s.already_added>0?"#008a20":"#dc3545",fontSize:"0.9em",fontStyle:"italic"}},(()=>{if(s.already_added>0){return r("All eligible items already added to collection","echo-knowledge-base")}const t=(s.linked_articles||0)+(s.password_protected||0)+(s.excluded||0);if(t>0){const e=[];if(s.password_protected>0){e.push(`${s.password_protected} password-protected`)}if(s.linked_articles>0){e.push(`${s.linked_articles} linked`)}if(s.excluded>0){e.push(`${s.excluded} restricted`)}return`${r("No eligible content","echo-knowledge-base")} (${e.join(", ")})`}if(e.startsWith("epkb_post_type_")){return d(r("No articles for %s found. First create and publish articles.","echo-knowledge-base"),a)}return d(r("No %s found. First create and publish %s.","echo-knowledge-base"),a,a.toLowerCase())})()))})):n("p",{style:{color:"#888"}},r("No content types available.","echo-knowledge-base")))})(),n("div",{style:{marginTop:"20px"}},n("button",{className:"epkb-ai-button epkb-ai-button-primary",onClick:ue,disabled:Q||J.length===0},Q?r("Adding Data...","echo-knowledge-base"):r("Add Data","echo-knowledge-base")))),H==="sync"&&n("div",{className:"epkb-ai-action-content"},(()=>{let e;let t=h;if(T){if(j!=="all"){e=`ALL_${j.toUpperCase()}`}else{e="ALL"}}else{if(j!=="all"){e=k.filter((e=>{const t=_[e];return t&&t.status===j})).map((e=>_[e].item_id));t=e.length}else{e=k.map((e=>{const t=_[e];if(t){return t.item_id}const o=x.find((t=>t.id===e));return o?o.item_id:null})).filter((e=>e!==null))}}return n(a,null,w&&n(w,{collectionId:o,selectedPostIds:e,disabled:!f||m||e!=="ALL"&&typeof e!=="string"&&e.length===0,hasApiKey:f,onSelectAll:A,isAllSelected:S,selectedRecordsCount:t,isFiltered:I,onSyncStart:l,isSelectAllActive:T,activeStatusTab:j,trainingData:x}))})(),n("p",{style:{color:"#666",marginTop:"15px",fontSize:"14px"}},r("Select items from the table and choose a sync method to update your AI training data.","echo-knowledge-base"))),H==="remove"&&n("div",{className:"epkb-ai-action-content"},n("p",{style:{color:"#666",marginBottom:"20px"}},r("Manage your collection settings and data.","echo-knowledge-base")),n("div",{className:"epkb-ai-collection-name-section",style:{marginBottom:"30px"}},n("h4",{style:{marginBottom:"10px",fontSize:"16px",fontWeight:"600"}},r("Collection Name","echo-knowledge-base"),n("span",{style:{color:"#999",fontWeight:"normal",fontSize:"14px",marginLeft:"10px"}},`(ID: ${o})`)),n("div",{style:{display:"flex",alignItems:"center",gap:"10px"}},n("input",{type:"text",value:Y,onChange:e=>Z(e.target.value),style:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px",flex:"1",maxWidth:"400px"},placeholder:r("Enter collection name","echo-knowledge-base")}),n("button",{className:"epkb-ai-button epkb-ai-button-primary",onClick:ge,disabled:oe||Y===ee,style:{padding:"8px 20px",cursor:oe||Y===ee?"not-allowed":"pointer",opacity:oe||Y===ee?.5:1}},oe?r("Saving...","echo-knowledge-base"):r("Save","echo-knowledge-base"))),n("p",{style:{marginTop:"8px",color:"#666",fontSize:"13px"}},r("Change the display name for this collection.","echo-knowledge-base"))),n("hr",{style:{margin:"30px 0",border:"none",borderTop:"1px solid #e5e5e5"}}),(()=>null)(),n("div",{className:"epkb-ai-delete-selected-section",style:{marginBottom:"25px"}},n("div",{style:{display:"flex",alignItems:"center",gap:"15px"}},n("button",{id:"epkb-ai-delete-selected-btn",className:"epkb-ai-button epkb-ai-button-danger",onClick:e=>{e.preventDefault();e.stopPropagation();if(v&&typeof v==="function"){try{v()}catch(e){y("AI Training Data","Error calling bulkDeleteHandler",{message:e.message||"Unknown error",selectedCount:k.length})}}else{y("AI Training Data","bulkDeleteHandler is not a function",{type:typeof v,handler:v});p(r("Unable to delete items. Please refresh the page and try again.","echo-knowledge-base"))}},disabled:!v||re()===0,style:{padding:"10px 20px",backgroundColor:"#d63638",borderColor:"#d63638",color:"#fff",cursor:!v||re()===0?"not-allowed":"pointer",opacity:!v||re()===0?.5:1}},r("Delete Selected","echo-knowledge-base")),n("span",{style:{color:"#666",fontSize:"14px"}},`${re()} ${r("Selected Records","echo-knowledge-base")}`)),n("p",{style:{marginTop:"10px",color:"#666",fontSize:"13px"}},r("Delete the selected training data items from this collection.","echo-knowledge-base"))),n("hr",{style:{margin:"30px 0",border:"none",borderTop:"1px solid #e5e5e5"}}),n("div",{className:"epkb-ai-delete-collection-section"},n("button",{className:"epkb-ai-button epkb-ai-button-danger epkb-ai-delete-collection-btn",onClick:be,disabled:de,style:{padding:"10px 20px",backgroundColor:"#d63638",borderColor:"#d63638",color:"#fff",cursor:de?"not-allowed":"pointer"}},de?r("Deleting...","echo-knowledge-base"):r("Delete Collection","echo-knowledge-base")),n("p",{style:{marginTop:"10px",color:"#666",fontSize:"13px"}},r("This will permanently delete all training data in this collection.","echo-knowledge-base")))))};const I=({collection:s,config:l,hasApiKey:c,onDeleteCollection:d})=>{const[u,f]=e(false);const[m,h]=e(false);const[k,y]=e(false);const[w,_]=e([]);const[x,v]=e({});const[N,I]=e([]);const[T,P]=e(null);const[E,$]=e(null);const[B,L]=e(0);const[F,R]=e((()=>{if(s&&s.stats){return{added:0,updated:0,outdated:0,error:0,pending:0,...s.stats}}return{}}));const[z,U]=e(0);const[O,j]=e(false);const[K,q]=e(false);const[W,M]=e(false);const[H,G]=e(null);const[J,V]=e(false);const[Q,X]=e("all");const[Y,Z]=e("all");const[ee,te]=e(null);const oe=E&&w.length>0&&B>0&&w.length===B;const ne=o((e=>{G(e);M(true)}),[]);const ae=o((async e=>{try{const t=await b("training-notes",{method:e.id?"PUT":"POST",data:{collection_id:s.id,title:e.title,content:e.content,note_id:e.id,training_id:e.training_id}});if(t.success){g(e.id?r("Note updated successfully","echo-knowledge-base"):r("Note added successfully","echo-knowledge-base"));U((e=>e+1));M(false);G(null)}}catch(e){if(e.code==="ai_pro_class_missing"){p(r("AI Features Pro is not properly configured. Please ensure the plugin is activated.","echo-knowledge-base"))}else if(!e._errorDisplayed){p(e.message||r("Failed to save note","echo-knowledge-base"))}throw e}}),[s.id]);const se=o((async e=>{try{const t=await b("training-notes",{method:"POST",data:{collection_id:s.id,title:e.title,content:e.content,note_type:"pdf",original_file_name:e.fileName,conversion_time:Date.now()}});if(t.success){g(r("PDF note added successfully","echo-knowledge-base"));U((e=>e+1));V(false)}}catch(e){if(e.code==="ai_pro_class_missing"){p(r("AI Features Pro is not properly configured. Please ensure the plugin is activated.","echo-knowledge-base"))}else if(!e._errorDisplayed){p(e.message||r("Failed to save PDF note","echo-knowledge-base"))}throw e}}),[s.id]);const ie=window.EPKB_AI_SyncContext?i(window.EPKB_AI_SyncContext):null;t((()=>{if(ie&&ie.job){const e=ie.job.status;if(e==="running"||e==="scheduled"){f(true);te("sync")}}}),[]);t((()=>{if(ie&&ie.job){const e=ie.job.status;if(e==="completed"||e==="canceled"||e==="idle"){f(false)}else if(e==="running"||e==="scheduled"){f(true)}}}),[ie?.job?.status]);const le=o((e=>{P((()=>e))}),[]);const ce=o((e=>{const t=t=>{q(t);if(t&&N.length>0){const e={};N.forEach((t=>{e[t.id]={status:t.status,item_id:t.item_id}}));v((t=>({...t,...e})))}if(e){e(t)}};$((()=>t))}),[N]);const re=o((e=>{te(e);if(e===null){f(false)}if(e==="add"){_([]);v({});q(false)}}),[]);const de=o(((e,t=false)=>{_(e);if(e.length===0){v({});return}if(t&&e.length>0&&ee!=="remove"){te("sync")}v((t=>{const o={};e.forEach((e=>{const n=N.find((t=>t.id===e));if(n){o[e]={status:n.status,item_id:n.item_id}}else if(t[e]){o[e]=t[e]}}));return o}))}),[N,ee]);const pe=o((()=>{if(K){return B}if(Q==="all"||Q==="sync"){return w.length}let e=0;w.forEach((t=>{const o=N.find((e=>e.id===t));if(o&&o.status===Q){e++}}));return e}),[K,B,Q,w,N]);const ge=o((()=>{U((e=>e+1))}),[]);const be=o((()=>{f(true);setTimeout((()=>{v({})}),100)}),[]);const ue=o((e=>{X(e);if(e!=="sync"){Z(e)}}),[]);const fe=o((e=>{R(e)}),[]);t((()=>{if(N.length>0&&w.length>0){v((e=>{const t={...e};N.forEach((e=>{if(w.includes(e.id)){t[e.id]={status:e.status,item_id:e.item_id}}}));return t}))}}),[N,w]);t((()=>{if(!l.is_ai_features_pro_enabled)return;const e=()=>{const e=document.querySelector(".epkb-ai-table-actions-right");if(!e||e.querySelector(".epkb-ai-all-notes-btn"))return;const t=document.createElement("a");t.className="epkb-ai-all-notes-btn epkb-ai-button";t.href="admin.php?page=aipro-all-notes";t.target="_blank";t.rel="noopener";t.innerHTML='<span class="epkbfa epkbfa-sticky-note"></span> '+r("All Notes","echo-knowledge-base");t.title=r("View and manage all notes (opens in new tab)","echo-knowledge-base");const o=e.querySelector(".epkb-ai-search-input");if(o){e.insertBefore(t,o)}else{e.prepend(t)}};e();const t=new MutationObserver(e);t.observe(document.body,{childList:true,subtree:true});return()=>t.disconnect()}),[l.is_ai_features_pro_enabled]);const me=n(a,null,l.is_ai_features_pro_enabled&&n(A,{isOpen:W,onClose:()=>{M(false);G(null)},onSave:ae,onDelete:()=>{U((e=>e+1))},noteData:H,collectionId:s.id}),l.is_ai_features_pro_enabled&&n(S,{isOpen:J,onClose:()=>V(false),onSave:se,collectionId:s.id}),n("div",{className:"epkb-ai-data-collection-wrapper"},n("div",{className:"epkb-ai-data-source-layout"},n(C,{key:`table-${s.id}`,collectionId:s.id,collectionName:s.name,hasApiKey:c,onSelectedIdsChange:de,onBulkDeleteCallback:le,onSelectAllCallback:ce,onTotalItemsChange:L,onTrainingDataChange:I,refreshTrigger:z,isSyncing:u,onFilterStateChange:j,initialStats:s.stats||null,initialData:s.preloaded_data||null,selectedIds:w,onNoteEdit:ne,isAIProEnabled:l.is_ai_features_pro_enabled||false,onActiveStatusTabChange:ue,onStatusCountsChange:fe}),n(D,{key:`settings-${s.id}`,collectionId:s.id,collection:s,config:l,onSyncStart:be,onActionChange:re,hasApiKey:c,isDeletingDialogOpen:k,controlledActiveAction:ee,onActiveActionChange:te,selectedRecordsCount:(()=>{if(K){if(Y!=="all"){return F[Y]||0}return B}if(Y!=="all"){return Object.keys(x).filter((e=>x[e]&&x[e].status===Y)).length}return w.length})(),selectedIds:w,selectedItemsInfo:x,trainingData:N,bulkDeleteHandler:T,onDeleteCollection:d,collectionName:s.name,onSelectAll:E,isAllSelected:K,onTableRefresh:ge,isFiltered:O,isSelectAllActive:K,totalItems:B,statusCounts:F,isAIProEnabled:l.is_ai_features_pro_enabled||false,isNotesDialogOpen:W,editingNote:H,onNoteAdd:()=>{G(null);M(true)},onPdfUpload:()=>V(true),onNoteDialogClose:()=>{M(false);G(null)},handleSaveNote:ae,isSyncing:u,activeStatusTab:Y}))));return me};const T=({settings:o,tabData:a,hasApiKey:s,onTabSwitch:l})=>{const c=a||{};const d=c.ai_config||{};d.available_post_types=c.available_post_types||{};d.is_wp_cron_disabled=c.is_wp_cron_disabled||false;const u=c.data_collections||[];const[m,y]=e(u);const w=N();t((()=>{const e=m.map((e=>e.id));w.clearNonExistentCollections(e)}),[]);const[_,x]=e((()=>{const e=new URL(window.location.href);const t=e.searchParams.get("active_sub_tab");if(t&&t.startsWith("collection-")){const e=parseInt(t.replace("collection-",""));if(m.some((t=>t.id===e))){return t}}const o=sessionStorage.getItem("epkb_new_collection_id");if(o&&m.some((e=>e.id===parseInt(o)))){sessionStorage.removeItem("epkb_new_collection_id");return`collection-${o}`}return m.length>0?`collection-${m[0].id}`:"add-new"}));const v=_.startsWith("collection-")?m.find((e=>`collection-${e.id}`===_)):null;const C=e=>{const t=m.filter((t=>t.id!==e));y(t);setTimeout((()=>{window.location.reload()}),1e3)};const A=d?.ai_disclaimer_accepted==="on";if(!A){const{DisclaimerRequiredMessage:e}=window.EPKB_AI_Util_React||{};if(e){return n(e,{i18n:o?.i18n||{},onAccept:()=>{if(l){l("general-settings")}else{const e=new URL(window.location.href);if(e.searchParams.has("page")){e.searchParams.set("active_tab","general-settings");window.location.href=e.toString()}}}})}}const S=async()=>{const e=c.next_collection_id;if(!e){p(r("Unable to determine next collection ID","echo-knowledge-base"));return}const t=f?f(r("Creating new collection...","echo-knowledge-base")):null;w.clearCollection(e);try{const o=await b("training-collections",{method:"POST",data:{collection_id:e,name:r("Data Collection","echo-knowledge-base")+" "+e}});if(o.success){g(r("Collection created successfully","echo-knowledge-base"));sessionStorage.setItem("epkb_new_collection_id",o.collection_id||e);setTimeout((()=>{window.location.reload()}),1e3)}else{if(t&&typeof t.close==="function"){t.close()}}}catch(e){if(t&&typeof t.close==="function"){t.close()}if(!e._errorDisplayed){p(e.message||r("Failed to create collection","echo-knowledge-base"))}}};const D=c.sub_tabs?Object.values(c.sub_tabs):[];const T=window.EPKB_AI_SyncContext?i(window.EPKB_AI_SyncContext):null;const P=T&&T.job&&(T.job.status==="running"||T.job.status==="scheduled");if(D.length>0){return n("div",{className:"epkb-ai-training-data-container"},k&&n(k,{setupSteps:c?.setup_steps,onTabSwitch:l}),n("div",{className:"epkb-ai-sub-tabs"},n("div",{className:"epkb-ai-sub-tabs-header"},n("div",{className:"epkb-ai-sub-tabs-nav"},D.map((e=>n("button",{key:e.id,className:`epkb-ai-sub-tab-button epkb-ai-sub-tab-${e.id} ${_===e.id?"active":""} ${P&&!e.is_add_new&&e.id!==_?"disabled":""}`,disabled:P&&!e.is_add_new&&e.id!==_,onClick:()=>{if(!P||e.id===_){if(e.is_add_new){S()}else{x(e.id)}}},title:P&&!e.is_add_new&&e.id!==_?r("Sync in progress. Please wait...","echo-knowledge-base"):""},e.icon&&n("span",{className:e.icon})," ",e.title)))),h&&n(h,{url:"https://www.echoknowledgebase.com/documentation/step-2-add-ai-training-data/"}))),v&&n(I,{key:`collection-${v.id}`,collection:v,config:{...d,is_ai_features_pro_enabled:c.is_ai_features_pro_enabled,is_access_manager_active:c.is_access_manager_active},hasApiKey:s,onDeleteCollection:C}),!v&&n("div",{className:"epkb-ai-empty-state"},n("p",null,r('No collections available. Click "Add New" to create one.',"echo-knowledge-base"))))}return n("div",{className:"epkb-ai-training-data-container"},n("div",{className:"epkb-ai-empty-state"},n("p",null,r("No training data configuration available.","echo-knowledge-base"))))};const P=e=>n(v,null,n(T,e));window.EPKB_AI_TrainingData={AIAdminTrainingData:P}})();