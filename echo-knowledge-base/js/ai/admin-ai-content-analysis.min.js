(function(){"use strict";const{useState:e,useEffect:t,useCallback:a,useContext:s,createElement:n,Fragment:o,createContext:i,useMemo:l}=wp.element;const{__:r}=wp.i18n;const c=window.EPKB_AI_ContentAnalysisTable||(()=>n("div",null,"ContentAnalysisTable component not loaded"));const{ContentAnalysisControls:d,ContentAnalysisProgressBar:p}=window.EPKB_AI_ContentAnalysisSync?{ContentAnalysisControls:window.EPKB_AI_ContentAnalysisControls,ContentAnalysisProgressBar:window.EPKB_AI_ContentAnalysisProgressBar}:{};const b=i();window.EPKB_AI_ContentAnalysisCacheContext=b;const m=({children:a})=>{const s=()=>{let e={};try{o();const t=sessionStorage.getItem("epkb_ai_content_analysis_cache");if(t){e=JSON.parse(t)}Object.keys(sessionStorage).forEach((t=>{if(t.startsWith("epkb_content_analysis_cache_")){try{const a=t.replace("epkb_content_analysis_cache_","");const s=JSON.parse(sessionStorage.getItem(t));if(s){e[a]=s}}catch(e){}}}))}catch(e){}return e};const o=()=>{const e=Date.now();const t=24*60*60*1e3;try{const a="epkb_content_analysis_cache_analysis_results_cache";const s=sessionStorage.getItem(a);if(s){const n=JSON.parse(s);if(n.value){const s={};let o=0;Object.keys(n.value).forEach((a=>{const i=n.value[a];if(!i.cached_at||e-i.cached_at<t){s[a]=i}else{o++}}));if(o>0){sessionStorage.setItem(a,JSON.stringify({value:s,timestamp:e}))}}}}catch(e){}};const[i,r]=e(s);t((()=>{const e=()=>{if(document.visibilityState==="visible"){if(window.EPKB_AI_ContentAnalysisTable&&window.EPKB_AI_ContentAnalysisTable.refreshAllRows){setTimeout((()=>{window.EPKB_AI_ContentAnalysisTable.refreshAllRows()}),100)}}};document.addEventListener("visibilitychange",e);return()=>{document.removeEventListener("visibilitychange",e)}}),[]);t((()=>{const e=()=>{};window.addEventListener("beforeunload",e);return()=>{window.removeEventListener("beforeunload",e)}}),[]);t((()=>{try{sessionStorage.setItem("epkb_ai_content_analysis_cache",JSON.stringify(i));if(i.analysis_results_cache){try{const e=sessionStorage.getItem("epkb_content_analysis_cache_analysis_results_cache");const t=e?JSON.parse(e):null;if(!t||!t.timestamp||i.analysis_results_cache.timestamp>t.timestamp){sessionStorage.setItem("epkb_content_analysis_cache_analysis_results_cache",JSON.stringify(i.analysis_results_cache))}}catch(e){sessionStorage.setItem("epkb_content_analysis_cache_analysis_results_cache",JSON.stringify(i.analysis_results_cache))}}if(i.batch_state){sessionStorage.setItem("epkb_analysis_batch_state",JSON.stringify(i.batch_state))}if(i.analyzing_articles){sessionStorage.setItem("epkb_analysis_in_progress",JSON.stringify(i.analyzing_articles))}}catch(e){if(e.name==="QuotaExceededError"){o();r({});try{sessionStorage.removeItem("epkb_ai_content_analysis_cache");sessionStorage.removeItem("epkb_analysis_batch_state");sessionStorage.removeItem("epkb_analysis_in_progress");sessionStorage.removeItem("epkb_analysis_completed")}catch(e){}}else{}}}),[i]);const c=l((()=>({get:e=>i[e],set:(e,t)=>{r((a=>({...a,[e]:{value:t,timestamp:Date.now()}})))},remove:e=>{r((t=>{const a={...t};delete a[e];return a}))},clear:()=>{r({});try{sessionStorage.removeItem("epkb_ai_content_analysis_cache");sessionStorage.removeItem("epkb_analysis_batch_state");sessionStorage.removeItem("epkb_analysis_in_progress");sessionStorage.removeItem("epkb_analysis_completed");sessionStorage.removeItem("epkb_content_analysis_cache_analysis_results_cache")}catch(e){}}})),[i]);return n(b.Provider,{value:c},a)};const g=()=>{const e=s(b);if(!e){throw new Error("useContentAnalysisCache must be used within ContentAnalysisCacheProvider")}return e};const _=({tabData:o,settings:i,onOpenImproveTab:l})=>{const p=g();const b=o&&o.kb_list?o.kb_list:i&&i.kb_list?i.kb_list:[];const[m,_]=e((()=>{const e=p.get("overview_selectedKbId");if(e&&typeof e.value==="number"){return e.value}return 0}));const[u,y]=e(0);t((()=>{p.set("overview_selectedKbId",m)}),[m]);const k=a((e=>{_(e);y((e=>e+1))}),[]);const[f,h]=e((()=>{const e=p.get("overview_selectedIds");return e&&Array.isArray(e.value)?e.value:[]}));const[w,v]=e((()=>{const e=p.get("overview_selectedArticle");return e&&e.value?e.value:null}));const[A,I]=e(null);const[N,S]=e(null);const[x,C]=e((()=>{const e=p.get("overview_totalItems");return e&&typeof e.value==="number"?e.value:0}));const[E,P]=e(0);const[z,D]=e((()=>{const e=p.get("overview_showAnalysisProgress");return e&&e.value===true?true:false}));const[B,T]=e((()=>{const e=p.get("overview_articlesData");return e&&Array.isArray(e.value)?e.value:[]}));const[R,K]=e(null);const[O,L]=e((()=>{const e=p.get("analysis_results_cache");return e&&e.value?e.value:{}}));t((()=>{p.set("overview_selectedIds",f)}),[f]);t((()=>{p.set("overview_selectedArticle",w)}),[w]);t((()=>{p.set("overview_totalItems",x)}),[x]);t((()=>{p.set("overview_showAnalysisProgress",z)}),[z]);t((()=>{p.set("overview_articlesData",B)}),[B]);t((()=>{p.set("analysis_results_cache",O)}),[O]);const j=window.EPKB_AI_ContentAnalysisSyncContext?s(window.EPKB_AI_ContentAnalysisSyncContext):null;const W=a(((e,t)=>{h(e);if(e.length===1&&t){v(t)}else{v(null)}}),[]);const J=a((e=>{I((()=>e))}),[]);const U=a((e=>{S((()=>e))}),[]);const F=a((e=>{C(e)}),[]);const q=a((e=>{K((()=>e))}),[]);const G=a((()=>{D(true);h([])}),[]);const V=a((e=>{if(!e||e.length===0)return;L((t=>{const a={...t};e.forEach((e=>{const t=String(e.id);a[t]={id:e.id,score:e.score,importance:e.importance,scoreComponents:e.scoreComponents,status:e.status,analyzed_at:e.analyzed_at,error_message:e.error_message||e.message,cached_at:Date.now()}}));return a}))}),[]);const $=a((e=>{if(e&&e.length>0&&R){R(e)}V(e)}),[R,V]);const H=a((()=>{if(f.length!==1||!w){alert(r("Please select exactly one article to improve","echo-knowledge-base"));return}if(l){l(w)}}),[f,w,l]);const Y=a(((e,t)=>{h([e]);v(t);if(l&&t){l(t)}}),[l]);t((()=>{window.EPKB_AI_ContentAnalysis.handleImproveItem=Y}),[Y]);const M=a((()=>{P((e=>e+1))}),[]);t((()=>{if(j){D(j.showAnalysisProgress)}}),[j?.showAnalysisProgress]);t((()=>{if(j&&j.analysisJob){const e=j.analysisJob.status;if(e==="completed"||e==="canceled"||e==="idle"){}}}),[j?.analysisJob?.status]);return n("div",{className:"epkb-ai-data-collection-wrapper"},n("div",{className:"epkb-ai-data-source-layout"},n(c,{collectionId:1,settings:{...i||{},...o||{},kb_id:m},kb_list:b,selectedKbId:m,onKbChange:k,onSelectedIdsChange:W,onBulkDeleteCallback:J,onSelectAllCallback:U,onTotalItemsChange:F,refreshTrigger:E+u,initialData:o?.preloaded_data||null,onTrainingDataChange:T,isAnalyzing:z,onUpdateRowsCallback:q}),n("div",{className:"epkb-ai-data-source-settings"},n("h3",{className:"epkb-ai-data-source-heading"},r("Actions","echo-knowledge-base")),n("div",{className:"epkb-ai-action-section"},n("h4",{style:{marginTop:"0",marginBottom:"15px",fontSize:"16px",fontWeight:"600",display:"flex",alignItems:"center"}},n("span",{className:"epkbfa epkbfa-bar-chart",style:{marginRight:"8px",color:"#2271b1",fontSize:"24px"}}),r("Analyze Content","echo-knowledge-base")),n("div",{style:{paddingLeft:"20px"}},N&&n("div",{className:"epkb-ai-form-group epkb-ai-checkbox-group",style:{marginBottom:"15px"}},n("label",{className:"epkb-ai-checkbox-label",style:{display:"flex",alignItems:"center"}},n("input",{type:"checkbox",checked:f.length===x&&x>0,onChange:e=>N(e.target.checked),style:{marginRight:"10px"}}),n("span",null,r("Select All That Need Analysis","echo-knowledge-base")))),d?n(d,{selectedArticleIds:f,disabled:false,onArticleUpdate:$,onAnalysisStart:G,isSelectAllActive:f.length===x&&x>0,updateCacheCallback:V}):n("button",{className:"epkb-ai-button epkb-ai-button-primary",disabled:f.length===0,style:{background:"linear-gradient(135deg, #667EEA 0%, #764BA2 100%)",color:"#FFFFFF",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.3)",opacity:f.length===0?.6:1}},r("Analyze (Sync not loaded)","echo-knowledge-base")))),n("div",{className:"epkb-ai-info-box epkb-ai-score-legend"},n("h4",{className:"epkb-ai-score-legend__title"},r("Score Legend","echo-knowledge-base")),n("div",{className:"epkb-ai-score-legend__items"},n("div",{className:"epkb-ai-score-legend__item epkb-ai-score-legend__item--excellent"},n("span",{className:"epkb-ai-score-legend__indicator"}),n("strong",{className:"epkb-ai-score-legend__label"},"80-100%"),n("span",{className:"epkb-ai-score-legend__description"},r("Excellent","echo-knowledge-base"))),n("div",{className:"epkb-ai-score-legend__item epkb-ai-score-legend__item--good"},n("span",{className:"epkb-ai-score-legend__indicator"}),n("strong",{className:"epkb-ai-score-legend__label"},"60-79%"),n("span",{className:"epkb-ai-score-legend__description"},r("Good","echo-knowledge-base"))),n("div",{className:"epkb-ai-score-legend__item epkb-ai-score-legend__item--needs-improvement"},n("span",{className:"epkb-ai-score-legend__indicator"}),n("strong",{className:"epkb-ai-score-legend__label"},r("Below 60%","echo-knowledge-base")),n("span",{className:"epkb-ai-score-legend__description"},r("Needs Improvement","echo-knowledge-base"))))),n("div",{className:"epkb-ai-info-box epkb-ai-importance-legend"},n("h4",{className:"epkb-ai-importance-legend__title"},r("Importance Legend","echo-knowledge-base")),n("p",{className:"epkb-ai-importance-legend__description"},r("Based on article views - higher views mean higher priority.","echo-knowledge-base"))),n("div",{className:"epkb-ai-info-box epkb-ai-status-legend"},n("h4",{className:"epkb-ai-status-legend__title"},r("Status Legend","echo-knowledge-base")),n("div",{className:"epkb-ai-status-legend__items"},n("div",{className:"epkb-ai-status-legend__item epkb-ai-status-legend__item--to-analyze"},n("span",{className:"epkb-ai-status-legend__indicator"}),n("strong",{className:"epkb-ai-status-legend__label"},r("To Analyze","echo-knowledge-base")),n("span",{className:"epkb-ai-status-legend__description"},r("Not analyzed or updated","echo-knowledge-base"))),n("div",{className:"epkb-ai-status-legend__item epkb-ai-status-legend__item--to-improve"},n("span",{className:"epkb-ai-status-legend__indicator"}),n("strong",{className:"epkb-ai-status-legend__label"},r("To Improve","echo-knowledge-base")),n("span",{className:"epkb-ai-status-legend__description"},r("Score below 80%","echo-knowledge-base"))),n("div",{className:"epkb-ai-status-legend__item epkb-ai-status-legend__item--done"},n("span",{className:"epkb-ai-status-legend__indicator"}),n("strong",{className:"epkb-ai-status-legend__label"},r("Done","echo-knowledge-base")),n("span",{className:"epkb-ai-status-legend__description"},r("Completed","echo-knowledge-base"))),n("div",{className:"epkb-ai-status-legend__item epkb-ai-status-legend__item--ignored"},n("span",{className:"epkb-ai-status-legend__indicator"}),n("strong",{className:"epkb-ai-status-legend__label"},r("Ignored","echo-knowledge-base")),n("span",{className:"epkb-ai-status-legend__description"},r("Not important now","echo-knowledge-base"))),n("div",{className:"epkb-ai-status-legend__item epkb-ai-status-legend__item--analyzing"},n("span",{className:"epkb-ai-status-legend__indicator"}),n("strong",{className:"epkb-ai-status-legend__label"},r("Analyzing","echo-knowledge-base")),n("span",{className:"epkb-ai-status-legend__description"},r("In progress","echo-knowledge-base"))),n("div",{className:"epkb-ai-status-legend__item epkb-ai-status-legend__item--error"},n("span",{className:"epkb-ai-status-legend__indicator"}),n("strong",{className:"epkb-ai-status-legend__label"},r("Error","echo-knowledge-base")),n("span",{className:"epkb-ai-status-legend__description"},r("Failed - retry needed","echo-knowledge-base"))))))))};const u=({makeApiRequest:a,showSuccess:s,showError:o,onOpenImproveTab:i,settings:l={},tabData:c={}})=>{const d=c&&c.kb_id?c.kb_id:l&&l.kb_id?l.kb_id:1;const[p,b]=e({topImportant:[],lowestScore:[],importantAndLowScore:[],recentlyAnalyzed:[],ignored:[],done:[]});const[m,g]=e(true);const[_,u]=e(0);const[y,k]=e(new Set);t((()=>{const e=async()=>{g(true);try{const e=await a("content-analysis-articles-view",{params:{kb_id:d,status:"all",per_page:100}});let t=[];if(e&&e.data){if(Array.isArray(e.data)){t=e.data}else if(e.data.all&&e.data.all.data){t=e.data.all.data}}if(t.length>0){const e=t.filter((e=>e.display_status!=="Done"&&e.display_status!=="Ignored"));const a=[...e].filter((e=>e.importance!=="N/A"&&parseInt(e.importance)>0)).sort(((e,t)=>parseInt(t.importance)-parseInt(e.importance))).slice(0,10);const s=[...e].filter((e=>e.score!=="N/A"&&parseInt(e.score)>=0)).sort(((e,t)=>parseInt(e.score)-parseInt(t.score))).slice(0,10);const n=[...e].filter((e=>e.importance!=="N/A"&&e.score!=="N/A"&&parseInt(e.importance)>50&&parseInt(e.score)<70)).sort(((e,t)=>{const a=(100-parseInt(e.score))*(parseInt(e.importance)/100);const s=(100-parseInt(t.score))*(parseInt(t.importance)/100);return s-a})).slice(0,10);const o=[...t].filter((e=>e.last_analyzed&&e.last_analyzed!=="N/A"&&e.last_analyzed!=="Never")).sort(((e,t)=>new Date(t.last_analyzed)-new Date(e.last_analyzed))).slice(0,10);const i=t.filter((e=>e.display_status==="Ignored")).slice(0,10);const l=t.filter((e=>e.display_status==="Done")).slice(0,10);b({topImportant:a,lowestScore:s,importantAndLowScore:n,recentlyAnalyzed:o,ignored:i,done:l})}g(false)}catch(e){console.error("Error fetching articles data:",e);g(false)}};e()}),[_,a]);const f=(e,t)=>{k(new Set(["topImportant","lowestScore","importantAndLowScore","recentlyAnalyzed","ignored","done"]));setTimeout((()=>{b((a=>{const s={...a};let n=null;Object.keys(s).forEach((t=>{const a=s[t].findIndex((t=>(t.item_id||t.id)===e));if(a!==-1){n=s[t][a];s[t]=s[t].filter(((e,t)=>t!==a))}}));if(n){if(t==="ignored"){n.display_status="Ignored";s.ignored=[n,...s.ignored].slice(0,10)}else if(t==="done"){n.display_status="Done";s.done=[n,...s.done].slice(0,10)}else if(t==="active"){n.display_status="To Improve";const e=parseInt(n.importance);const t=parseInt(n.score);if(e>0){const e=[...s.topImportant,n].sort(((e,t)=>parseInt(t.importance)-parseInt(e.importance))).slice(0,10);s.topImportant=e}if(t>=0){const e=[...s.lowestScore,n].sort(((e,t)=>parseInt(e.score)-parseInt(t.score))).slice(0,10);s.lowestScore=e}if(e>50&&t<70){const e=[...s.importantAndLowScore,n].sort(((e,t)=>{const a=(100-parseInt(e.score))*(parseInt(e.importance)/100);const s=(100-parseInt(t.score))*(parseInt(t.importance)/100);return s-a})).slice(0,10);s.importantAndLowScore=e}if(n.last_analyzed&&n.last_analyzed!=="N/A"&&n.last_analyzed!=="Never"){const e=[...s.recentlyAnalyzed,n].sort(((e,t)=>new Date(t.last_analyzed)-new Date(e.last_analyzed))).slice(0,10);s.recentlyAnalyzed=e}}}return s}));k(new Set)}),200)};const h=async(e,t)=>{try{let s;switch(t){case"ignored":s=await a("content-analysis-toggle-ignored",{method:"POST",data:{article_id:e,ignored:true}});break;case"done":s=await a("content-analysis-toggle-done",{method:"POST",data:{article_id:e,done:true}});break;case"active":await a("content-analysis-toggle-ignored",{method:"POST",data:{article_id:e,ignored:false}});s=await a("content-analysis-toggle-done",{method:"POST",data:{article_id:e,done:false}});break;default:o(r("Invalid status","echo-knowledge-base"));return}if(s&&s.success){f(e,t)}else{o(s?.message||r("Failed to update article status","echo-knowledge-base"))}}catch(e){console.error("Error updating article status:",e);o(r("Error updating article status","echo-knowledge-base"))}};const w=(e,t,a)=>{const s=a!=="ignored"&&a!=="done";const o=a==="ignored"||a==="done";return n("div",{key:e.item_id||e.id,className:"epkb-article-item epkb-article-item--compact",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:t<9?"1px solid #e0e0e0":"none",fontSize:"13px"}},n("div",{className:"epkb-article-info",style:{display:"flex",alignItems:"center",flex:"1",minWidth:0,marginRight:"10px"}},n("span",{className:"epkb-article-rank",style:{marginRight:"8px",fontWeight:"500",color:"#666",minWidth:"20px"}},t+1+"."),n("a",{href:e.edit_link||"#",target:"_blank",className:"epkb-article-title",title:e.title,style:{color:"#2271b1",textDecoration:"none",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:"1",maxWidth:"50%"}},e.title||"Untitled"),n("div",{style:{display:"flex",gap:"12px",marginLeft:"12px",fontSize:"12px",whiteSpace:"nowrap",alignItems:"center"}},e.score!=="N/A"&&(()=>{const t=e=>{if(e>=80)return"#46b450";if(e>=60)return"#f0ad4e";return"#d54e21"};const a=e.scoreComponents||[{name:"Tags Usage",value:"-"},{name:"Gap Analysis",value:"-"},{name:"Readability",value:"-"}];const s=e=>({display:"inline-block",width:"10px",height:"10px",backgroundColor:e==="-"||e==="Analyzing..."?"#e0e0e0":t(e),marginRight:"2px",borderRadius:"2px"});return n("div",{title:a.map(((e,t)=>{const a=["Tags Usage","Gap Analysis","Readability"];const s=["Tags Usage","Gap Analysis","Readability"];const n=e.name&&s.includes(e.name)?e.name:a[t]||"Score "+(t+1);const o=e.value==="-"?"Not analyzed":e.value==="Analyzing..."?"Analyzing...":e.value+"%";return`${n}: ${o}`})).join("\n"),style:{cursor:"help",display:"inline-flex",alignItems:"center"}},a.map(((e,t)=>n("span",{key:t,style:s(e.value)}))),n("span",{style:{marginLeft:"4px",fontWeight:"500",color:e.score==="-"||e.score==="Analyzing..."?"#666":t(e.score),fontSize:"11px"}},`${e.score}%`))})(),e.importance!=="N/A"&&e.importance!==undefined&&n("span",{style:{color:"#666",fontWeight:"500",fontSize:"11px"}},`Imp: ${e.importance}%`))),n("div",{className:"epkb-article-actions",style:{display:"flex",gap:"5px"}},(e.item_id||e.id)&&n("button",{key:"improve-link",onClick:t=>{t.preventDefault();if(i){const t={id:e.item_id||e.id,title:e.title,score:e.score,importance:e.importance,scoreComponents:e.scoreComponents,last_analyzed:e.last_analyzed,status:e.status||e.display_status,edit_link:e.edit_link,view_link:e.view_link,is_demo:e.is_demo||false};i(t)}},className:"button button-small",style:{padding:"4px 10px",fontSize:"11px",height:"26px",backgroundColor:"#e3f2fd",borderColor:"#bbdefb",color:"#0d47a1",textDecoration:"none",display:"inline-flex",alignItems:"center",justifyContent:"center",lineHeight:"1",marginRight:"3px",cursor:"pointer",borderRadius:"4px",fontWeight:"500",transition:"all 0.2s ease"}},n("span",{className:"epkbfa epkbfa-magic",style:{marginRight:"4px",fontSize:"10px"}}),r("Improve","echo-knowledge-base")),s&&[n("button",{key:"ignore",className:"button button-small",onClick:t=>{t.preventDefault();h(e.item_id||e.id,"ignored")},style:{padding:"4px 10px",fontSize:"11px",height:"26px",backgroundColor:"#f5f5f5",borderColor:"#e0e0e0",color:"#424242",display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",fontWeight:"500",transition:"all 0.2s ease"}},n("span",{className:"epkbfa epkbfa-eye-slash",style:{marginRight:"4px",fontSize:"10px"}}),r("Ignore","echo-knowledge-base")),n("button",{key:"done",className:"button button-small",onClick:t=>{t.preventDefault();h(e.item_id||e.id,"done")},style:{padding:"4px 10px",fontSize:"11px",height:"26px",backgroundColor:"#e8f5e8",borderColor:"#c8e6c8",color:"#1b5e20",display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",fontWeight:"500",transition:"all 0.2s ease"}},n("span",{className:"epkbfa epkbfa-check",style:{marginRight:"4px",fontSize:"10px"}}),r("Done","echo-knowledge-base"))],o&&n("button",{className:"button button-small",onClick:t=>{t.preventDefault();h(e.item_id||e.id,"active")},style:{padding:"4px 10px",fontSize:"11px",height:"26px",backgroundColor:"#fff3e0",borderColor:"#ffcc80",color:"#e65100",display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",fontWeight:"500",transition:"all 0.2s ease"}},n("span",{className:"epkbfa epkbfa-times",style:{marginRight:"4px",fontSize:"10px"}}),r("Remove","echo-knowledge-base"))))};const v=(e,t,a,s)=>{const o=y.has(s);return n("div",{key:t,className:"epkb-card epkb-card--recently-edited",style:{backgroundColor:"#fff",border:"1px solid #e0e0e0",borderRadius:"4px",padding:"15px",height:"fit-content",position:"relative",opacity:o?.6:1,transition:"opacity 0.2s"}},n("div",{className:"epkb-most-viewed-header",style:{marginBottom:"12px",paddingBottom:"8px",borderBottom:"2px solid #f0f0f0"}},n("h3",{style:{margin:0,fontSize:"15px",fontWeight:"600"}},e,o&&n("span",{className:"dashicons dashicons-update",style:{animation:"spin 1s linear infinite",marginLeft:"10px",color:"#2271b1"}}))),n("div",{className:"epkb-most-viewed-list"},a.length>0?a.map(((e,t)=>w(e,t,s))):n("div",{style:{padding:"10px",color:"#666",fontStyle:"italic",fontSize:"13px"}},r("No articles found","echo-knowledge-base"))))};if(m){return n("div",{className:"epkb-ai-improve-tab-container",style:{padding:"20px",textAlign:"center"}},n("div",{className:"epkb-loading-spinner"},r("Loading articles...","echo-knowledge-base")))}return n("div",{className:"epkb-ai-improve-tab-container",style:{padding:"20px"}},n("style",{},`\n\n\t\t\t\t@keyframes spin {\n\t\t\t\t\tfrom { transform: rotate(0deg); }\n\t\t\t\t\tto { transform: rotate(360deg); }\n\t\t\t\t}\n\n\t\t\t`),n("div",{className:"epkb-improve-boxes-grid"},v(r("Important and Low Score","echo-knowledge-base"),"important-low-score",p.importantAndLowScore,"importantAndLowScore"),v(r("Top Important","echo-knowledge-base"),"top-important",p.topImportant,"topImportant"),v(r("Lowest Score","echo-knowledge-base"),"lowest-score",p.lowestScore,"lowestScore"),v(r("Recently Analyzed","echo-knowledge-base"),"recently-analyzed",p.recentlyAnalyzed,"recentlyAnalyzed"),v(r("Ignored","echo-knowledge-base"),"ignored",p.ignored,"ignored"),v(r("Done","echo-knowledge-base"),"done",p.done,"done")))};const y=({articleData:e,makeApiRequest:t,showSuccess:a,showError:s})=>{const o=window.EPKB_AI_ContentAnalysisDetails;return n(o,{articleData:e,makeApiRequest:t,showSuccess:a,showError:s})};const k=({settings:i,tabData:l,onDataChange:c,makeApiRequest:d,showError:b,showSuccess:m})=>{const k=g();const[f,h]=e((()=>{const e=k.get("activeSubTab");return e&&e.value?e.value:"overview"}));const[w,v]=e((()=>{const e=k.get("dynamicSubTabs");return e&&e.value?e.value:{}}));const[A,I]=e((()=>{const e=k.get("showProgressIndicator");return e&&e.value===true?true:false}));t((()=>{k.set("activeSubTab",f);if(!window.EPKB_AI_ContentAnalysis){window.EPKB_AI_ContentAnalysis={}}window.EPKB_AI_ContentAnalysis.activeSubTab=f}),[f]);t((()=>{k.set("dynamicSubTabs",w)}),[w]);t((()=>{k.set("showProgressIndicator",A)}),[A]);const N={overview:{id:"overview",title:r("Analyze Content","echo-knowledge-base"),icon:"epkbfa epkbfa-bar-chart"},improve:{id:"improve",title:r("Improve Content","echo-knowledge-base"),icon:"epkbfa epkbfa-magic"}};const S={...N,...w};const x=a((e=>{if(!e||!e.title)return;const t="improve-"+e.id;if(!w[t]){const t=Object.keys(w).filter((e=>e.startsWith("improve-"))).map((e=>e.replace("improve-","")));const a=window.EPKB_AI_Util_React.canAddArticleTab(t,e.id);if(!a.allowed&&a.message){if(b){b(a.message)}else{alert(a.message)}return}}const a=e.title.split(" ").slice(0,3).join(" ");if(!w[t]){v((s=>({...s,[t]:{id:t,title:a,icon:"epkbfa epkbfa-file-text-o",articleData:e,isCloseable:true}})))}h(t);(function(){const t={mergeWithExisting:true,skipSetLoading:false};const a=window.EPKB_AI_ContentAnalysisDetails_API||(window.EPKB_AI_ContentAnalysisDetails_API={});if(typeof a.requestProcessedContent==="function"){a.requestProcessedContent(e.id,t)}else{a.pendingFetch={articleId:e.id,options:t}}})()}),[w,b]);const C=a((e=>{const t=e.replace("improve-","");if(window.EPKB_AI_Util_React&&t){window.EPKB_AI_Util_React.removeArticleAnalysisData(t);const a=Object.keys(w).filter((t=>t.startsWith("improve-")&&t!==e)).map((e=>e.replace("improve-","")));window.EPKB_AI_Util_React.cleanupArticleStorage(a)}v((t=>{const a={...t};delete a[e];return a}));if(f===e){h("overview")}}),[f,w]);const E=()=>{if(!f||f==="overview"){return n(_,{tabData:l,settings:i,onOpenImproveTab:x})}else if(f==="improve"){return n(u,{makeApiRequest:d,showSuccess:m,showError:b,onOpenImproveTab:x,settings:i,tabData:l})}else if(f&&typeof f==="string"&&f.startsWith("improve-")){const e=S[f];if(e&&e.articleData){return n(y,{articleData:e.articleData,makeApiRequest:d,showSuccess:m,showError:b})}}return n("div",null,r("Unknown sub-tab","echo-knowledge-base"))};const P=window.EPKB_AI_ContentAnalysisSyncContext?s(window.EPKB_AI_ContentAnalysisSyncContext):null;t((()=>{if(P){I(P.showAnalysisProgress)}}),[P?.showAnalysisProgress]);return n(o,null,n("div",{className:"epkb-ai-training-data-container"},n("div",{className:"epkb-ai-custom-tabs",role:"tablist"},n("div",{className:"epkb-ai-tabs-nav"},n("div",{className:"epkb-ai-tabs-action-group"},Object.entries(S).filter((([e,t])=>!t.articleData)).map((([e,t])=>{const a=["epkb-ai-tab-button",f===e?"is-active":""].filter(Boolean).join(" ");const s=t.icon?["epkb-ai-tab-icon",t.icon,"epkb-ai-tab-icon--primary"].join(" "):null;return n("button",{key:e,className:a,onClick:()=>h(e),type:"button",role:"tab","aria-selected":f===e?"true":"false"},s&&n("span",{className:s,"aria-hidden":"true"}),n("span",{className:"epkb-ai-tab-label"},t.title))}))),Object.keys(w).length>0&&n("div",{className:"epkb-ai-tabs-article-group"},Object.entries(S).filter((([e,t])=>t.articleData)).map((([e,t])=>{const a=["epkb-ai-tab-button","epkb-ai-tab-button--article",f===e?"is-active":""].filter(Boolean).join(" ");const s=t.icon?["epkb-ai-tab-icon",t.icon,"epkb-ai-tab-icon--article"].join(" "):null;return n("button",{key:e,className:a,onClick:()=>h(e),type:"button",role:"tab","aria-selected":f===e?"true":"false"},s&&n("span",{className:s,"aria-hidden":"true"}),n("span",{className:"epkb-ai-tab-label epkb-ai-tab-label--article"},t.title),t.isCloseable&&n("span",{className:"epkb-ai-tab-close epkbfa epkbfa-times",role:"button",tabIndex:0,onKeyDown:t=>{if(t.key==="Enter"||t.key===" "){t.preventDefault();t.stopPropagation();C(e)}},onClick:t=>{t.stopPropagation();C(e)}}))}))))),!window.__EPKB_AI_HAS_TOP_LEVEL_CONTENT_ANALYSIS_PROVIDER__&&A&&!(f&&typeof f==="string"&&f.startsWith("improve-"))&&p&&n("div",{className:"epkb-ai-sync-message-container",style:{position:"relative",zIndex:10}},n(p)),n("div",{className:"epkb-ai-tab-panels"},n("div",{className:"epkb-ai-tab-panel is-active"},n("div",{className:"epkb-ai-tab-panel__inner"},E())))))};const f=e=>{const t=!!window.__EPKB_AI_HAS_TOP_LEVEL_CONTENT_ANALYSIS_PROVIDER__;const a=window.EPKB_AI_ContentAnalysisSyncProvider;if(a&&!t){return n(m,null,n(a,null,n(k,e)))}return n(m,null,n(k,e))};window.EPKB_AI_ContentAnalysis=window.EPKB_AI_ContentAnalysis||{};window.EPKB_AI_ContentAnalysis.AIAdminContentAnalysis=f;window.EPKB_AI_ContentAnalysis.handleImproveItem=e=>{}})();