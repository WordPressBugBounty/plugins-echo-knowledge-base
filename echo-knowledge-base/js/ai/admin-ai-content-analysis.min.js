(function(){"use strict";const{useState:e,useEffect:t,useCallback:a,useContext:s,createElement:n,Fragment:o,createContext:i,useMemo:l}=wp.element;const{__:r}=wp.i18n;const{clearAllEPKBSessionStorage:c}=window.EPKB_AI_Util_React||{};const d=window.EPKB_AI_ContentAnalysisTable||(()=>n("div",null,"ContentAnalysisTable component not loaded"));const{ContentAnalysisControls:p,ContentAnalysisProgressBar:m}=window.EPKB_AI_ContentAnalysisSync?{ContentAnalysisControls:window.EPKB_AI_ContentAnalysisControls,ContentAnalysisProgressBar:window.EPKB_AI_ContentAnalysisProgressBar}:{};const g=i();window.EPKB_AI_ContentAnalysisCacheContext=g;const b=({children:a})=>{const s=()=>{let e={};try{o();const t=localStorage.getItem("epkb_ai_content_analysis_cache");if(t){e=JSON.parse(t)}Object.keys(localStorage).forEach((t=>{if(t.startsWith("epkb_content_analysis_cache_")){try{const a=t.replace("epkb_content_analysis_cache_","");const s=JSON.parse(localStorage.getItem(t));if(s){e[a]=s}}catch(e){}}}))}catch(e){}return e};const o=()=>{const e=Date.now();const t=24*60*60*1e3;try{const a="epkb_content_analysis_cache_analysis_results_cache";const s=localStorage.getItem(a);if(s){const n=JSON.parse(s);if(n.value){const s={};let o=0;Object.keys(n.value).forEach((a=>{const i=n.value[a];if(!i.cached_at||e-i.cached_at<t){s[a]=i}else{o++}}));if(o>0){localStorage.setItem(a,JSON.stringify({value:s,timestamp:e}))}}}}catch(e){}};const[i,r]=e(s);t((()=>{const e=()=>{if(document.visibilityState==="visible"){if(window.EPKB_AI_ContentAnalysisTable&&window.EPKB_AI_ContentAnalysisTable.refreshAllRows){setTimeout((()=>{window.EPKB_AI_ContentAnalysisTable.refreshAllRows()}),100)}}};document.addEventListener("visibilitychange",e);return()=>{document.removeEventListener("visibilitychange",e)}}),[]);t((()=>{const e=()=>{};window.addEventListener("beforeunload",e);return()=>{window.removeEventListener("beforeunload",e)}}),[]);t((()=>{try{localStorage.setItem("epkb_ai_content_analysis_cache",JSON.stringify(i));if(i.analysis_results_cache){try{const e=localStorage.getItem("epkb_content_analysis_cache_analysis_results_cache");const t=e?JSON.parse(e):null;if(!t||!t.timestamp||i.analysis_results_cache.timestamp>t.timestamp){localStorage.setItem("epkb_content_analysis_cache_analysis_results_cache",JSON.stringify(i.analysis_results_cache))}}catch(e){localStorage.setItem("epkb_content_analysis_cache_analysis_results_cache",JSON.stringify(i.analysis_results_cache))}}if(i.batch_state){localStorage.setItem("epkb_analysis_batch_state",JSON.stringify(i.batch_state))}if(i.analyzing_articles){localStorage.setItem("epkb_analysis_in_progress",JSON.stringify(i.analyzing_articles))}}catch(e){if(e.name==="QuotaExceededError"){o();r({});try{localStorage.removeItem("epkb_ai_content_analysis_cache");localStorage.removeItem("epkb_analysis_batch_state");localStorage.removeItem("epkb_analysis_in_progress");localStorage.removeItem("epkb_analysis_completed")}catch(e){}}else{}}}),[i]);const c=l((()=>({get:e=>i[e],set:(e,t)=>{r((a=>({...a,[e]:{value:t,timestamp:Date.now()}})))},remove:e=>{r((t=>{const a={...t};delete a[e];return a}))},clear:()=>{r({});try{localStorage.removeItem("epkb_ai_content_analysis_cache");localStorage.removeItem("epkb_analysis_batch_state");localStorage.removeItem("epkb_analysis_in_progress");localStorage.removeItem("epkb_analysis_completed");localStorage.removeItem("epkb_content_analysis_cache_analysis_results_cache")}catch(e){}}})),[i]);return n(g.Provider,{value:c},a)};const _=()=>{const e=s(g);if(!e){throw new Error("useContentAnalysisCache must be used within ContentAnalysisCacheProvider")}return e};const u=({tabData:o,settings:i,onOpenImproveTab:l})=>{const c=_();const[m,g]=e((()=>{const e=c.get("overview_selectedIds");return e&&Array.isArray(e.value)?e.value:[]}));const[b,u]=e((()=>{const e=c.get("overview_selectedArticle");return e&&e.value?e.value:null}));const[k,y]=e(null);const[h,f]=e(null);const[w,v]=e((()=>{const e=c.get("overview_totalItems");return e&&typeof e.value==="number"?e.value:0}));const[N,A]=e(0);const[I,S]=e((()=>{const e=c.get("overview_showAnalysisProgress");return e&&e.value===true?true:false}));const[x,C]=e((()=>{const e=c.get("overview_articlesData");return e&&Array.isArray(e.value)?e.value:[]}));const[z,E]=e(null);const[P,D]=e((()=>{const e=c.get("analysis_results_cache");return e&&e.value?e.value:{}}));t((()=>{c.set("overview_selectedIds",m)}),[m]);t((()=>{c.set("overview_selectedArticle",b)}),[b]);t((()=>{c.set("overview_totalItems",w)}),[w]);t((()=>{c.set("overview_showAnalysisProgress",I)}),[I]);t((()=>{c.set("overview_articlesData",x)}),[x]);t((()=>{c.set("analysis_results_cache",P)}),[P]);const B=window.EPKB_AI_ContentAnalysisSyncContext?s(window.EPKB_AI_ContentAnalysisSyncContext):null;const T=a(((e,t)=>{g(e);if(e.length===1&&t){u(t)}else{u(null)}}),[]);const R=a((e=>{y((()=>e))}),[]);const L=a((e=>{f((()=>e))}),[]);const O=a((e=>{v(e)}),[]);const K=a((e=>{E((()=>e))}),[]);const W=a((()=>{S(true);g([])}),[]);const J=a((e=>{if(!e||e.length===0)return;D((t=>{const a={...t};e.forEach((e=>{const t=String(e.id);a[t]={id:e.id,score:e.score,importance:e.importance,scoreComponents:e.scoreComponents,status:e.status,analyzed_at:e.analyzed_at,error_message:e.error_message||e.message,cached_at:Date.now()}}));return a}))}),[]);const j=a((e=>{if(e&&e.length>0&&z){z(e)}J(e)}),[z,J]);const $=a((()=>{if(m.length!==1||!b){alert(r("Please select exactly one article to improve","echo-knowledge-base"));return}if(l){l(b)}}),[m,b,l]);const F=a(((e,t)=>{g([e]);u(t);if(l&&t){l(t)}}),[l]);t((()=>{window.EPKB_AI_ContentAnalysis.handleImproveItem=F}),[F]);const q=a((()=>{A((e=>e+1))}),[]);t((()=>{if(B){S(B.showAnalysisProgress)}}),[B?.showAnalysisProgress]);t((()=>{if(B&&B.analysisJob){const e=B.analysisJob.status;if(e==="completed"||e==="canceled"||e==="idle"){}}}),[B?.analysisJob?.status]);return n("div",{className:"epkb-ai-data-collection-wrapper"},n("div",{className:"epkb-ai-data-source-layout"},n(d,{collectionId:1,settings:{...i,kb_id:1},onSelectedIdsChange:T,onBulkDeleteCallback:R,onSelectAllCallback:L,onTotalItemsChange:O,refreshTrigger:N,initialData:o?.preloaded_data||null,onTrainingDataChange:C,isAnalyzing:I,onUpdateRowsCallback:K}),n("div",{className:"epkb-ai-data-source-settings"},n("h3",{className:"epkb-ai-data-source-heading"},r("Actions","echo-knowledge-base")),n("div",{className:"epkb-ai-action-section"},n("h4",{style:{marginTop:"0",marginBottom:"15px",fontSize:"16px",fontWeight:"600",display:"flex",alignItems:"center"}},n("span",{className:"epkbfa epkbfa-bar-chart",style:{marginRight:"8px",color:"#2271b1"}}),r("Analyze Content","echo-knowledge-base")),n("div",{style:{paddingLeft:"20px"}},h&&n("div",{className:"epkb-ai-form-group epkb-ai-checkbox-group",style:{marginBottom:"15px"}},n("label",{className:"epkb-ai-checkbox-label",style:{display:"flex",alignItems:"center"}},n("input",{type:"checkbox",checked:m.length===w&&w>0,onChange:e=>h(e.target.checked),style:{marginRight:"10px"}}),n("span",null,r("Select All That Need Analysis","echo-knowledge-base")))),p?n(p,{selectedArticleIds:m,disabled:false,onArticleUpdate:j,onAnalysisStart:W,isSelectAllActive:m.length===w&&w>0,updateCacheCallback:J}):n("button",{className:"epkb-ai-button epkb-ai-button-primary",disabled:m.length===0,style:{background:"linear-gradient(135deg, #667EEA 0%, #764BA2 100%)",color:"#FFFFFF",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.3)",opacity:m.length===0?.6:1}},r("Analyze (Sync not loaded)","echo-knowledge-base")))),n("div",{className:"epkb-ai-action-section epkb-ai-improve-content-action"},n("h4",{className:"epkb-ai-action-header"},n("span",{className:`epkbfa epkbfa-magic epkb-ai-action-icon ${m.length===1?"epkb-ai-action-icon--single":"epkb-ai-action-icon--multiple"}`}),r("Improve Content","echo-knowledge-base")),n("div",{className:"epkb-ai-action-content"},m.length===1&&b?n("div",{className:"epkb-ai-selected-article"},n("div",{className:"epkb-ai-article-card"},n("h5",{className:"epkb-ai-article-title"},b.title),n("div",{className:"epkb-ai-article-stats"},n("div",{className:"epkb-ai-article-score"},n("span",{className:"epkb-ai-score-label"},r("Score:","echo-knowledge-base"))," ",n("span",{className:`epkb-ai-score-value ${b.score>=80?"epkb-ai-score-value--high":b.score>=60?"epkb-ai-score-value--medium":"epkb-ai-score-value--low"}`},b.score+"%")),n("div",{className:"epkb-ai-article-importance"},n("span",{className:"epkb-ai-importance-label"},r("Importance:","echo-knowledge-base")),n("div",{className:"epkb-ai-importance-bar"},n("div",{className:"epkb-ai-importance-fill",style:{width:`${b.importance}%`}})))),b.scoreComponents&&n("div",{className:"epkb-ai-article-components"},n("span",{className:"epkb-ai-components-label"},r("Components:","echo-knowledge-base")),n("ul",{className:"epkb-ai-components-list"},b.scoreComponents.map(((e,t)=>{let a="not-analyzed";if(e.value==="Analyzing..."){a="analyzing"}else if(e.value!=="-"&&!isNaN(e.value)){const t=parseInt(e.value);if(t>=80)a="excellent";else if(t>=60)a="good";else a="needs-improvement"}return n("li",{key:t,"data-score":a},`${e.name}: ${e.value}%`)})))))):n("p",{className:"epkb-ai-select-message"},r("Select one article","echo-knowledge-base")),n("button",{className:`epkb-ai-button epkb-ai-button-primary epkb-ai-improve-button`,disabled:m.length!==1,onClick:$},n("span",null,r("Improve Content","echo-knowledge-base")),n("span",{className:"epkbfa epkbfa-caret-right epkb-ai-button-arrow"})))),n("div",{className:"epkb-ai-info-box epkb-ai-score-legend"},n("h4",{className:"epkb-ai-score-legend__title"},r("Score Legend","echo-knowledge-base")),n("div",{className:"epkb-ai-score-legend__items"},n("div",{className:"epkb-ai-score-legend__item epkb-ai-score-legend__item--excellent"},n("span",{className:"epkb-ai-score-legend__indicator"}),n("strong",{className:"epkb-ai-score-legend__label"},"80-100%"),n("span",{className:"epkb-ai-score-legend__description"},r("Excellent","echo-knowledge-base"))),n("div",{className:"epkb-ai-score-legend__item epkb-ai-score-legend__item--good"},n("span",{className:"epkb-ai-score-legend__indicator"}),n("strong",{className:"epkb-ai-score-legend__label"},"60-79%"),n("span",{className:"epkb-ai-score-legend__description"},r("Good","echo-knowledge-base"))),n("div",{className:"epkb-ai-score-legend__item epkb-ai-score-legend__item--needs-improvement"},n("span",{className:"epkb-ai-score-legend__indicator"}),n("strong",{className:"epkb-ai-score-legend__label"},r("Below 60%","echo-knowledge-base")),n("span",{className:"epkb-ai-score-legend__description"},r("Needs Improvement","echo-knowledge-base"))))),n("div",{className:"epkb-ai-info-box epkb-ai-importance-legend"},n("h4",{className:"epkb-ai-importance-legend__title"},r("Importance Legend","echo-knowledge-base")),n("p",{className:"epkb-ai-importance-legend__description"},r("Based on article views - higher views mean higher priority.","echo-knowledge-base"))),n("div",{className:"epkb-ai-info-box epkb-ai-status-legend"},n("h4",{className:"epkb-ai-status-legend__title"},r("Status Legend","echo-knowledge-base")),n("div",{className:"epkb-ai-status-legend__items"},n("div",{className:"epkb-ai-status-legend__item epkb-ai-status-legend__item--to-analyze"},n("span",{className:"epkb-ai-status-legend__indicator"}),n("strong",{className:"epkb-ai-status-legend__label"},r("To Analyze","echo-knowledge-base")),n("span",{className:"epkb-ai-status-legend__description"},r("Not analyzed or updated","echo-knowledge-base"))),n("div",{className:"epkb-ai-status-legend__item epkb-ai-status-legend__item--to-improve"},n("span",{className:"epkb-ai-status-legend__indicator"}),n("strong",{className:"epkb-ai-status-legend__label"},r("To Improve","echo-knowledge-base")),n("span",{className:"epkb-ai-status-legend__description"},r("Score below 80%","echo-knowledge-base"))),n("div",{className:"epkb-ai-status-legend__item epkb-ai-status-legend__item--done"},n("span",{className:"epkb-ai-status-legend__indicator"}),n("strong",{className:"epkb-ai-status-legend__label"},r("Done","echo-knowledge-base")),n("span",{className:"epkb-ai-status-legend__description"},r("Completed","echo-knowledge-base"))),n("div",{className:"epkb-ai-status-legend__item epkb-ai-status-legend__item--ignored"},n("span",{className:"epkb-ai-status-legend__indicator"}),n("strong",{className:"epkb-ai-status-legend__label"},r("Ignored","echo-knowledge-base")),n("span",{className:"epkb-ai-status-legend__description"},r("Not important now","echo-knowledge-base"))),n("div",{className:"epkb-ai-status-legend__item epkb-ai-status-legend__item--analyzing"},n("span",{className:"epkb-ai-status-legend__indicator"}),n("strong",{className:"epkb-ai-status-legend__label"},r("Analyzing","echo-knowledge-base")),n("span",{className:"epkb-ai-status-legend__description"},r("In progress","echo-knowledge-base"))),n("div",{className:"epkb-ai-status-legend__item epkb-ai-status-legend__item--error"},n("span",{className:"epkb-ai-status-legend__indicator"}),n("strong",{className:"epkb-ai-status-legend__label"},r("Error","echo-knowledge-base")),n("span",{className:"epkb-ai-status-legend__description"},r("Failed - retry needed","echo-knowledge-base"))))))))};const k=({makeApiRequest:a,showSuccess:s,showError:o,onOpenImproveTab:i})=>{const[l,c]=e({topImportant:[],lowestScore:[],importantAndLowScore:[],recentlyAnalyzed:[],ignored:[],done:[]});const[d,p]=e(true);const[m,g]=e(0);const[b,_]=e(new Set);t((()=>{const e=async()=>{p(true);try{const e=await a("content-analysis-articles",{params:{kb_id:1,status:"all",per_page:100}});let t=[];if(e&&e.data){if(Array.isArray(e.data)){t=e.data}else if(e.data.all&&e.data.all.data){t=e.data.all.data}}if(t.length>0){const e=t.filter((e=>e.display_status!=="Done"&&e.display_status!=="Ignored"));const a=[...e].filter((e=>e.importance!=="N/A"&&parseInt(e.importance)>0)).sort(((e,t)=>parseInt(t.importance)-parseInt(e.importance))).slice(0,10);const s=[...e].filter((e=>e.score!=="N/A"&&parseInt(e.score)>=0)).sort(((e,t)=>parseInt(e.score)-parseInt(t.score))).slice(0,10);const n=[...e].filter((e=>e.importance!=="N/A"&&e.score!=="N/A"&&parseInt(e.importance)>50&&parseInt(e.score)<70)).sort(((e,t)=>{const a=(100-parseInt(e.score))*(parseInt(e.importance)/100);const s=(100-parseInt(t.score))*(parseInt(t.importance)/100);return s-a})).slice(0,10);const o=[...t].filter((e=>e.last_analyzed&&e.last_analyzed!=="N/A"&&e.last_analyzed!=="Never")).sort(((e,t)=>new Date(t.last_analyzed)-new Date(e.last_analyzed))).slice(0,10);const i=t.filter((e=>e.display_status==="Ignored")).slice(0,10);const l=t.filter((e=>e.display_status==="Done")).slice(0,10);c({topImportant:a,lowestScore:s,importantAndLowScore:n,recentlyAnalyzed:o,ignored:i,done:l})}p(false)}catch(e){console.error("Error fetching articles data:",e);p(false)}};e()}),[m,a]);const u=(e,t)=>{_(new Set(["topImportant","lowestScore","importantAndLowScore","recentlyAnalyzed","ignored","done"]));setTimeout((()=>{c((a=>{const s={...a};let n=null;Object.keys(s).forEach((t=>{const a=s[t].findIndex((t=>(t.item_id||t.id)===e));if(a!==-1){n=s[t][a];s[t]=s[t].filter(((e,t)=>t!==a))}}));if(n){if(t==="ignored"){n.display_status="Ignored";s.ignored=[n,...s.ignored].slice(0,10)}else if(t==="done"){n.display_status="Done";s.done=[n,...s.done].slice(0,10)}else if(t==="active"){n.display_status="To Improve";const e=parseInt(n.importance);const t=parseInt(n.score);if(e>0){const e=[...s.topImportant,n].sort(((e,t)=>parseInt(t.importance)-parseInt(e.importance))).slice(0,10);s.topImportant=e}if(t>=0){const e=[...s.lowestScore,n].sort(((e,t)=>parseInt(e.score)-parseInt(t.score))).slice(0,10);s.lowestScore=e}if(e>50&&t<70){const e=[...s.importantAndLowScore,n].sort(((e,t)=>{const a=(100-parseInt(e.score))*(parseInt(e.importance)/100);const s=(100-parseInt(t.score))*(parseInt(t.importance)/100);return s-a})).slice(0,10);s.importantAndLowScore=e}if(n.last_analyzed&&n.last_analyzed!=="N/A"&&n.last_analyzed!=="Never"){const e=[...s.recentlyAnalyzed,n].sort(((e,t)=>new Date(t.last_analyzed)-new Date(e.last_analyzed))).slice(0,10);s.recentlyAnalyzed=e}}}return s}));_(new Set)}),200)};const k=async(e,t)=>{try{let s;switch(t){case"ignored":s=await a("content-analysis-toggle-ignored",{method:"POST",data:{article_id:e,ignored:true}});break;case"done":s=await a("content-analysis-toggle-done",{method:"POST",data:{article_id:e,done:true}});break;case"active":await a("content-analysis-toggle-ignored",{method:"POST",data:{article_id:e,ignored:false}});s=await a("content-analysis-toggle-done",{method:"POST",data:{article_id:e,done:false}});break;default:o(r("Invalid status","echo-knowledge-base"));return}if(s&&s.success){u(e,t)}else{o(s?.message||r("Failed to update article status","echo-knowledge-base"))}}catch(e){console.error("Error updating article status:",e);o(r("Error updating article status","echo-knowledge-base"))}};const y=(e,t,a)=>{const s=a!=="ignored"&&a!=="done";const o=a==="ignored"||a==="done";return n("div",{key:e.item_id||e.id,className:"epkb-article-item epkb-article-item--compact",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:t<9?"1px solid #e0e0e0":"none",fontSize:"13px"}},n("div",{className:"epkb-article-info",style:{display:"flex",alignItems:"center",flex:"1",minWidth:0,marginRight:"10px"}},n("span",{className:"epkb-article-rank",style:{marginRight:"8px",fontWeight:"500",color:"#666",minWidth:"20px"}},t+1+"."),n("a",{href:e.edit_link||"#",target:"_blank",className:"epkb-article-title",title:e.title,style:{color:"#2271b1",textDecoration:"none",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:"1",maxWidth:"50%"}},e.title||"Untitled"),n("div",{style:{display:"flex",gap:"12px",marginLeft:"12px",fontSize:"12px",whiteSpace:"nowrap",alignItems:"center"}},e.score!=="N/A"&&(()=>{const t=e=>{if(e>=80)return"#46b450";if(e>=60)return"#f0ad4e";return"#d54e21"};const a=e.scoreComponents||[{name:"Tags Usage",value:"-"},{name:"Score 2",value:"-"},{name:"Score 3",value:"-"}];const s=e=>({display:"inline-block",width:"10px",height:"10px",backgroundColor:e==="-"||e==="Analyzing..."?"#e0e0e0":t(e),marginRight:"2px",borderRadius:"2px"});return n("div",{title:a.map((e=>`${e.name}: ${e.value==="-"?"Not analyzed":e.value==="Analyzing..."?"Analyzing...":e.value+"%"}`)).join("\n"),style:{cursor:"help",display:"inline-flex",alignItems:"center"}},a.map(((e,t)=>n("span",{key:t,style:s(e.value)}))),n("span",{style:{marginLeft:"4px",fontWeight:"500",color:e.score==="-"||e.score==="Analyzing..."?"#666":t(e.score),fontSize:"11px"}},`${e.score}%`))})(),e.importance!=="N/A"&&e.importance!==undefined&&n("span",{style:{color:"#666",fontWeight:"500",fontSize:"11px"}},`Imp: ${e.importance}%`))),n("div",{className:"epkb-article-actions",style:{display:"flex",gap:"5px"}},(e.item_id||e.id)&&n("button",{key:"improve-link",onClick:t=>{t.preventDefault();if(i){const t={id:e.item_id||e.id,title:e.title,score:e.score,importance:e.importance,scoreComponents:e.scoreComponents,last_analyzed:e.last_analyzed,status:e.status||e.display_status,edit_link:e.edit_link,view_link:e.view_link};i(t)}},className:"button button-small",style:{padding:"4px 10px",fontSize:"11px",height:"26px",backgroundColor:"#e3f2fd",borderColor:"#bbdefb",color:"#0d47a1",textDecoration:"none",display:"inline-flex",alignItems:"center",justifyContent:"center",lineHeight:"1",marginRight:"3px",cursor:"pointer",borderRadius:"4px",fontWeight:"500",transition:"all 0.2s ease"}},[n("span",{className:"epkbfa epkbfa-magic",style:{marginRight:"4px",fontSize:"10px"}}),r("Improve","echo-knowledge-base")]),s&&[n("button",{key:"ignore",className:"button button-small",onClick:t=>{t.preventDefault();k(e.item_id||e.id,"ignored")},style:{padding:"4px 10px",fontSize:"11px",height:"26px",backgroundColor:"#f5f5f5",borderColor:"#e0e0e0",color:"#424242",display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",fontWeight:"500",transition:"all 0.2s ease"}},[n("span",{className:"epkbfa epkbfa-eye-slash",style:{marginRight:"4px",fontSize:"10px"}}),r("Ignore","echo-knowledge-base")]),n("button",{key:"done",className:"button button-small",onClick:t=>{t.preventDefault();k(e.item_id||e.id,"done")},style:{padding:"4px 10px",fontSize:"11px",height:"26px",backgroundColor:"#e8f5e8",borderColor:"#c8e6c8",color:"#1b5e20",display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",fontWeight:"500",transition:"all 0.2s ease"}},[n("span",{className:"epkbfa epkbfa-check",style:{marginRight:"4px",fontSize:"10px"}}),r("Done","echo-knowledge-base")])],o&&n("button",{className:"button button-small",onClick:t=>{t.preventDefault();k(e.item_id||e.id,"active")},style:{padding:"4px 10px",fontSize:"11px",height:"26px",backgroundColor:"#fff3e0",borderColor:"#ffcc80",color:"#e65100",display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",fontWeight:"500",transition:"all 0.2s ease"}},[n("span",{className:"epkbfa epkbfa-times",style:{marginRight:"4px",fontSize:"10px"}}),r("Remove","echo-knowledge-base")])))};const h=(e,t,a,s)=>{const o=b.has(s);return n("div",{key:t,className:"epkb-card epkb-card--recently-edited",style:{backgroundColor:"#fff",border:"1px solid #e0e0e0",borderRadius:"4px",padding:"15px",height:"fit-content",position:"relative",opacity:o?.6:1,transition:"opacity 0.2s"}},n("div",{className:"epkb-most-viewed-header",style:{marginBottom:"12px",paddingBottom:"8px",borderBottom:"2px solid #f0f0f0"}},n("h3",{style:{margin:0,fontSize:"15px",fontWeight:"600"}},e,o&&n("span",{className:"dashicons dashicons-update",style:{animation:"spin 1s linear infinite",marginLeft:"10px",color:"#2271b1"}}))),n("div",{className:"epkb-most-viewed-list"},a.length>0?a.map(((e,t)=>y(e,t,s))):n("div",{style:{padding:"10px",color:"#666",fontStyle:"italic",fontSize:"13px"}},r("No articles found","echo-knowledge-base"))))};if(d){return n("div",{className:"epkb-ai-improve-tab-container",style:{padding:"20px",textAlign:"center"}},n("div",{className:"epkb-loading-spinner"},r("Loading articles...","echo-knowledge-base")))}return n("div",{className:"epkb-ai-improve-tab-container",style:{padding:"20px"}},n("style",{},`\n\t\t\t\t@keyframes spin {\n\t\t\t\t\tfrom { transform: rotate(0deg); }\n\t\t\t\t\tto { transform: rotate(360deg); }\n\t\t\t\t}\n\t\t\t`),n("div",{className:"epkb-improve-boxes-grid",style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"20px"}},h(r("Important and Low Score","echo-knowledge-base"),"important-low-score",l.importantAndLowScore,"importantAndLowScore"),h(r("Top Important","echo-knowledge-base"),"top-important",l.topImportant,"topImportant"),h(r("Lowest Score","echo-knowledge-base"),"lowest-score",l.lowestScore,"lowestScore"),h(r("Recently Analyzed","echo-knowledge-base"),"recently-analyzed",l.recentlyAnalyzed,"recentlyAnalyzed"),h(r("Ignored","echo-knowledge-base"),"ignored",l.ignored,"ignored"),h(r("Done","echo-knowledge-base"),"done",l.done,"done")))};const y=({articleData:e,makeApiRequest:t,showSuccess:a,showError:s})=>{const o=window.EPKB_AI_ContentAnalysisDetails;return n(o,{articleData:e,makeApiRequest:t,showSuccess:a,showError:s})};const h=({settings:i,tabData:l,onDataChange:c,makeApiRequest:d,showError:p,showSuccess:g})=>{const b=_();const[h,f]=e((()=>{const e=b.get("activeSubTab");return e&&e.value?e.value:"overview"}));const[w,v]=e((()=>{const e=b.get("dynamicSubTabs");return e&&e.value?e.value:{}}));const[N,A]=e((()=>{const e=b.get("showProgressIndicator");return e&&e.value===true?true:false}));t((()=>{b.set("activeSubTab",h)}),[h]);t((()=>{b.set("dynamicSubTabs",w)}),[w]);t((()=>{b.set("showProgressIndicator",N)}),[N]);const I={overview:{id:"overview",title:r("Analyze","echo-knowledge-base"),icon:"epkbfa epkbfa-bar-chart"},improve:{id:"improve",title:r("Improve","echo-knowledge-base"),icon:"epkbfa epkbfa-magic"}};const S={...I,...w};const x=a((e=>{if(!e||!e.title)return;const t=e.title.split(" ").slice(0,3).join(" ");const a="improve-"+e.id;if(!w[a]){v((s=>({...s,[a]:{id:a,title:t,icon:"epkbfa epkbfa-file-text-o",articleData:e,isCloseable:true}})))}f(a)}),[w]);const C=a((e=>{v((t=>{const a={...t};delete a[e];return a}));if(h===e){f("overview")}}),[h]);const z=()=>{if(!h||h==="overview"){return n(u,{tabData:l,settings:i,onOpenImproveTab:x})}else if(h==="improve"){return n(k,{makeApiRequest:d,showSuccess:g,showError:p,onOpenImproveTab:x})}else if(h&&typeof h==="string"&&h.startsWith("improve-")){const e=S[h];if(e&&e.articleData){return n(y,{articleData:e.articleData,makeApiRequest:d,showSuccess:g,showError:p})}}return n("div",null,r("Unknown sub-tab","echo-knowledge-base"))};const E=window.EPKB_AI_ContentAnalysisSyncContext?s(window.EPKB_AI_ContentAnalysisSyncContext):null;t((()=>{if(E){A(E.showAnalysisProgress)}}),[E?.showAnalysisProgress]);return n(o,null,!window.__EPKB_AI_HAS_TOP_LEVEL_CONTENT_ANALYSIS_PROVIDER__&&N&&m&&n("div",{className:"epkb-ai-sync-message-container",style:{position:"relative",zIndex:10}},n(m)),n("div",{className:"epkb-ai-training-data-container"},n("div",{className:"epkb-ai-sub-tabs"},n("div",{className:"epkb-ai-sub-tabs-nav"},Object.entries(S).map((([e,t])=>n("button",{key:e,className:`epkb-ai-sub-tab-button ${h===e?"active":""}`,onClick:()=>f(e),type:"button",style:{position:"relative"}},t.icon&&n("span",{className:t.icon})," ",t.title,t.isCloseable&&n("span",{className:"epkbfa epkbfa-times",onClick:t=>{t.stopPropagation();C(e)},style:{marginLeft:"10px",cursor:"pointer",opacity:.6,transition:"opacity 0.2s"},onMouseEnter:e=>e.target.style.opacity=1,onMouseLeave:e=>e.target.style.opacity=.6})))))),z()))};const f=e=>{const t=!!window.__EPKB_AI_HAS_TOP_LEVEL_CONTENT_ANALYSIS_PROVIDER__;const a=window.EPKB_AI_ContentAnalysisSyncProvider;if(a&&!t){return n(b,null,n(a,null,n(h,e)))}return n(b,null,n(h,e))};window.EPKB_AI_ContentAnalysis=window.EPKB_AI_ContentAnalysis||{};window.EPKB_AI_ContentAnalysis.AIAdminContentAnalysis=f;window.EPKB_AI_ContentAnalysis.handleImproveItem=e=>{}})();