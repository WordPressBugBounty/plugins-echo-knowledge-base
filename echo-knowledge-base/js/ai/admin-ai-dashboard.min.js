(function(){"use strict";const{useState:t,useEffect:e,createElement:a}=wp.element;const{__:n}=wp.i18n;const{showError:s,showSuccess:o,makeApiRequest:i}=window.EPKB_AI_Util_React||{};const l=({settings:e,tabData:i,isLoading:l,onTabSwitch:c})=>{const r=i?.status||null;const d=e?.show_get_started||r?.show_get_started;const[p,b]=t([]);const[u,k]=t("");const m=()=>{if(!r){return null}if(d){return null}if(!d&&(r.overall==="error"||r.overall==="warning")){const t=[...r.issues||[],...r.warnings||[]];if(t.length>0){return a("div",{className:"epkb-ai-status-issues"},a("div",{className:"epkb-ai-status-section"},a("h3",null,n("Warnings","echo-knowledge-base")),t.map(((t,e)=>a("div",{key:e,className:"epkb-ai-notice epkb-ai-notice-warning"},a("p",null,t.message),t.action&&a("p",{className:"epkb-ai-action"},t.link?a("a",{href:t.link,className:"epkb-ai-button epkb-ai-button-small"},t.action):t.action))))))}return a("div",{className:"epkb-ai-status-issues"},r.warnings.length>0&&a("div",{className:"epkb-ai-status-section"},a("h3",null,n("Warnings","echo-knowledge-base")),r.warnings.map(((t,e)=>a("div",{key:e,className:"epkb-ai-notice epkb-ai-notice-warning"},a("p",null,t.message),t.action&&a("p",{className:"epkb-ai-action"},t.link?a("a",{href:t.link,className:"epkb-ai-button epkb-ai-button-small"},t.action):t.action))))))}return null};const h=()=>a("div",{className:"epkb-ai-welcome-setup"},a("div",{className:"epkb-ai-welcome-header"},a("h2",null,n("Welcome to AI Features!","echo-knowledge-base")),a("p",null,n("Let's get you set up with AI-powered chat and search in just a few steps.","echo-knowledge-base"))),a("div",{className:"epkb-ai-setup-steps-welcome"},a("div",{className:"epkb-ai-setup-step-welcome"},a("span",{className:"epkb-ai-step-icon epkbfa epkbfa-key"}),a("h3",null,n("Step 1: Configure API Key & Privacy","echo-knowledge-base")),a("p",null,n("Add your OpenAI API key and accept the data privacy agreement.","echo-knowledge-base")),a("button",{className:"epkb-ai-button epkb-ai-button-primary",onClick:()=>{if(c){c("general-settings")}}},n("Go to Settings","echo-knowledge-base"))),a("div",{className:"epkb-ai-setup-step-welcome"},a("span",{className:"epkb-ai-step-icon epkbfa epkbfa-rocket"}),a("h3",null,n("Step 2: Enable AI Chat and/or AI Search","echo-knowledge-base")),a("p",null,n("Enable AI Search or Chat features for your website.","echo-knowledge-base"))),a("div",{className:"epkb-ai-setup-step-welcome"},a("span",{className:"epkb-ai-step-icon epkbfa epkbfa-database"}),a("h3",null,n("Step 3: Add Training Data & Sync","echo-knowledge-base")),a("p",null,n("Select content and sync it to OpenAI for AI processing.","echo-knowledge-base")))));const g=t=>a("div",{className:"epkb-ai-setup-needed"},a("div",{className:"epkb-ai-setup-header"},a("h3",null,n("Complete Your Setup","echo-knowledge-base")),a("p",null,n("Just a few more steps to enable AI features:","echo-knowledge-base"))),a("div",{className:"epkb-ai-setup-steps-list"},t.map(((t,e)=>a("div",{key:e,className:"epkb-ai-setup-item"},a("div",{className:"epkb-ai-setup-item-content"},a("span",{className:"epkb-ai-step-number"},e+1),a("div",null,a("p",{className:"epkb-ai-setup-message"},t.message),t.link&&a("a",{href:t.link,className:"epkb-ai-button epkb-ai-button-small epkb-ai-button-primary"},t.action))))))));const f=()=>{const t=i?.dashboard_stats||{};return a("div",{className:"epkb-ai-stats-grid"},Object.values(t).map(((t,e)=>a("div",{key:e,className:"epkb-ai-stat-box"+(t.is_coming_soon?" epkb-ai-stat-box-coming-soon":""),style:{borderTopColor:t.color}},a("div",{className:"epkb-ai-stat-header"},a("div",{className:"epkb-ai-stat-icon",style:{backgroundColor:t.color+"15"}},a("span",{className:t.icon,style:{color:t.color}})),a("h3",null,t.title)),a("div",{className:"epkb-ai-stat-content"},t.is_coming_soon?a("div",{className:"epkb-ai-coming-soon"},a("span",{className:"epkb-ai-coming-soon-badge"},t.value),a("p",{className:"epkb-ai-stat-description"},t.description)):a("div",null,a("p",{className:"epkb-ai-stat-description"},t.description),(t.show_as_main||t.total!==undefined)&&a("div",{className:"epkb-ai-stat-numbers"},a("span",{className:"epkb-ai-stat-number"},t.value||"0"))),t.bottom_text&&a("div",{className:"epkb-ai-stat-bottom"},a("span",null,t.bottom_text)))))))};const v=()=>{if(!d){return null}const t=r?.checks?.api_key?.status==="success";const s=r?.checks?.disclaimer?.status==="success";const o=e?.ai_search_enabled&&e.ai_search_enabled!=="off";const l=e?.ai_chat_enabled&&e.ai_chat_enabled!=="off";const p=o||l;const b=i?.dashboard_stats?.training_data?.synced>0;const u=!d;const k=t&&s;const m=p;const h=b;return a("div",{className:"epkb-ai-setup-guide"},a("h3",null,n("Setup Steps","echo-knowledge-base")),a("div",{className:"epkb-ai-setup-steps"},a("div",{className:"epkb-ai-setup-step"},a("span",{className:"epkb-ai-step-number"+(k?" epkb-ai-step-completed":"")},k?"":"1"),a("h4",null,n("Configure API Key & Privacy","echo-knowledge-base")),a("p",null,n("Add your OpenAI API key and accept the data privacy agreement","echo-knowledge-base")),!k&&a("button",{className:"epkb-ai-button epkb-ai-button-small",onClick:()=>{if(c){c("general-settings")}}},n("Go to Settings","echo-knowledge-base"))),a("div",{className:"epkb-ai-setup-step"},a("span",{className:"epkb-ai-step-number"+(m?" epkb-ai-step-completed":"")},m?"":"2"),a("h4",null,n("Enable AI Chat and/or AI Search","echo-knowledge-base")),a("p",null,n("Enable AI Search or Chat features for your website","echo-knowledge-base")),!m&&k&&a("button",{className:"epkb-ai-button epkb-ai-button-small",onClick:()=>{if(c){c("search")}}},n("Enable AI Features","echo-knowledge-base"))),a("div",{className:"epkb-ai-setup-step"},a("span",{className:"epkb-ai-step-number"+(h?" epkb-ai-step-completed":"")},h?"":"3"),a("h4",null,n("Add Training Data & Sync","echo-knowledge-base")),a("p",null,n("Select content and sync it to OpenAI for AI processing","echo-knowledge-base")),!h&&m&&a("button",{className:"epkb-ai-button epkb-ai-button-small",onClick:()=>{if(c){c("training-data")}}},n("Go to Training Data","echo-knowledge-base")))))};const w=(t,e,a)=>new Promise((s=>{const o=t?.first_name||"";const i=t?.email||"";const l=t?.site_url||"";const c=t=>{const e=document.createElement("div");e.textContent=t;return e.innerHTML};const r=document.createElement("div");r.className="epkb-ai-vote-dialog-overlay";r.style.cssText=`\n\t\t\t\t\tposition: fixed;\n\t\t\t\t\ttop: 0;\n\t\t\t\t\tleft: 0;\n\t\t\t\t\tright: 0;\n\t\t\t\t\tbottom: 0;\n\t\t\t\t\tbackground: rgba(0, 0, 0, 0.5);\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t\tz-index: 9999999;\n\t\t\t\t`;const d=document.createElement("div");d.className="epkb-ai-vote-dialog";d.style.cssText=`\n\t\t\t\t\tbackground: white;\n\t\t\t\t\tborder-radius: 8px;\n\t\t\t\t\tpadding: 24px;\n\t\t\t\t\tmax-width: 500px;\n\t\t\t\t\twidth: 90%;\n\t\t\t\t\tbox-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n\t\t\t\t\tposition: relative;\n\t\t\t\t\tz-index: 9999999;\n\t\t\t\t`;const p=`\n\t\t\t\t\t<h3 style="margin: 0 0 16px 0; font-size: 18px; font-weight: 600;">\n\t\t\t\t\t\t${n("Vote for Features","echo-knowledge-base")}\n\t\t\t\t\t</h3>\n\t\t\t\t\t<p style="margin: 0 0 20px 0; color: #555; line-height: 1.5;">\n\t\t\t\t\t\t${n("Help us prioritize features by providing your information:","echo-knowledge-base")}\n\t\t\t\t\t</p>\n\t\t\t\t\t<form id="epkb-vote-form" style="display: flex; flex-direction: column; gap: 15px;">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<label style="display: block; margin-bottom: 5px; font-weight: 500;">\n\t\t\t\t\t\t\t\t${n("First Name","echo-knowledge-base")} <span style="color: red;">*</span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<input type="text" \n\t\t\t\t\t\t\t\t   id="epkb-vote-first-name" \n\t\t\t\t\t\t\t\t   required\n\t\t\t\t\t\t\t\t   value="${c(o)}"\n\t\t\t\t\t\t\t\t   style="width: 100%; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<label style="display: block; margin-bottom: 5px; font-weight: 500;">\n\t\t\t\t\t\t\t\t${n("Email","echo-knowledge-base")} <span style="color: red;">*</span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<input type="email" \n\t\t\t\t\t\t\t\t   id="epkb-vote-email" \n\t\t\t\t\t\t\t\t   required\n\t\t\t\t\t\t\t\t   value="${c(i)}"\n\t\t\t\t\t\t\t\t   style="width: 100%; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<label style="display: block; margin-bottom: 5px; font-weight: 500;">\n\t\t\t\t\t\t\t\t${n("Website URL","echo-knowledge-base")} ${n("(optional)","echo-knowledge-base")}\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<input type="url" \n\t\t\t\t\t\t\t\t   id="epkb-vote-site-url" \n\t\t\t\t\t\t\t\t   value="${c(l)}"\n\t\t\t\t\t\t\t\t   placeholder="https://example.com"\n\t\t\t\t\t\t\t\t   style="width: 100%; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${e.includes("other-feature")?`\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<label style="display: block; margin-bottom: 5px; font-weight: 500;">\n\t\t\t\t\t\t\t\t${n("Describe Your Feature Request","echo-knowledge-base")} <span style="color: red;">*</span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\tid="epkb-vote-other-feature-text"\n\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\tplaceholder="${n("Please describe the feature you would like to see...","echo-knowledge-base")}"\n\t\t\t\t\t\t\t\tstyle="width: 100%; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px; min-height: 80px; resize: vertical;">${c(a)}</textarea>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t`:""}\n\t\t\t\t\t\t<div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 10px;">\n\t\t\t\t\t\t\t<button type="button" class="epkb-ai-button epkb-ai-button-secondary" id="epkb-vote-cancel">\n\t\t\t\t\t\t\t\t${n("Cancel","echo-knowledge-base")}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button type="submit" class="epkb-ai-button epkb-ai-button-primary" id="epkb-vote-submit">\n\t\t\t\t\t\t\t\t${n("Submit Vote","echo-knowledge-base")}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</form>\n\t\t\t\t`;d.innerHTML=p;r.appendChild(d);document.body.appendChild(r);const b=d.querySelector("#epkb-vote-form");const u=d.querySelector("#epkb-vote-cancel");const k=d.querySelector("#epkb-vote-first-name");const m=d.querySelector("#epkb-vote-email");const h=d.querySelector("#epkb-vote-site-url");k.focus();const g=t=>{t.preventDefault();const e={first_name:k.value.trim(),email:m.value.trim(),site_url:h.value.trim()};const a=d.querySelector("#epkb-vote-other-feature-text");if(a){e.other_feature_text=a.value.trim();if(!e.other_feature_text){alert(n("Please describe the feature you would like to see.","echo-knowledge-base"));a.focus();return}}if(!e.first_name||!e.email){alert(n("Please fill in all required fields.","echo-knowledge-base"));return}const o=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(!o.test(e.email)){alert(n("Please enter a valid email address.","echo-knowledge-base"));m.focus();return}v();s(e)};const f=()=>{v();s(null)};const v=()=>{document.body.removeChild(r)};b.addEventListener("submit",g);u.addEventListener("click",f);r.addEventListener("click",(t=>{if(t.target===r){f()}}));document.addEventListener("keydown",(function t(e){if(e.key==="Escape"){document.removeEventListener("keydown",t);f()}}))}));const y=async()=>{if(p.length===0){s(n("Please select at least one feature to vote for.","echo-knowledge-base"));return}const t=i?.current_user||{};const e=await w(t,p,u);if(!e){return}const a={...e,features:p,action:"epkb_vote_for_features",_wpnonce_epkb_ajax_action:epkb_vars.nonce};if(e.other_feature_text){a.other_feature_text=e.other_feature_text}const l=document.createElement("div");l.className="epkb-ai-loading-overlay";l.style.cssText=`\n\t\t\t\tposition: fixed;\n\t\t\t\ttop: 0;\n\t\t\t\tleft: 0;\n\t\t\t\tright: 0;\n\t\t\t\tbottom: 0;\n\t\t\t\tbackground: rgba(0, 0, 0, 0.5);\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\tjustify-content: center;\n\t\t\t\tz-index: 9999999;\n\t\t\t`;l.innerHTML=`\n\t\t\t\t<div style="background: white; padding: 20px; border-radius: 8px;">\n\t\t\t\t\t${n("Submitting your vote...","echo-knowledge-base")}\n\t\t\t\t</div>\n\t\t\t`;document.body.appendChild(l);jQuery.ajax({type:"POST",dataType:"json",url:epkb_vars.ajax_url,data:a,success:function(t){document.body.removeChild(l);if(t.success){const e=t.data&&t.data.message?t.data.message:n("Thank you for voting!","echo-knowledge-base");o(e);b([])}else{const e=t.data&&t.data.message?t.data.message:n("Failed to submit vote. Please try again.","echo-knowledge-base");s(e)}},error:function(t,e,a){document.body.removeChild(l);s(n("An error occurred. Please try again.","echo-knowledge-base")+" ["+a+"]");console.error("Vote submission error:",a)}})};const N=()=>{const t=i?.news||[];if(t.length===0){return null}return a("div",{className:"epkb-ai-news-section"},a("h3",null,n("Latest Updates","echo-knowledge-base")),a("div",{className:"epkb-ai-news-items"},t.map(((t,e)=>a("div",{key:e,className:`epkb-ai-news-item epkb-ai-news-${t.type}`},a("div",{className:"epkb-ai-news-header"},a("span",{className:"epkb-ai-news-date"},t.date),a("span",{className:`epkb-ai-news-badge epkb-ai-news-badge-${t.type}`},t.type)),a("h4",null,t.title),a("p",null,t.description),t.link&&a("a",{href:t.link,target:"_blank",className:"epkb-ai-news-link"},n("Learn more","echo-knowledge-base")," →"))))))};const x=()=>{const t=i?.upcoming_features||[];if(t.length===0){return null}const e=t=>{b((e=>{if(e.includes(t)){if(t==="other-feature"){k("")}return e.filter((e=>e!==t))}else{return[...e,t]}}))};return a("div",{className:"epkb-ai-upcoming-features"},a("h3",null,n("Vote Upcoming Features","echo-knowledge-base")+"!"),a("p",{style:{marginBottom:"20px",color:"#666"}},n("Select the features you would like to see implemented:","echo-knowledge-base")),a("div",{className:"epkb-ai-features-grid"},t.map(((t,n)=>a("div",{key:n,className:"epkb-ai-feature-card"+(p.includes(t.id)?" epkb-ai-feature-selected":""),style:{cursor:"pointer",position:"relative"}},a("div",{className:"epkb-ai-feature-header",onClick:()=>e(t.id)},a("span",{className:`epkb-ai-feature-icon ${t.icon}`}),a("div",{className:"epkb-ai-feature-content"},a("div",{className:"epkb-ai-feature-title-row"},a("h4",null,t.title)),a("p",null,t.description)),a("input",{type:"checkbox",id:`feature-${t.id}`,checked:p.includes(t.id),onChange:()=>e(t.id),onClick:t=>t.stopPropagation()})))))),a("div",{className:"epkb-ai-vote-button-container",style:{marginTop:"30px",textAlign:"center",padding:"20px",background:"#f8f9fa",borderRadius:"8px"}},a("button",{className:"epkb-ai-button epkb-ai-button-primary epkb-ai-button-large",onClick:y,disabled:p.length===0,style:{padding:"12px 30px",fontSize:"16px",opacity:p.length===0?"0.5":"1",cursor:p.length===0?"not-allowed":"pointer"}},a("span",{className:"epkbfa epkbfa-thumbs-up",style:{marginRight:"8px"}}),n("Vote for Selected Features","echo-knowledge-base")),p.length>0&&a("p",{style:{marginTop:"10px",color:"#666",fontSize:"14px"}},`${p.length} ${p.length===1?n("feature selected","echo-knowledge-base"):n("features selected","echo-knowledge-base")}`)),a("div",{className:"epkb-ai-upcoming-features-disclaimer"},a("p",null,n("Note: Your feedback helps us prioritize development. Features are subject to change.","echo-knowledge-base"))))};const _=()=>{const t=i?.quick_links||[];if(t.length===0){return null}return a("div",{className:"epkb-ai-quick-links"},a("h3",null,n("Setup Steps","echo-knowledge-base")),a("div",{className:"epkb-ai-links-grid"},t.map(((t,e)=>{let s="epkb-ai-quick-link";if(t.completed){s+=" epkb-ai-quick-link-completed"}if(t.disabled){s+=" epkb-ai-quick-link-disabled"}return a(t.disabled?"div":"a",{key:e,href:t.disabled?undefined:t.link,target:t.external?"_blank":"_self",className:s},a("span",{className:t.icon+(t.completed?" epkb-ai-step-completed":"")}),a("div",null,a("h4",null,t.title),a("p",null,t.description),t.completed&&a("span",{className:"epkb-ai-step-badge"},n("Completed","echo-knowledge-base"))))}))))};return a("div",{className:"epkb-ai-dashboard-container epkb-ai-dashboard-beta"},v(),m(),f(),a("div",{className:"epkb-ai-dashboard-columns"},a("div",{className:"epkb-ai-dashboard-main"},x()),a("div",{className:"epkb-ai-dashboard-sidebar"},_(),N())))};window.EPKB_AI_Dashboard={AIAdminDashboard:l}})();